diff --git a/LexicalCode.dev.js b/LexicalCode.dev.js
index fec4ae80ef0eebaa67439d829f849fd0290c2d7f..b04ea2d1e7bdbacaed57c995a6f4e37ae8a77f47 100644
--- a/LexicalCode.dev.js
+++ b/LexicalCode.dev.js
@@ -10,22 +10,6 @@
 
 var utils = require('@lexical/utils');
 var lexical = require('lexical');
-require('prismjs');
-require('prismjs/components/prism-clike');
-require('prismjs/components/prism-javascript');
-require('prismjs/components/prism-markup');
-require('prismjs/components/prism-markdown');
-require('prismjs/components/prism-c');
-require('prismjs/components/prism-css');
-require('prismjs/components/prism-objectivec');
-require('prismjs/components/prism-sql');
-require('prismjs/components/prism-powershell');
-require('prismjs/components/prism-python');
-require('prismjs/components/prism-rust');
-require('prismjs/components/prism-swift');
-require('prismjs/components/prism-typescript');
-require('prismjs/components/prism-java');
-require('prismjs/components/prism-cpp');
 
 /**
  * Copyright (c) Meta Platforms, Inc. and affiliates.
@@ -683,6 +667,8 @@ const CodeExtension = lexical.defineExtension({
   nodes: () => [CodeNode, CodeHighlightNode]
 });
 
+const Prism = globalThis.Prism || window.Prism;
+
 (function (Prism) {
 
 	Prism.languages.diff = {
@@ -756,7 +742,7 @@ const CodeExtension = lexical.defineExtension({
  *
  */
 
-const Prism$1 = globalThis.Prism || window.Prism;
+const Prism$1 = Prism;
 const CODE_LANGUAGE_FRIENDLY_NAME_MAP = {
   c: 'C',
   clike: 'C-like',
diff --git a/LexicalCode.dev.mjs b/LexicalCode.dev.mjs
index e5627e6c105ce9138f8a23b0ae7c0ce6af2613b8..47ffadff30371659ae65fa362ca44f84e1002b56 100644
--- a/LexicalCode.dev.mjs
+++ b/LexicalCode.dev.mjs
@@ -8,22 +8,6 @@
 
 import { isHTMLElement, addClassNamesToElement, removeClassNamesFromElement, $getAdjacentCaret, mergeRegister } from '@lexical/utils';
 import { ElementNode, $createParagraphNode, $isTextNode, $isTabNode, $createTabNode, $createLineBreakNode, $create, TextNode, $applyNodeReplacement, $getSiblingCaret, getTextDirection, $isElementNode, $isLineBreakNode, defineExtension, $createTextNode, $getNodeByKey, $getSelection, $isRangeSelection, $createPoint, INDENT_CONTENT_COMMAND, OUTDENT_CONTENT_COMMAND, INSERT_TAB_COMMAND, $setSelectionFromCaretRange, $getCaretRangeInDirection, $getCaretRange, $getTextPointCaret, $normalizeCaret, KEY_ARROW_UP_COMMAND, MOVE_TO_START, KEY_TAB_COMMAND, COMMAND_PRIORITY_LOW, $insertNodes, $getRoot, KEY_ARROW_DOWN_COMMAND, MOVE_TO_END } from 'lexical';
-import 'prismjs';
-import 'prismjs/components/prism-clike.js';
-import 'prismjs/components/prism-javascript.js';
-import 'prismjs/components/prism-markup.js';
-import 'prismjs/components/prism-markdown.js';
-import 'prismjs/components/prism-c.js';
-import 'prismjs/components/prism-css.js';
-import 'prismjs/components/prism-objectivec.js';
-import 'prismjs/components/prism-sql.js';
-import 'prismjs/components/prism-powershell.js';
-import 'prismjs/components/prism-python.js';
-import 'prismjs/components/prism-rust.js';
-import 'prismjs/components/prism-swift.js';
-import 'prismjs/components/prism-typescript.js';
-import 'prismjs/components/prism-java.js';
-import 'prismjs/components/prism-cpp.js';
 
 /**
  * Copyright (c) Meta Platforms, Inc. and affiliates.
@@ -681,6 +665,8 @@ const CodeExtension = defineExtension({
   nodes: () => [CodeNode, CodeHighlightNode]
 });
 
+const Prism = globalThis.Prism || window.Prism;
+
 (function (Prism) {
 
 	Prism.languages.diff = {
@@ -754,7 +740,7 @@ const CodeExtension = defineExtension({
  *
  */
 
-const Prism$1 = globalThis.Prism || window.Prism;
+const Prism$1 = Prism;
 const CODE_LANGUAGE_FRIENDLY_NAME_MAP = {
   c: 'C',
   clike: 'C-like',
diff --git a/LexicalCode.prod.js b/LexicalCode.prod.js
index 968f659f2f624fafffcaa05f360aa39f2668d411..78dce0fc062cc0b591a52b81686b87c54854b935 100644
--- a/LexicalCode.prod.js
+++ b/LexicalCode.prod.js
@@ -6,4 +6,4 @@
  *
  */
 
-"use strict";var e=require("@lexical/utils"),t=require("lexical");function n(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}require("prismjs"),require("prismjs/components/prism-clike"),require("prismjs/components/prism-javascript"),require("prismjs/components/prism-markup"),require("prismjs/components/prism-markdown"),require("prismjs/components/prism-c"),require("prismjs/components/prism-css"),require("prismjs/components/prism-objectivec"),require("prismjs/components/prism-sql"),require("prismjs/components/prism-powershell"),require("prismjs/components/prism-python"),require("prismjs/components/prism-rust"),require("prismjs/components/prism-swift"),require("prismjs/components/prism-typescript"),require("prismjs/components/prism-java"),require("prismjs/components/prism-cpp");const r="javascript";function i(t,n){for(const r of t.childNodes){if(e.isHTMLElement(r)&&r.tagName===n)return!0;i(r,n)}return!1}const o="data-language",s="data-highlight-language",a="data-theme";class g extends t.ElementNode{__language;__theme;__isSyntaxHighlightSupported;static getType(){return"code"}static clone(e){return new g(e.__language,e.__key)}constructor(e,t){super(t),this.__language=e||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(e){super.afterCloneFrom(e),this.__language=e.__language,this.__theme=e.__theme,this.__isSyntaxHighlightSupported=e.__isSyntaxHighlightSupported}createDOM(t){const n=document.createElement("code");e.addClassNamesToElement(n,t.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute(o,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(s,r));const i=this.getTheme();i&&n.setAttribute(a,i);const g=this.getStyle();return g&&n.setAttribute("style",g),n}updateDOM(e,t,n){const r=this.__language,i=e.__language;r?r!==i&&t.setAttribute(o,r):i&&t.removeAttribute(o);const g=this.__isSyntaxHighlightSupported;e.__isSyntaxHighlightSupported&&i?g&&r?r!==i&&t.setAttribute(s,r):t.removeAttribute(s):g&&r&&t.setAttribute(s,r);const l=this.__theme,c=e.__theme;l?l!==c&&t.setAttribute(a,l):c&&t.removeAttribute(a);const u=this.__style,d=e.__style;return u?u!==d&&t.setAttribute("style",u):d&&t.removeAttribute("style"),!1}exportDOM(t){const n=document.createElement("pre");e.addClassNamesToElement(n,t._config.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute(o,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(s,r));const i=this.getTheme();i&&n.setAttribute(a,i);const g=this.getStyle();return g&&n.setAttribute("style",g),{element:n}}static importDOM(){return{code:e=>null!=e.textContent&&(/\r?\n/.test(e.textContent)||i(e,"BR"))?{conversion:u,priority:1}:null,div:()=>({conversion:d,priority:1}),pre:()=>({conversion:u,priority:0}),table:e=>N(e)?{conversion:p,priority:3}:null,td:e=>{const t=e,n=t.closest("table");return t.classList.contains("js-file-line")||n&&N(n)?{conversion:f,priority:3}:null},tr:e=>{const t=e.closest("table");return t&&N(t)?{conversion:f,priority:3}:null}}}static importJSON(e){return l().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setLanguage(e.language).setTheme(e.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(e,n=!0){const r=this.getChildren(),i=r.length;if(i>=2&&"\n"===r[i-1].getTextContent()&&"\n"===r[i-2].getTextContent()&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===i){r[i-1].remove(),r[i-2].remove();const e=t.$createParagraphNode();return this.insertAfter(e,n),e}const{anchor:o,focus:s}=e,a=(o.isBefore(s)?o:s).getNode();if(t.$isTextNode(a)){let e=y(a);const n=[];for(;;)if(t.$isTabNode(e))n.push(t.$createTabNode()),e=e.getNextSibling();else{if(!x(e))break;{let t=0;const r=e.getTextContent(),i=e.getTextContentSize();for(;t<i&&" "===r[t];)t++;if(0!==t&&n.push(T(" ".repeat(t))),t!==i)break;e=e.getNextSibling()}}const r=a.splitText(o.offset)[0],i=0===o.offset?0:1,s=r.getIndexWithinParent()+i,g=a.getParentOrThrow(),l=[t.$createLineBreakNode(),...n];g.splice(s,0,l);const c=n[n.length-1];c?c.select():0===o.offset?r.selectPrevious():r.getNextSibling().selectNext(0,0)}if(c(a)){const{offset:n}=e.anchor;a.splice(n,0,[t.$createLineBreakNode()]),a.select(n+1,n+1)}return null}canIndent(){return!1}collapseAtStart(){const e=t.$createParagraphNode();return this.getChildren().forEach(t=>e.append(t)),this.replace(e),!0}setLanguage(e){const t=this.getWritable();return t.__language=e||void 0,t}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(e){const t=this.getWritable();return t.__isSyntaxHighlightSupported=e,t}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(e){const t=this.getWritable();return t.__theme=e||void 0,t}getTheme(){return this.getLatest().__theme}}function l(e,n){return t.$create(g).setLanguage(e).setTheme(n)}function c(e){return e instanceof g}function u(e){return{node:l(e.getAttribute(o))}}function d(e){const t=e,n=h(t);return n||function(e){let t=e.parentElement;for(;null!==t;){if(h(t))return!0;t=t.parentElement}return!1}(t)?{node:n?l():null}:{node:null}}function p(){return{node:l()}}function f(){return{node:null}}function h(e){return null!==e.style.fontFamily.match("monospace")}function N(e){return e.classList.contains("js-file-line-container")}class m extends t.TextNode{__highlightType;constructor(e="",t,n){super(e,n),this.__highlightType=t}static getType(){return"code-highlight"}static clone(e){return new m(e.__text,e.__highlightType||void 0,e.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(e){const t=this.getWritable();return t.__highlightType=e||void 0,t}canHaveFormat(){return!1}createDOM(t){const n=super.createDOM(t),r=_(t.theme,this.__highlightType);return e.addClassNamesToElement(n,r),n}updateDOM(t,n,r){const i=super.updateDOM(t,n,r),o=_(r.theme,t.__highlightType),s=_(r.theme,this.__highlightType);return o!==s&&(o&&e.removeClassNamesFromElement(n,o),s&&e.addClassNamesToElement(n,s)),i}static importJSON(e){return T().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHighlightType(e.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return l()}}function _(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function T(e="",n){return t.$applyNodeReplacement(new m(e,n))}function x(e){return e instanceof m}function C(n,r){let i=n;for(let o=t.$getSiblingCaret(n,r);o&&(x(o.origin)||t.$isTabNode(o.origin));o=e.$getAdjacentCaret(o))i=o.origin;return i}function y(e){return C(e,"previous")}function O(e){return C(e,"next")}function S(e){const n=y(e),r=O(e);let i=n;for(;null!==i;){if(x(i)){const e=t.getTextDirection(i.getTextContent());if(null!==e)return e}if(i===r)break;i=i.getNextSibling()}const o=n.getParent();if(t.$isElementNode(o)){const e=o.getDirection();if("ltr"===e||"rtl"===e)return e}return null}function $(e,r){let i=null,o=null,s=e,a=r,g=e.getTextContent();for(;;){if(0===a){if(s=s.getPreviousSibling(),null===s)break;if(x(s)||t.$isTabNode(s)||t.$isLineBreakNode(s)||n(167),t.$isLineBreakNode(s)){i={node:s,offset:1};break}a=Math.max(0,s.getTextContentSize()-1),g=s.getTextContent()}else a--;const e=g[a];x(s)&&" "!==e&&(o={node:s,offset:a})}if(null!==o)return o;let l=null;if(r<e.getTextContentSize())x(e)&&(l=e.getTextContent()[r]);else{const t=e.getNextSibling();x(t)&&(l=t.getTextContent()[0])}if(null!==l&&" "!==l)return i;{const n=function(e,n){let r=e,i=n,o=e.getTextContent(),s=e.getTextContentSize();for(;;){if(!x(r)||i===s){if(r=r.getNextSibling(),null===r||t.$isLineBreakNode(r))return null;x(r)&&(i=0,o=r.getTextContent(),s=r.getTextContentSize())}if(x(r)){if(" "!==o[i])return{node:r,offset:i};i++}}}(e,r);return null!==n?n:i}}function A(e){const r=O(e);return t.$isLineBreakNode(r)&&n(168),r}const L=t.defineExtension({name:"@lexical/code",nodes:()=>[g,m]});!function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],i=[];/^\w+$/.test(n)||i.push(/\w+/.exec(n)[0]),"diff"===n&&i.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+"].*(?:\r\n?|\n|(?![\\s\\S])))+","m"),alias:i,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})}(Prism);const b=globalThis.Prism||window.Prism,M={c:"C",clike:"C-like",cpp:"C++",css:"CSS",html:"HTML",java:"Java",js:"JavaScript",markdown:"Markdown",objc:"Objective-C",plain:"Plain Text",powershell:"PowerShell",py:"Python",rust:"Rust",sql:"SQL",swift:"Swift",typescript:"TypeScript",xml:"XML"},E={cpp:"cpp",java:"java",javascript:"js",md:"markdown",plaintext:"plain",python:"py",text:"plain",ts:"typescript"};function D(e){return E[e]||e}function v(e){return"string"==typeof e?e:Array.isArray(e)?e.map(v).join(""):v(e.content)}function R(e,t){const n=/^diff-([\w-]+)/i.exec(t),r=e.getTextContent();let i=b.tokenize(r,b.languages[n?"diff":t]);return n&&(i=function(e,t){const n=t,r=b.languages[n],i={tokens:e},o=b.languages.diff.PREFIXES;for(const e of i.tokens){if("string"==typeof e||!(e.type in o)||!Array.isArray(e.content))continue;const t=e.type;let n=0;const i=()=>(n++,new b.Token("prefix",o[t],t.replace(/^(\w+).*/,"$1"))),s=e.content.filter(e=>"string"==typeof e||"prefix"!==e.type),a=e.content.length-s.length,g=b.tokenize(v(s),r);g.unshift(i());const l=/\r\n|\n/g,c=e=>{const t=[];l.lastIndex=0;let r,o=0;for(;n<a&&(r=l.exec(e));){const n=r.index+r[0].length;t.push(e.slice(o,n)),o=n,t.push(i())}if(0!==t.length)return o<e.length&&t.push(e.slice(o)),t},u=e=>{for(let t=0;t<e.length&&n<a;t++){const n=e[t];if("string"==typeof n){const r=c(n);r&&(e.splice(t,1,...r),t+=r.length-1)}else if("string"==typeof n.content){const e=c(n.content);e&&(n.content=e)}else Array.isArray(n.content)?u(n.content):u([n.content])}};u(g),n<a&&g.push(i()),e.content=g}return i.tokens}(i,n[1])),k(i)}function k(e,n){const r=[];for(const i of e)if("string"==typeof i){const e=i.split(/(\n|\t)/),o=e.length;for(let i=0;i<o;i++){const o=e[i];"\n"===o||"\r\n"===o?r.push(t.$createLineBreakNode()):"\t"===o?r.push(t.$createTabNode()):o.length>0&&r.push(T(o,n))}}else{const{content:e,alias:t}=i;"string"==typeof e?r.push(...k([e],"prefix"===i.type&&"string"==typeof t?t:i.type)):Array.isArray(e)&&r.push(...k(e,"unchanged"===i.type?void 0:i.type))}return r}const P={$tokenize(e,t){return R(e,t||this.defaultLanguage)},defaultLanguage:r,tokenize(e,t){return b.tokenize(e,b.languages[t||""]||b.languages[this.defaultLanguage])}};function I(e,n,r){const i=e.getParent();c(i)?j(i,n,r):x(e)&&e.replace(t.$createTextNode(e.__text))}function w(e,n){const r=n.getElementByKey(e.getKey());if(null===r)return;const i=e.getChildren(),o=i.length;if(o===r.__cachedChildrenLength)return;r.__cachedChildrenLength=o;let s="1",a=1;for(let e=0;e<o;e++)t.$isLineBreakNode(i[e])&&(s+="\n"+ ++a);r.setAttribute("data-gutter",s)}const B=new Set;function j(e,n,r){const i=e.getKey(),o=n.getKey()+"/"+i;void 0===e.getLanguage()&&e.setLanguage(r.defaultLanguage);const s=e.getLanguage()||r.defaultLanguage;if(!function(e){const t=function(e){const t=/^diff-([\w-]+)/i.exec(e);return t?t[1]:null}(e),n=t||e;try{return!!n&&b.languages.hasOwnProperty(n)}catch(e){return!1}}(s))return e.getIsSyntaxHighlightSupported()&&e.setIsSyntaxHighlightSupported(!1),void async function(){}();e.getIsSyntaxHighlightSupported()||e.setIsSyntaxHighlightSupported(!0),B.has(o)||(B.add(o),n.update(()=>{!function(e,n){const r=t.$getNodeByKey(e);if(!c(r)||!r.isAttached())return;const i=t.$getSelection();if(!t.$isRangeSelection(i))return void n();const o=i.anchor,s=o.offset,a="element"===o.type&&t.$isLineBreakNode(r.getChildAtIndex(o.offset-1));let g=0;if(!a){const e=o.getNode();g=s+e.getPreviousSiblings().reduce((e,t)=>e+t.getTextContentSize(),0)}if(!n())return;if(a)return void o.getNode().select(s,s);r.getChildren().some(e=>{const n=t.$isTextNode(e);if(n||t.$isLineBreakNode(e)){const t=e.getTextContentSize();if(n&&t>=g)return e.select(g,g),!0;g-=t}return!1})}(i,()=>{const n=t.$getNodeByKey(i);if(!c(n)||!n.isAttached())return!1;const o=n.getLanguage()||r.defaultLanguage,s=r.$tokenize(n,o),a=function(e,t){let n=0;for(;n<e.length&&H(e[n],t[n]);)n++;const r=e.length,i=t.length,o=Math.min(r,i)-n;let s=0;for(;s<o;)if(s++,!H(e[r-s],t[i-s])){s--;break}const a=n,g=r-s,l=t.slice(n,i-s);return{from:a,nodesForReplacement:l,to:g}}(n.getChildren(),s),{from:g,to:l,nodesForReplacement:u}=a;return!(g===l&&!u.length)&&(e.splice(g,l-g,u),!0)})},{onUpdate:()=>{B.delete(o)},skipTransforms:!0}))}function H(e,n){return x(e)&&x(n)&&e.__text===n.__text&&e.__highlightType===n.__highlightType||t.$isTabNode(e)&&t.$isTabNode(n)||t.$isLineBreakNode(e)&&t.$isLineBreakNode(n)}function K(e){if(!t.$isRangeSelection(e))return!1;const n=e.anchor.getNode(),r=c(n)?n:n.getParent(),i=e.focus.getNode(),o=c(i)?i:i.getParent();return c(r)&&r.is(o)}function F(e){const r=e.getNodes(),i=[];if(1===r.length&&c(r[0]))return i;let o=[];for(let e=0;e<r.length;e++){const s=r[e];x(s)||t.$isTabNode(s)||t.$isLineBreakNode(s)||n(169),t.$isLineBreakNode(s)?o.length>0&&(i.push(o),o=[]):o.push(s)}if(o.length>0){const n=e.isBackward()?e.anchor:e.focus,r=t.$createPoint(o[0].getKey(),0,"text");n.is(r)||i.push(o)}return i}function q(e){const n=t.$getSelection();if(!t.$isRangeSelection(n)||!K(n))return!1;const r=F(n),i=r.length;if(0===i&&n.isCollapsed())return e===t.INDENT_CONTENT_COMMAND&&n.insertNodes([t.$createTabNode()]),!0;if(0===i&&e===t.INDENT_CONTENT_COMMAND&&"\n"===n.getTextContent()){const e=t.$createTabNode(),r=t.$createLineBreakNode(),i=n.isBackward()?"previous":"next";return n.insertNodes([e,r]),t.$setSelectionFromCaretRange(t.$getCaretRangeInDirection(t.$getCaretRange(t.$getTextPointCaret(e,"next",0),t.$normalizeCaret(t.$getSiblingCaret(r,"next"))),i)),!0}for(let o=0;o<i;o++){const i=r[o];if(i.length>0){let r=i[0];if(0===o&&(r=y(r)),e===t.INDENT_CONTENT_COMMAND){const e=t.$createTabNode();if(r.insertBefore(e),0===o){const i=n.isBackward()?"focus":"anchor",o=t.$createPoint(r.getKey(),0,"text");n[i].is(o)&&n[i].set(e.getKey(),0,"text")}}else t.$isTabNode(r)&&r.remove()}}return!0}function W(e,n){const r=t.$getSelection();if(!t.$isRangeSelection(r))return!1;const{anchor:i,focus:o}=r,s=i.offset,a=o.offset,g=i.getNode(),l=o.getNode(),c=e===t.KEY_ARROW_UP_COMMAND;if(!K(r)||!x(g)&&!t.$isTabNode(g)||!x(l)&&!t.$isTabNode(l))return!1;if(!n.altKey){if(r.isCollapsed()){const e=g.getParentOrThrow();if(c&&0===s&&null===g.getPreviousSibling()){if(null===e.getPreviousSibling())return e.selectPrevious(),n.preventDefault(),!0}else if(!c&&s===g.getTextContentSize()&&null===g.getNextSibling()){if(null===e.getNextSibling())return e.selectNext(),n.preventDefault(),!0}}return!1}let u,d;if(g.isBefore(l)?(u=y(g),d=O(l)):(u=y(l),d=O(g)),null==u||null==d)return!1;const p=u.getNodesBetween(d);for(let e=0;e<p.length;e++){const n=p[e];if(!x(n)&&!t.$isTabNode(n)&&!t.$isLineBreakNode(n))return!1}n.preventDefault(),n.stopPropagation();const f=c?u.getPreviousSibling():d.getNextSibling();if(!t.$isLineBreakNode(f))return!0;const h=c?f.getPreviousSibling():f.getNextSibling();if(null==h)return!0;const N=x(h)||t.$isTabNode(h)||t.$isLineBreakNode(h)?c?y(h):O(h):null;let m=null!=N?N:h;return f.remove(),p.forEach(e=>e.remove()),e===t.KEY_ARROW_UP_COMMAND?(p.forEach(e=>m.insertBefore(e)),m.insertBefore(f)):(m.insertAfter(f),m=f,p.forEach(e=>{m.insertAfter(e),m=e})),r.setTextNodeRange(g,s,l,a),!0}function z(e,n){const r=t.$getSelection();if(!t.$isRangeSelection(r))return!1;const{anchor:i,focus:o}=r,s=i.getNode(),a=o.getNode(),g=e===t.MOVE_TO_START;if(!K(r)||!x(s)&&!t.$isTabNode(s)||!x(a)&&!t.$isTabNode(a))return!1;const l=a;if("rtl"===S(l)?!g:g){const e=$(l,o.offset);if(null!==e){const{node:n,offset:i}=e;t.$isLineBreakNode(n)?n.selectNext(0,0):r.setTextNodeRange(n,i,n,i)}else l.getParentOrThrow().selectStart()}else{A(l).select()}return n.preventDefault(),n.stopPropagation(),!0}const Y=y,U=O,J=A,G=$;exports.$createCodeHighlightNode=T,exports.$createCodeNode=l,exports.$getCodeLineDirection=S,exports.$getEndOfCodeInLine=A,exports.$getFirstCodeNodeOfLine=y,exports.$getLastCodeNodeOfLine=O,exports.$getStartOfCodeInLine=$,exports.$isCodeHighlightNode=x,exports.$isCodeNode=c,exports.CODE_LANGUAGE_FRIENDLY_NAME_MAP=M,exports.CODE_LANGUAGE_MAP=E,exports.CodeExtension=L,exports.CodeHighlightNode=m,exports.CodeNode=g,exports.DEFAULT_CODE_LANGUAGE=r,exports.PrismTokenizer=P,exports.getCodeLanguageOptions=function(){const e=[];for(const[t,n]of Object.entries(M))e.push([t,n]);return e},exports.getCodeLanguages=()=>Object.keys(b.languages).filter(e=>"function"!=typeof b.languages[e]).sort(),exports.getCodeThemeOptions=function(){return[]},exports.getDefaultCodeLanguage=()=>r,exports.getEndOfCodeInLine=J,exports.getFirstCodeNodeOfLine=Y,exports.getLanguageFriendlyName=function(e){const t=D(e);return M[t]||t},exports.getLastCodeNodeOfLine=U,exports.getStartOfCodeInLine=G,exports.normalizeCodeLang=D,exports.normalizeCodeLanguage=D,exports.registerCodeHighlighting=function(r,i){if(!r.hasNodes([g,m]))throw new Error("CodeHighlightPlugin: CodeNode or CodeHighlightNode not registered on editor");null==i&&(i=P);const o=[];return!0!==r._headless&&o.push(r.registerMutationListener(g,e=>{r.getEditorState().read(()=>{for(const[n,i]of e)if("destroyed"!==i){const e=t.$getNodeByKey(n);null!==e&&w(e,r)}})},{skipInitialization:!1})),o.push(r.registerNodeTransform(g,e=>j(e,r,i)),r.registerNodeTransform(t.TextNode,e=>I(e,r,i)),r.registerNodeTransform(m,e=>I(e,r,i)),r.registerCommand(t.KEY_TAB_COMMAND,e=>{const i=function(e){const r=t.$getSelection();if(!t.$isRangeSelection(r)||!K(r))return null;const i=e?t.OUTDENT_CONTENT_COMMAND:t.INDENT_CONTENT_COMMAND,o=e?t.OUTDENT_CONTENT_COMMAND:t.INSERT_TAB_COMMAND,s=r.anchor,a=r.focus;if(s.is(a))return o;const g=F(r);if(1!==g.length)return i;const l=g[0];let c,u;0===l.length&&n(285),r.isBackward()?(c=a,u=s):(c=s,u=a);const d=y(l[0]),p=O(l[0]),f=t.$createPoint(d.getKey(),0,"text"),h=t.$createPoint(p.getKey(),p.getTextContentSize(),"text");return c.isBefore(f)||h.isBefore(u)?i:f.isBefore(c)||u.isBefore(h)?o:i}(e.shiftKey);return null!==i&&(e.preventDefault(),r.dispatchCommand(i,void 0),!0)},t.COMMAND_PRIORITY_LOW),r.registerCommand(t.INSERT_TAB_COMMAND,()=>!!K(t.$getSelection())&&(t.$insertNodes([t.$createTabNode()]),!0),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.INDENT_CONTENT_COMMAND,e=>q(t.INDENT_CONTENT_COMMAND),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.OUTDENT_CONTENT_COMMAND,e=>q(t.OUTDENT_CONTENT_COMMAND),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.KEY_ARROW_UP_COMMAND,e=>{const n=t.$getSelection();if(!t.$isRangeSelection(n)||!K(n))return!1;const r=t.$getRoot().getFirstDescendant(),{anchor:i}=n,o=i.getNode();return(!r||!o||r.getKey()!==o.getKey())&&W(t.KEY_ARROW_UP_COMMAND,e)},t.COMMAND_PRIORITY_LOW),r.registerCommand(t.KEY_ARROW_DOWN_COMMAND,e=>{const n=t.$getSelection();if(!t.$isRangeSelection(n)||!K(n))return!1;const r=t.$getRoot().getLastDescendant(),{anchor:i}=n,o=i.getNode();return(!r||!o||r.getKey()!==o.getKey())&&W(t.KEY_ARROW_DOWN_COMMAND,e)},t.COMMAND_PRIORITY_LOW),r.registerCommand(t.MOVE_TO_START,e=>z(t.MOVE_TO_START,e),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.MOVE_TO_END,e=>z(t.MOVE_TO_END,e),t.COMMAND_PRIORITY_LOW)),e.mergeRegister(...o)};
+"use strict";var e=require("@lexical/utils"),t=require("lexical");function n(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const r="javascript";function i(t,n){for(const r of t.childNodes){if(e.isHTMLElement(r)&&r.tagName===n)return!0;i(r,n)}return!1}const o="data-language",s="data-highlight-language",a="data-theme";class g extends t.ElementNode{__language;__theme;__isSyntaxHighlightSupported;static getType(){return"code"}static clone(e){return new g(e.__language,e.__key)}constructor(e,t){super(t),this.__language=e||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(e){super.afterCloneFrom(e),this.__language=e.__language,this.__theme=e.__theme,this.__isSyntaxHighlightSupported=e.__isSyntaxHighlightSupported}createDOM(t){const n=document.createElement("code");e.addClassNamesToElement(n,t.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute(o,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(s,r));const i=this.getTheme();i&&n.setAttribute(a,i);const g=this.getStyle();return g&&n.setAttribute("style",g),n}updateDOM(e,t,n){const r=this.__language,i=e.__language;r?r!==i&&t.setAttribute(o,r):i&&t.removeAttribute(o);const g=this.__isSyntaxHighlightSupported;e.__isSyntaxHighlightSupported&&i?g&&r?r!==i&&t.setAttribute(s,r):t.removeAttribute(s):g&&r&&t.setAttribute(s,r);const l=this.__theme,c=e.__theme;l?l!==c&&t.setAttribute(a,l):c&&t.removeAttribute(a);const u=this.__style,d=e.__style;return u?u!==d&&t.setAttribute("style",u):d&&t.removeAttribute("style"),!1}exportDOM(t){const n=document.createElement("pre");e.addClassNamesToElement(n,t._config.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute(o,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(s,r));const i=this.getTheme();i&&n.setAttribute(a,i);const g=this.getStyle();return g&&n.setAttribute("style",g),{element:n}}static importDOM(){return{code:e=>null!=e.textContent&&(/\r?\n/.test(e.textContent)||i(e,"BR"))?{conversion:u,priority:1}:null,div:()=>({conversion:d,priority:1}),pre:()=>({conversion:u,priority:0}),table:e=>N(e)?{conversion:p,priority:3}:null,td:e=>{const t=e,n=t.closest("table");return t.classList.contains("js-file-line")||n&&N(n)?{conversion:f,priority:3}:null},tr:e=>{const t=e.closest("table");return t&&N(t)?{conversion:f,priority:3}:null}}}static importJSON(e){return l().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setLanguage(e.language).setTheme(e.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(e,n=!0){const r=this.getChildren(),i=r.length;if(i>=2&&"\n"===r[i-1].getTextContent()&&"\n"===r[i-2].getTextContent()&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===i){r[i-1].remove(),r[i-2].remove();const e=t.$createParagraphNode();return this.insertAfter(e,n),e}const{anchor:o,focus:s}=e,a=(o.isBefore(s)?o:s).getNode();if(t.$isTextNode(a)){let e=y(a);const n=[];for(;;)if(t.$isTabNode(e))n.push(t.$createTabNode()),e=e.getNextSibling();else{if(!x(e))break;{let t=0;const r=e.getTextContent(),i=e.getTextContentSize();for(;t<i&&" "===r[t];)t++;if(0!==t&&n.push(T(" ".repeat(t))),t!==i)break;e=e.getNextSibling()}}const r=a.splitText(o.offset)[0],i=0===o.offset?0:1,s=r.getIndexWithinParent()+i,g=a.getParentOrThrow(),l=[t.$createLineBreakNode(),...n];g.splice(s,0,l);const c=n[n.length-1];c?c.select():0===o.offset?r.selectPrevious():r.getNextSibling().selectNext(0,0)}if(c(a)){const{offset:n}=e.anchor;a.splice(n,0,[t.$createLineBreakNode()]),a.select(n+1,n+1)}return null}canIndent(){return!1}collapseAtStart(){const e=t.$createParagraphNode();return this.getChildren().forEach(t=>e.append(t)),this.replace(e),!0}setLanguage(e){const t=this.getWritable();return t.__language=e||void 0,t}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(e){const t=this.getWritable();return t.__isSyntaxHighlightSupported=e,t}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(e){const t=this.getWritable();return t.__theme=e||void 0,t}getTheme(){return this.getLatest().__theme}}function l(e,n){return t.$create(g).setLanguage(e).setTheme(n)}function c(e){return e instanceof g}function u(e){return{node:l(e.getAttribute(o))}}function d(e){const t=e,n=h(t);return n||function(e){let t=e.parentElement;for(;null!==t;){if(h(t))return!0;t=t.parentElement}return!1}(t)?{node:n?l():null}:{node:null}}function p(){return{node:l()}}function f(){return{node:null}}function h(e){return null!==e.style.fontFamily.match("monospace")}function N(e){return e.classList.contains("js-file-line-container")}class m extends t.TextNode{__highlightType;constructor(e="",t,n){super(e,n),this.__highlightType=t}static getType(){return"code-highlight"}static clone(e){return new m(e.__text,e.__highlightType||void 0,e.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(e){const t=this.getWritable();return t.__highlightType=e||void 0,t}canHaveFormat(){return!1}createDOM(t){const n=super.createDOM(t),r=_(t.theme,this.__highlightType);return e.addClassNamesToElement(n,r),n}updateDOM(t,n,r){const i=super.updateDOM(t,n,r),o=_(r.theme,t.__highlightType),s=_(r.theme,this.__highlightType);return o!==s&&(o&&e.removeClassNamesFromElement(n,o),s&&e.addClassNamesToElement(n,s)),i}static importJSON(e){return T().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHighlightType(e.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return l()}}function _(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function T(e="",n){return t.$applyNodeReplacement(new m(e,n))}function x(e){return e instanceof m}function C(n,r){let i=n;for(let o=t.$getSiblingCaret(n,r);o&&(x(o.origin)||t.$isTabNode(o.origin));o=e.$getAdjacentCaret(o))i=o.origin;return i}function y(e){return C(e,"previous")}function O(e){return C(e,"next")}function S(e){const n=y(e),r=O(e);let i=n;for(;null!==i;){if(x(i)){const e=t.getTextDirection(i.getTextContent());if(null!==e)return e}if(i===r)break;i=i.getNextSibling()}const o=n.getParent();if(t.$isElementNode(o)){const e=o.getDirection();if("ltr"===e||"rtl"===e)return e}return null}function $(e,r){let i=null,o=null,s=e,a=r,g=e.getTextContent();for(;;){if(0===a){if(s=s.getPreviousSibling(),null===s)break;if(x(s)||t.$isTabNode(s)||t.$isLineBreakNode(s)||n(167),t.$isLineBreakNode(s)){i={node:s,offset:1};break}a=Math.max(0,s.getTextContentSize()-1),g=s.getTextContent()}else a--;const e=g[a];x(s)&&" "!==e&&(o={node:s,offset:a})}if(null!==o)return o;let l=null;if(r<e.getTextContentSize())x(e)&&(l=e.getTextContent()[r]);else{const t=e.getNextSibling();x(t)&&(l=t.getTextContent()[0])}if(null!==l&&" "!==l)return i;{const n=function(e,n){let r=e,i=n,o=e.getTextContent(),s=e.getTextContentSize();for(;;){if(!x(r)||i===s){if(r=r.getNextSibling(),null===r||t.$isLineBreakNode(r))return null;x(r)&&(i=0,o=r.getTextContent(),s=r.getTextContentSize())}if(x(r)){if(" "!==o[i])return{node:r,offset:i};i++}}}(e,r);return null!==n?n:i}}function A(e){const r=O(e);return t.$isLineBreakNode(r)&&n(168),r}const L=t.defineExtension({name:"@lexical/code",nodes:()=>[g,m]});const Prism=globalThis.Prism||window.Prism;!function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],i=[];/^\w+$/.test(n)||i.push(/\w+/.exec(n)[0]),"diff"===n&&i.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+"].*(?:\r\n?|\n|(?![\\s\\S])))+","m"),alias:i,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})}(Prism);const b=Prism,M={c:"C",clike:"C-like",cpp:"C++",css:"CSS",html:"HTML",java:"Java",js:"JavaScript",markdown:"Markdown",objc:"Objective-C",plain:"Plain Text",powershell:"PowerShell",py:"Python",rust:"Rust",sql:"SQL",swift:"Swift",typescript:"TypeScript",xml:"XML"},E={cpp:"cpp",java:"java",javascript:"js",md:"markdown",plaintext:"plain",python:"py",text:"plain",ts:"typescript"};function D(e){return E[e]||e}function v(e){return"string"==typeof e?e:Array.isArray(e)?e.map(v).join(""):v(e.content)}function R(e,t){const n=/^diff-([\w-]+)/i.exec(t),r=e.getTextContent();let i=b.tokenize(r,b.languages[n?"diff":t]);return n&&(i=function(e,t){const n=t,r=b.languages[n],i={tokens:e},o=b.languages.diff.PREFIXES;for(const e of i.tokens){if("string"==typeof e||!(e.type in o)||!Array.isArray(e.content))continue;const t=e.type;let n=0;const i=()=>(n++,new b.Token("prefix",o[t],t.replace(/^(\w+).*/,"$1"))),s=e.content.filter(e=>"string"==typeof e||"prefix"!==e.type),a=e.content.length-s.length,g=b.tokenize(v(s),r);g.unshift(i());const l=/\r\n|\n/g,c=e=>{const t=[];l.lastIndex=0;let r,o=0;for(;n<a&&(r=l.exec(e));){const n=r.index+r[0].length;t.push(e.slice(o,n)),o=n,t.push(i())}if(0!==t.length)return o<e.length&&t.push(e.slice(o)),t},u=e=>{for(let t=0;t<e.length&&n<a;t++){const n=e[t];if("string"==typeof n){const r=c(n);r&&(e.splice(t,1,...r),t+=r.length-1)}else if("string"==typeof n.content){const e=c(n.content);e&&(n.content=e)}else Array.isArray(n.content)?u(n.content):u([n.content])}};u(g),n<a&&g.push(i()),e.content=g}return i.tokens}(i,n[1])),k(i)}function k(e,n){const r=[];for(const i of e)if("string"==typeof i){const e=i.split(/(\n|\t)/),o=e.length;for(let i=0;i<o;i++){const o=e[i];"\n"===o||"\r\n"===o?r.push(t.$createLineBreakNode()):"\t"===o?r.push(t.$createTabNode()):o.length>0&&r.push(T(o,n))}}else{const{content:e,alias:t}=i;"string"==typeof e?r.push(...k([e],"prefix"===i.type&&"string"==typeof t?t:i.type)):Array.isArray(e)&&r.push(...k(e,"unchanged"===i.type?void 0:i.type))}return r}const P={$tokenize(e,t){return R(e,t||this.defaultLanguage)},defaultLanguage:r,tokenize(e,t){return b.tokenize(e,b.languages[t||""]||b.languages[this.defaultLanguage])}};function I(e,n,r){const i=e.getParent();c(i)?j(i,n,r):x(e)&&e.replace(t.$createTextNode(e.__text))}function w(e,n){const r=n.getElementByKey(e.getKey());if(null===r)return;const i=e.getChildren(),o=i.length;if(o===r.__cachedChildrenLength)return;r.__cachedChildrenLength=o;let s="1",a=1;for(let e=0;e<o;e++)t.$isLineBreakNode(i[e])&&(s+="\n"+ ++a);r.setAttribute("data-gutter",s)}const B=new Set;function j(e,n,r){const i=e.getKey(),o=n.getKey()+"/"+i;void 0===e.getLanguage()&&e.setLanguage(r.defaultLanguage);const s=e.getLanguage()||r.defaultLanguage;if(!function(e){const t=function(e){const t=/^diff-([\w-]+)/i.exec(e);return t?t[1]:null}(e),n=t||e;try{return!!n&&b.languages.hasOwnProperty(n)}catch(e){return!1}}(s))return e.getIsSyntaxHighlightSupported()&&e.setIsSyntaxHighlightSupported(!1),void async function(){}();e.getIsSyntaxHighlightSupported()||e.setIsSyntaxHighlightSupported(!0),B.has(o)||(B.add(o),n.update(()=>{!function(e,n){const r=t.$getNodeByKey(e);if(!c(r)||!r.isAttached())return;const i=t.$getSelection();if(!t.$isRangeSelection(i))return void n();const o=i.anchor,s=o.offset,a="element"===o.type&&t.$isLineBreakNode(r.getChildAtIndex(o.offset-1));let g=0;if(!a){const e=o.getNode();g=s+e.getPreviousSiblings().reduce((e,t)=>e+t.getTextContentSize(),0)}if(!n())return;if(a)return void o.getNode().select(s,s);r.getChildren().some(e=>{const n=t.$isTextNode(e);if(n||t.$isLineBreakNode(e)){const t=e.getTextContentSize();if(n&&t>=g)return e.select(g,g),!0;g-=t}return!1})}(i,()=>{const n=t.$getNodeByKey(i);if(!c(n)||!n.isAttached())return!1;const o=n.getLanguage()||r.defaultLanguage,s=r.$tokenize(n,o),a=function(e,t){let n=0;for(;n<e.length&&H(e[n],t[n]);)n++;const r=e.length,i=t.length,o=Math.min(r,i)-n;let s=0;for(;s<o;)if(s++,!H(e[r-s],t[i-s])){s--;break}const a=n,g=r-s,l=t.slice(n,i-s);return{from:a,nodesForReplacement:l,to:g}}(n.getChildren(),s),{from:g,to:l,nodesForReplacement:u}=a;return!(g===l&&!u.length)&&(e.splice(g,l-g,u),!0)})},{onUpdate:()=>{B.delete(o)},skipTransforms:!0}))}function H(e,n){return x(e)&&x(n)&&e.__text===n.__text&&e.__highlightType===n.__highlightType||t.$isTabNode(e)&&t.$isTabNode(n)||t.$isLineBreakNode(e)&&t.$isLineBreakNode(n)}function K(e){if(!t.$isRangeSelection(e))return!1;const n=e.anchor.getNode(),r=c(n)?n:n.getParent(),i=e.focus.getNode(),o=c(i)?i:i.getParent();return c(r)&&r.is(o)}function F(e){const r=e.getNodes(),i=[];if(1===r.length&&c(r[0]))return i;let o=[];for(let e=0;e<r.length;e++){const s=r[e];x(s)||t.$isTabNode(s)||t.$isLineBreakNode(s)||n(169),t.$isLineBreakNode(s)?o.length>0&&(i.push(o),o=[]):o.push(s)}if(o.length>0){const n=e.isBackward()?e.anchor:e.focus,r=t.$createPoint(o[0].getKey(),0,"text");n.is(r)||i.push(o)}return i}function q(e){const n=t.$getSelection();if(!t.$isRangeSelection(n)||!K(n))return!1;const r=F(n),i=r.length;if(0===i&&n.isCollapsed())return e===t.INDENT_CONTENT_COMMAND&&n.insertNodes([t.$createTabNode()]),!0;if(0===i&&e===t.INDENT_CONTENT_COMMAND&&"\n"===n.getTextContent()){const e=t.$createTabNode(),r=t.$createLineBreakNode(),i=n.isBackward()?"previous":"next";return n.insertNodes([e,r]),t.$setSelectionFromCaretRange(t.$getCaretRangeInDirection(t.$getCaretRange(t.$getTextPointCaret(e,"next",0),t.$normalizeCaret(t.$getSiblingCaret(r,"next"))),i)),!0}for(let o=0;o<i;o++){const i=r[o];if(i.length>0){let r=i[0];if(0===o&&(r=y(r)),e===t.INDENT_CONTENT_COMMAND){const e=t.$createTabNode();if(r.insertBefore(e),0===o){const i=n.isBackward()?"focus":"anchor",o=t.$createPoint(r.getKey(),0,"text");n[i].is(o)&&n[i].set(e.getKey(),0,"text")}}else t.$isTabNode(r)&&r.remove()}}return!0}function W(e,n){const r=t.$getSelection();if(!t.$isRangeSelection(r))return!1;const{anchor:i,focus:o}=r,s=i.offset,a=o.offset,g=i.getNode(),l=o.getNode(),c=e===t.KEY_ARROW_UP_COMMAND;if(!K(r)||!x(g)&&!t.$isTabNode(g)||!x(l)&&!t.$isTabNode(l))return!1;if(!n.altKey){if(r.isCollapsed()){const e=g.getParentOrThrow();if(c&&0===s&&null===g.getPreviousSibling()){if(null===e.getPreviousSibling())return e.selectPrevious(),n.preventDefault(),!0}else if(!c&&s===g.getTextContentSize()&&null===g.getNextSibling()){if(null===e.getNextSibling())return e.selectNext(),n.preventDefault(),!0}}return!1}let u,d;if(g.isBefore(l)?(u=y(g),d=O(l)):(u=y(l),d=O(g)),null==u||null==d)return!1;const p=u.getNodesBetween(d);for(let e=0;e<p.length;e++){const n=p[e];if(!x(n)&&!t.$isTabNode(n)&&!t.$isLineBreakNode(n))return!1}n.preventDefault(),n.stopPropagation();const f=c?u.getPreviousSibling():d.getNextSibling();if(!t.$isLineBreakNode(f))return!0;const h=c?f.getPreviousSibling():f.getNextSibling();if(null==h)return!0;const N=x(h)||t.$isTabNode(h)||t.$isLineBreakNode(h)?c?y(h):O(h):null;let m=null!=N?N:h;return f.remove(),p.forEach(e=>e.remove()),e===t.KEY_ARROW_UP_COMMAND?(p.forEach(e=>m.insertBefore(e)),m.insertBefore(f)):(m.insertAfter(f),m=f,p.forEach(e=>{m.insertAfter(e),m=e})),r.setTextNodeRange(g,s,l,a),!0}function z(e,n){const r=t.$getSelection();if(!t.$isRangeSelection(r))return!1;const{anchor:i,focus:o}=r,s=i.getNode(),a=o.getNode(),g=e===t.MOVE_TO_START;if(!K(r)||!x(s)&&!t.$isTabNode(s)||!x(a)&&!t.$isTabNode(a))return!1;const l=a;if("rtl"===S(l)?!g:g){const e=$(l,o.offset);if(null!==e){const{node:n,offset:i}=e;t.$isLineBreakNode(n)?n.selectNext(0,0):r.setTextNodeRange(n,i,n,i)}else l.getParentOrThrow().selectStart()}else{A(l).select()}return n.preventDefault(),n.stopPropagation(),!0}const Y=y,U=O,J=A,G=$;exports.$createCodeHighlightNode=T,exports.$createCodeNode=l,exports.$getCodeLineDirection=S,exports.$getEndOfCodeInLine=A,exports.$getFirstCodeNodeOfLine=y,exports.$getLastCodeNodeOfLine=O,exports.$getStartOfCodeInLine=$,exports.$isCodeHighlightNode=x,exports.$isCodeNode=c,exports.CODE_LANGUAGE_FRIENDLY_NAME_MAP=M,exports.CODE_LANGUAGE_MAP=E,exports.CodeExtension=L,exports.CodeHighlightNode=m,exports.CodeNode=g,exports.DEFAULT_CODE_LANGUAGE=r,exports.PrismTokenizer=P,exports.getCodeLanguageOptions=function(){const e=[];for(const[t,n]of Object.entries(M))e.push([t,n]);return e},exports.getCodeLanguages=()=>Object.keys(b.languages).filter(e=>"function"!=typeof b.languages[e]).sort(),exports.getCodeThemeOptions=function(){return[]},exports.getDefaultCodeLanguage=()=>r,exports.getEndOfCodeInLine=J,exports.getFirstCodeNodeOfLine=Y,exports.getLanguageFriendlyName=function(e){const t=D(e);return M[t]||t},exports.getLastCodeNodeOfLine=U,exports.getStartOfCodeInLine=G,exports.normalizeCodeLang=D,exports.normalizeCodeLanguage=D,exports.registerCodeHighlighting=function(r,i){if(!r.hasNodes([g,m]))throw new Error("CodeHighlightPlugin: CodeNode or CodeHighlightNode not registered on editor");null==i&&(i=P);const o=[];return!0!==r._headless&&o.push(r.registerMutationListener(g,e=>{r.getEditorState().read(()=>{for(const[n,i]of e)if("destroyed"!==i){const e=t.$getNodeByKey(n);null!==e&&w(e,r)}})},{skipInitialization:!1})),o.push(r.registerNodeTransform(g,e=>j(e,r,i)),r.registerNodeTransform(t.TextNode,e=>I(e,r,i)),r.registerNodeTransform(m,e=>I(e,r,i)),r.registerCommand(t.KEY_TAB_COMMAND,e=>{const i=function(e){const r=t.$getSelection();if(!t.$isRangeSelection(r)||!K(r))return null;const i=e?t.OUTDENT_CONTENT_COMMAND:t.INDENT_CONTENT_COMMAND,o=e?t.OUTDENT_CONTENT_COMMAND:t.INSERT_TAB_COMMAND,s=r.anchor,a=r.focus;if(s.is(a))return o;const g=F(r);if(1!==g.length)return i;const l=g[0];let c,u;0===l.length&&n(285),r.isBackward()?(c=a,u=s):(c=s,u=a);const d=y(l[0]),p=O(l[0]),f=t.$createPoint(d.getKey(),0,"text"),h=t.$createPoint(p.getKey(),p.getTextContentSize(),"text");return c.isBefore(f)||h.isBefore(u)?i:f.isBefore(c)||u.isBefore(h)?o:i}(e.shiftKey);return null!==i&&(e.preventDefault(),r.dispatchCommand(i,void 0),!0)},t.COMMAND_PRIORITY_LOW),r.registerCommand(t.INSERT_TAB_COMMAND,()=>!!K(t.$getSelection())&&(t.$insertNodes([t.$createTabNode()]),!0),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.INDENT_CONTENT_COMMAND,e=>q(t.INDENT_CONTENT_COMMAND),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.OUTDENT_CONTENT_COMMAND,e=>q(t.OUTDENT_CONTENT_COMMAND),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.KEY_ARROW_UP_COMMAND,e=>{const n=t.$getSelection();if(!t.$isRangeSelection(n)||!K(n))return!1;const r=t.$getRoot().getFirstDescendant(),{anchor:i}=n,o=i.getNode();return(!r||!o||r.getKey()!==o.getKey())&&W(t.KEY_ARROW_UP_COMMAND,e)},t.COMMAND_PRIORITY_LOW),r.registerCommand(t.KEY_ARROW_DOWN_COMMAND,e=>{const n=t.$getSelection();if(!t.$isRangeSelection(n)||!K(n))return!1;const r=t.$getRoot().getLastDescendant(),{anchor:i}=n,o=i.getNode();return(!r||!o||r.getKey()!==o.getKey())&&W(t.KEY_ARROW_DOWN_COMMAND,e)},t.COMMAND_PRIORITY_LOW),r.registerCommand(t.MOVE_TO_START,e=>z(t.MOVE_TO_START,e),t.COMMAND_PRIORITY_LOW),r.registerCommand(t.MOVE_TO_END,e=>z(t.MOVE_TO_END,e),t.COMMAND_PRIORITY_LOW)),e.mergeRegister(...o)};
diff --git a/LexicalCode.prod.mjs b/LexicalCode.prod.mjs
index b0ce59d96ac2258c4fb6221e5baf0a43b0696256..b4c97815ac8d7b66b68a0f085ed1c17432f7d3eb 100644
--- a/LexicalCode.prod.mjs
+++ b/LexicalCode.prod.mjs
@@ -6,4 +6,4 @@
  *
  */
 
-import{isHTMLElement as t,addClassNamesToElement as e,removeClassNamesFromElement as n,$getAdjacentCaret as r,mergeRegister as i}from"@lexical/utils";import{ElementNode as o,$createParagraphNode as s,$isTextNode as l,$isTabNode as u,$createTabNode as c,$createLineBreakNode as g,$create as a,TextNode as f,$applyNodeReplacement as p,$getSiblingCaret as h,getTextDirection as d,$isElementNode as m,$isLineBreakNode as y,defineExtension as x,$createTextNode as _,$getNodeByKey as S,$getSelection as v,$isRangeSelection as T,$createPoint as b,INDENT_CONTENT_COMMAND as C,OUTDENT_CONTENT_COMMAND as N,INSERT_TAB_COMMAND as j,$setSelectionFromCaretRange as w,$getCaretRangeInDirection as k,$getCaretRange as A,$getTextPointCaret as L,$normalizeCaret as P,KEY_ARROW_UP_COMMAND as O,MOVE_TO_START as H,KEY_TAB_COMMAND as E,COMMAND_PRIORITY_LOW as z,$insertNodes as B,$getRoot as D,KEY_ARROW_DOWN_COMMAND as F,MOVE_TO_END as I}from"lexical";import"prismjs";import"prismjs/components/prism-clike.js";import"prismjs/components/prism-javascript.js";import"prismjs/components/prism-markup.js";import"prismjs/components/prism-markdown.js";import"prismjs/components/prism-c.js";import"prismjs/components/prism-css.js";import"prismjs/components/prism-objectivec.js";import"prismjs/components/prism-sql.js";import"prismjs/components/prism-powershell.js";import"prismjs/components/prism-python.js";import"prismjs/components/prism-rust.js";import"prismjs/components/prism-swift.js";import"prismjs/components/prism-typescript.js";import"prismjs/components/prism-java.js";import"prismjs/components/prism-cpp.js";function K(t,...e){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",t);for(const t of e)r.append("v",t);throw n.search=r.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const M="javascript",J=()=>M;function R(e,n){for(const r of e.childNodes){if(t(r)&&r.tagName===n)return!0;R(r,n)}return!1}const $="data-language",W="data-highlight-language",q="data-theme";class U extends o{__language;__theme;__isSyntaxHighlightSupported;static getType(){return"code"}static clone(t){return new U(t.__language,t.__key)}constructor(t,e){super(e),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const n=document.createElement("code");e(n,t.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute($,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(W,r));const i=this.getTheme();i&&n.setAttribute(q,i);const o=this.getStyle();return o&&n.setAttribute("style",o),n}updateDOM(t,e,n){const r=this.__language,i=t.__language;r?r!==i&&e.setAttribute($,r):i&&e.removeAttribute($);const o=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&i?o&&r?r!==i&&e.setAttribute(W,r):e.removeAttribute(W):o&&r&&e.setAttribute(W,r);const s=this.__theme,l=t.__theme;s?s!==l&&e.setAttribute(q,s):l&&e.removeAttribute(q);const u=this.__style,c=t.__style;return u?u!==c&&e.setAttribute("style",u):c&&e.removeAttribute("style"),!1}exportDOM(t){const n=document.createElement("pre");e(n,t._config.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute($,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(W,r));const i=this.getTheme();i&&n.setAttribute(q,i);const o=this.getStyle();return o&&n.setAttribute("style",o),{element:n}}static importDOM(){return{code:t=>null!=t.textContent&&(/\r?\n/.test(t.textContent)||R(t,"BR"))?{conversion:G,priority:1}:null,div:()=>({conversion:V,priority:1}),pre:()=>({conversion:G,priority:0}),table:t=>et(t)?{conversion:Y,priority:3}:null,td:t=>{const e=t,n=e.closest("table");return e.classList.contains("js-file-line")||n&&et(n)?{conversion:Z,priority:3}:null},tr:t=>{const e=t.closest("table");return e&&et(e)?{conversion:Z,priority:3}:null}}}static importJSON(t){return X().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,e=!0){const n=this.getChildren(),r=n.length;if(r>=2&&"\n"===n[r-1].getTextContent()&&"\n"===n[r-2].getTextContent()&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===r){n[r-1].remove(),n[r-2].remove();const t=s();return this.insertAfter(t,e),t}const{anchor:i,focus:o}=t,a=(i.isBefore(o)?i:o).getNode();if(l(a)){let t=lt(a);const e=[];for(;;)if(u(t))e.push(c()),t=t.getNextSibling();else{if(!ot(t))break;{let n=0;const r=t.getTextContent(),i=t.getTextContentSize();for(;n<i&&" "===r[n];)n++;if(0!==n&&e.push(it(" ".repeat(n))),n!==i)break;t=t.getNextSibling()}}const n=a.splitText(i.offset)[0],r=0===i.offset?0:1,o=n.getIndexWithinParent()+r,s=a.getParentOrThrow(),l=[g(),...e];s.splice(o,0,l);const f=e[e.length-1];f?f.select():0===i.offset?n.selectPrevious():n.getNextSibling().selectNext(0,0)}if(Q(a)){const{offset:e}=t.anchor;a.splice(e,0,[g()]),a.select(e+1,e+1)}return null}canIndent(){return!1}collapseAtStart(){const t=s();return this.getChildren().forEach(e=>t.append(e)),this.replace(t),!0}setLanguage(t){const e=this.getWritable();return e.__language=t||void 0,e}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const e=this.getWritable();return e.__isSyntaxHighlightSupported=t,e}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const e=this.getWritable();return e.__theme=t||void 0,e}getTheme(){return this.getLatest().__theme}}function X(t,e){return a(U).setLanguage(t).setTheme(e)}function Q(t){return t instanceof U}function G(t){return{node:X(t.getAttribute($))}}function V(t){const e=t,n=tt(e);return n||function(t){let e=t.parentElement;for(;null!==e;){if(tt(e))return!0;e=e.parentElement}return!1}(e)?{node:n?X():null}:{node:null}}function Y(){return{node:X()}}function Z(){return{node:null}}function tt(t){return null!==t.style.fontFamily.match("monospace")}function et(t){return t.classList.contains("js-file-line-container")}class nt extends f{__highlightType;constructor(t="",e,n){super(t,n),this.__highlightType=e}static getType(){return"code-highlight"}static clone(t){return new nt(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const e=this.getWritable();return e.__highlightType=t||void 0,e}canHaveFormat(){return!1}createDOM(t){const n=super.createDOM(t),r=rt(t.theme,this.__highlightType);return e(n,r),n}updateDOM(t,r,i){const o=super.updateDOM(t,r,i),s=rt(i.theme,t.__highlightType),l=rt(i.theme,this.__highlightType);return s!==l&&(s&&n(r,s),l&&e(r,l)),o}static importJSON(t){return it().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return X()}}function rt(t,e){return e&&t&&t.codeHighlight&&t.codeHighlight[e]}function it(t="",e){return p(new nt(t,e))}function ot(t){return t instanceof nt}function st(t,e){let n=t;for(let i=h(t,e);i&&(ot(i.origin)||u(i.origin));i=r(i))n=i.origin;return n}function lt(t){return st(t,"previous")}function ut(t){return st(t,"next")}function ct(t){const e=lt(t),n=ut(t);let r=e;for(;null!==r;){if(ot(r)){const t=d(r.getTextContent());if(null!==t)return t}if(r===n)break;r=r.getNextSibling()}const i=e.getParent();if(m(i)){const t=i.getDirection();if("ltr"===t||"rtl"===t)return t}return null}function gt(t,e){let n=null,r=null,i=t,o=e,s=t.getTextContent();for(;;){if(0===o){if(i=i.getPreviousSibling(),null===i)break;if(ot(i)||u(i)||y(i)||K(167),y(i)){n={node:i,offset:1};break}o=Math.max(0,i.getTextContentSize()-1),s=i.getTextContent()}else o--;const t=s[o];ot(i)&&" "!==t&&(r={node:i,offset:o})}if(null!==r)return r;let l=null;if(e<t.getTextContentSize())ot(t)&&(l=t.getTextContent()[e]);else{const e=t.getNextSibling();ot(e)&&(l=e.getTextContent()[0])}if(null!==l&&" "!==l)return n;{const r=function(t,e){let n=t,r=e,i=t.getTextContent(),o=t.getTextContentSize();for(;;){if(!ot(n)||r===o){if(n=n.getNextSibling(),null===n||y(n))return null;ot(n)&&(r=0,i=n.getTextContent(),o=n.getTextContentSize())}if(ot(n)){if(" "!==i[r])return{node:n,offset:r};r++}}}(t,e);return null!==r?r:n}}function at(t){const e=ut(t);return y(e)&&K(168),e}const ft=x({name:"@lexical/code",nodes:()=>[U,nt]});!function(t){t.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var e={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(e).forEach(function(n){var r=e[n],i=[];/^\w+$/.test(n)||i.push(/\w+/.exec(n)[0]),"diff"===n&&i.push("bold"),t.languages.diff[n]={pattern:RegExp("^(?:["+r+"].*(?:\r\n?|\n|(?![\\s\\S])))+","m"),alias:i,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(t.languages.diff,"PREFIXES",{value:e})}(Prism);const pt=globalThis.Prism||window.Prism,ht={c:"C",clike:"C-like",cpp:"C++",css:"CSS",html:"HTML",java:"Java",js:"JavaScript",markdown:"Markdown",objc:"Objective-C",plain:"Plain Text",powershell:"PowerShell",py:"Python",rust:"Rust",sql:"SQL",swift:"Swift",typescript:"TypeScript",xml:"XML"},dt={cpp:"cpp",java:"java",javascript:"js",md:"markdown",plaintext:"plain",python:"py",text:"plain",ts:"typescript"};function mt(t){return dt[t]||t}function yt(t){const e=mt(t);return ht[e]||e}const xt=()=>Object.keys(pt.languages).filter(t=>"function"!=typeof pt.languages[t]).sort();function _t(){const t=[];for(const[e,n]of Object.entries(ht))t.push([e,n]);return t}function St(){return[]}function vt(t){return"string"==typeof t?t:Array.isArray(t)?t.map(vt).join(""):vt(t.content)}function Tt(t,e){const n=/^diff-([\w-]+)/i.exec(e),r=t.getTextContent();let i=pt.tokenize(r,pt.languages[n?"diff":e]);return n&&(i=function(t,e){const n=e,r=pt.languages[n],i={tokens:t},o=pt.languages.diff.PREFIXES;for(const t of i.tokens){if("string"==typeof t||!(t.type in o)||!Array.isArray(t.content))continue;const e=t.type;let n=0;const i=()=>(n++,new pt.Token("prefix",o[e],e.replace(/^(\w+).*/,"$1"))),s=t.content.filter(t=>"string"==typeof t||"prefix"!==t.type),l=t.content.length-s.length,u=pt.tokenize(vt(s),r);u.unshift(i());const c=/\r\n|\n/g,g=t=>{const e=[];c.lastIndex=0;let r,o=0;for(;n<l&&(r=c.exec(t));){const n=r.index+r[0].length;e.push(t.slice(o,n)),o=n,e.push(i())}if(0!==e.length)return o<t.length&&e.push(t.slice(o)),e},a=t=>{for(let e=0;e<t.length&&n<l;e++){const n=t[e];if("string"==typeof n){const r=g(n);r&&(t.splice(e,1,...r),e+=r.length-1)}else if("string"==typeof n.content){const t=g(n.content);t&&(n.content=t)}else Array.isArray(n.content)?a(n.content):a([n.content])}};a(u),n<l&&u.push(i()),t.content=u}return i.tokens}(i,n[1])),bt(i)}function bt(t,e){const n=[];for(const r of t)if("string"==typeof r){const t=r.split(/(\n|\t)/),i=t.length;for(let r=0;r<i;r++){const i=t[r];"\n"===i||"\r\n"===i?n.push(g()):"\t"===i?n.push(c()):i.length>0&&n.push(it(i,e))}}else{const{content:t,alias:e}=r;"string"==typeof t?n.push(...bt([t],"prefix"===r.type&&"string"==typeof e?e:r.type)):Array.isArray(t)&&n.push(...bt(t,"unchanged"===r.type?void 0:r.type))}return n}const Ct={$tokenize(t,e){return Tt(t,e||this.defaultLanguage)},defaultLanguage:M,tokenize(t,e){return pt.tokenize(t,pt.languages[e||""]||pt.languages[this.defaultLanguage])}};function Nt(t,e,n){const r=t.getParent();Q(r)?kt(r,e,n):ot(t)&&t.replace(_(t.__text))}function jt(t,e){const n=e.getElementByKey(t.getKey());if(null===n)return;const r=t.getChildren(),i=r.length;if(i===n.__cachedChildrenLength)return;n.__cachedChildrenLength=i;let o="1",s=1;for(let t=0;t<i;t++)y(r[t])&&(o+="\n"+ ++s);n.setAttribute("data-gutter",o)}const wt=new Set;function kt(t,e,n){const r=t.getKey(),i=e.getKey()+"/"+r;void 0===t.getLanguage()&&t.setLanguage(n.defaultLanguage);const o=t.getLanguage()||n.defaultLanguage;if(!function(t){const e=function(t){const e=/^diff-([\w-]+)/i.exec(t);return e?e[1]:null}(t),n=e||t;try{return!!n&&pt.languages.hasOwnProperty(n)}catch(t){return!1}}(o))return t.getIsSyntaxHighlightSupported()&&t.setIsSyntaxHighlightSupported(!1),void async function(){}();t.getIsSyntaxHighlightSupported()||t.setIsSyntaxHighlightSupported(!0),wt.has(i)||(wt.add(i),e.update(()=>{!function(t,e){const n=S(t);if(!Q(n)||!n.isAttached())return;const r=v();if(!T(r))return void e();const i=r.anchor,o=i.offset,s="element"===i.type&&y(n.getChildAtIndex(i.offset-1));let u=0;if(!s){const t=i.getNode();u=o+t.getPreviousSiblings().reduce((t,e)=>t+e.getTextContentSize(),0)}if(!e())return;if(s)return void i.getNode().select(o,o);n.getChildren().some(t=>{const e=l(t);if(e||y(t)){const n=t.getTextContentSize();if(e&&n>=u)return t.select(u,u),!0;u-=n}return!1})}(r,()=>{const e=S(r);if(!Q(e)||!e.isAttached())return!1;const i=e.getLanguage()||n.defaultLanguage,o=n.$tokenize(e,i),s=function(t,e){let n=0;for(;n<t.length&&At(t[n],e[n]);)n++;const r=t.length,i=e.length,o=Math.min(r,i)-n;let s=0;for(;s<o;)if(s++,!At(t[r-s],e[i-s])){s--;break}const l=n,u=r-s,c=e.slice(n,i-s);return{from:l,nodesForReplacement:c,to:u}}(e.getChildren(),o),{from:l,to:u,nodesForReplacement:c}=s;return!(l===u&&!c.length)&&(t.splice(l,u-l,c),!0)})},{onUpdate:()=>{wt.delete(i)},skipTransforms:!0}))}function At(t,e){return ot(t)&&ot(e)&&t.__text===e.__text&&t.__highlightType===e.__highlightType||u(t)&&u(e)||y(t)&&y(e)}function Lt(t){if(!T(t))return!1;const e=t.anchor.getNode(),n=Q(e)?e:e.getParent(),r=t.focus.getNode(),i=Q(r)?r:r.getParent();return Q(n)&&n.is(i)}function Pt(t){const e=t.getNodes(),n=[];if(1===e.length&&Q(e[0]))return n;let r=[];for(let t=0;t<e.length;t++){const i=e[t];ot(i)||u(i)||y(i)||K(169),y(i)?r.length>0&&(n.push(r),r=[]):r.push(i)}if(r.length>0){const e=t.isBackward()?t.anchor:t.focus,i=b(r[0].getKey(),0,"text");e.is(i)||n.push(r)}return n}function Ot(t){const e=v();if(!T(e)||!Lt(e))return!1;const n=Pt(e),r=n.length;if(0===r&&e.isCollapsed())return t===C&&e.insertNodes([c()]),!0;if(0===r&&t===C&&"\n"===e.getTextContent()){const t=c(),n=g(),r=e.isBackward()?"previous":"next";return e.insertNodes([t,n]),w(k(A(L(t,"next",0),P(h(n,"next"))),r)),!0}for(let i=0;i<r;i++){const r=n[i];if(r.length>0){let n=r[0];if(0===i&&(n=lt(n)),t===C){const t=c();if(n.insertBefore(t),0===i){const r=e.isBackward()?"focus":"anchor",i=b(n.getKey(),0,"text");e[r].is(i)&&e[r].set(t.getKey(),0,"text")}}else u(n)&&n.remove()}}return!0}function Ht(t,e){const n=v();if(!T(n))return!1;const{anchor:r,focus:i}=n,o=r.offset,s=i.offset,l=r.getNode(),c=i.getNode(),g=t===O;if(!Lt(n)||!ot(l)&&!u(l)||!ot(c)&&!u(c))return!1;if(!e.altKey){if(n.isCollapsed()){const t=l.getParentOrThrow();if(g&&0===o&&null===l.getPreviousSibling()){if(null===t.getPreviousSibling())return t.selectPrevious(),e.preventDefault(),!0}else if(!g&&o===l.getTextContentSize()&&null===l.getNextSibling()){if(null===t.getNextSibling())return t.selectNext(),e.preventDefault(),!0}}return!1}let a,f;if(l.isBefore(c)?(a=lt(l),f=ut(c)):(a=lt(c),f=ut(l)),null==a||null==f)return!1;const p=a.getNodesBetween(f);for(let t=0;t<p.length;t++){const e=p[t];if(!ot(e)&&!u(e)&&!y(e))return!1}e.preventDefault(),e.stopPropagation();const h=g?a.getPreviousSibling():f.getNextSibling();if(!y(h))return!0;const d=g?h.getPreviousSibling():h.getNextSibling();if(null==d)return!0;const m=ot(d)||u(d)||y(d)?g?lt(d):ut(d):null;let x=null!=m?m:d;return h.remove(),p.forEach(t=>t.remove()),t===O?(p.forEach(t=>x.insertBefore(t)),x.insertBefore(h)):(x.insertAfter(h),x=h,p.forEach(t=>{x.insertAfter(t),x=t})),n.setTextNodeRange(l,o,c,s),!0}function Et(t,e){const n=v();if(!T(n))return!1;const{anchor:r,focus:i}=n,o=r.getNode(),s=i.getNode(),l=t===H;if(!Lt(n)||!ot(o)&&!u(o)||!ot(s)&&!u(s))return!1;const c=s;if("rtl"===ct(c)?!l:l){const t=gt(c,i.offset);if(null!==t){const{node:e,offset:r}=t;y(e)?e.selectNext(0,0):n.setTextNodeRange(e,r,e,r)}else c.getParentOrThrow().selectStart()}else{at(c).select()}return e.preventDefault(),e.stopPropagation(),!0}function zt(t,e){if(!t.hasNodes([U,nt]))throw new Error("CodeHighlightPlugin: CodeNode or CodeHighlightNode not registered on editor");null==e&&(e=Ct);const n=[];return!0!==t._headless&&n.push(t.registerMutationListener(U,e=>{t.getEditorState().read(()=>{for(const[n,r]of e)if("destroyed"!==r){const e=S(n);null!==e&&jt(e,t)}})},{skipInitialization:!1})),n.push(t.registerNodeTransform(U,n=>kt(n,t,e)),t.registerNodeTransform(f,n=>Nt(n,t,e)),t.registerNodeTransform(nt,n=>Nt(n,t,e)),t.registerCommand(E,e=>{const n=function(t){const e=v();if(!T(e)||!Lt(e))return null;const n=t?N:C,r=t?N:j,i=e.anchor,o=e.focus;if(i.is(o))return r;const s=Pt(e);if(1!==s.length)return n;const l=s[0];let u,c;0===l.length&&K(285),e.isBackward()?(u=o,c=i):(u=i,c=o);const g=lt(l[0]),a=ut(l[0]),f=b(g.getKey(),0,"text"),p=b(a.getKey(),a.getTextContentSize(),"text");return u.isBefore(f)||p.isBefore(c)?n:f.isBefore(u)||c.isBefore(p)?r:n}(e.shiftKey);return null!==n&&(e.preventDefault(),t.dispatchCommand(n,void 0),!0)},z),t.registerCommand(j,()=>!!Lt(v())&&(B([c()]),!0),z),t.registerCommand(C,t=>Ot(C),z),t.registerCommand(N,t=>Ot(N),z),t.registerCommand(O,t=>{const e=v();if(!T(e)||!Lt(e))return!1;const n=D().getFirstDescendant(),{anchor:r}=e,i=r.getNode();return(!n||!i||n.getKey()!==i.getKey())&&Ht(O,t)},z),t.registerCommand(F,t=>{const e=v();if(!T(e)||!Lt(e))return!1;const n=D().getLastDescendant(),{anchor:r}=e,i=r.getNode();return(!n||!i||n.getKey()!==i.getKey())&&Ht(F,t)},z),t.registerCommand(H,t=>Et(H,t),z),t.registerCommand(I,t=>Et(I,t),z)),i(...n)}const Bt=lt,Dt=ut,Ft=at,It=gt;export{it as $createCodeHighlightNode,X as $createCodeNode,ct as $getCodeLineDirection,at as $getEndOfCodeInLine,lt as $getFirstCodeNodeOfLine,ut as $getLastCodeNodeOfLine,gt as $getStartOfCodeInLine,ot as $isCodeHighlightNode,Q as $isCodeNode,ht as CODE_LANGUAGE_FRIENDLY_NAME_MAP,dt as CODE_LANGUAGE_MAP,ft as CodeExtension,nt as CodeHighlightNode,U as CodeNode,M as DEFAULT_CODE_LANGUAGE,Ct as PrismTokenizer,_t as getCodeLanguageOptions,xt as getCodeLanguages,St as getCodeThemeOptions,J as getDefaultCodeLanguage,Ft as getEndOfCodeInLine,Bt as getFirstCodeNodeOfLine,yt as getLanguageFriendlyName,Dt as getLastCodeNodeOfLine,It as getStartOfCodeInLine,mt as normalizeCodeLang,mt as normalizeCodeLanguage,zt as registerCodeHighlighting};
+import{isHTMLElement as t,addClassNamesToElement as e,removeClassNamesFromElement as n,$getAdjacentCaret as r,mergeRegister as i}from"@lexical/utils";import{ElementNode as o,$createParagraphNode as s,$isTextNode as l,$isTabNode as u,$createTabNode as c,$createLineBreakNode as g,$create as a,TextNode as f,$applyNodeReplacement as p,$getSiblingCaret as h,getTextDirection as d,$isElementNode as m,$isLineBreakNode as y,defineExtension as x,$createTextNode as _,$getNodeByKey as S,$getSelection as v,$isRangeSelection as T,$createPoint as b,INDENT_CONTENT_COMMAND as C,OUTDENT_CONTENT_COMMAND as N,INSERT_TAB_COMMAND as j,$setSelectionFromCaretRange as w,$getCaretRangeInDirection as k,$getCaretRange as A,$getTextPointCaret as L,$normalizeCaret as P,KEY_ARROW_UP_COMMAND as O,MOVE_TO_START as H,KEY_TAB_COMMAND as E,COMMAND_PRIORITY_LOW as z,$insertNodes as B,$getRoot as D,KEY_ARROW_DOWN_COMMAND as F,MOVE_TO_END as I}from"lexical";function K(t,...e){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",t);for(const t of e)r.append("v",t);throw n.search=r.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const M="javascript",J=()=>M;function R(e,n){for(const r of e.childNodes){if(t(r)&&r.tagName===n)return!0;R(r,n)}return!1}const $="data-language",W="data-highlight-language",q="data-theme";class U extends o{__language;__theme;__isSyntaxHighlightSupported;static getType(){return"code"}static clone(t){return new U(t.__language,t.__key)}constructor(t,e){super(e),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const n=document.createElement("code");e(n,t.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute($,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(W,r));const i=this.getTheme();i&&n.setAttribute(q,i);const o=this.getStyle();return o&&n.setAttribute("style",o),n}updateDOM(t,e,n){const r=this.__language,i=t.__language;r?r!==i&&e.setAttribute($,r):i&&e.removeAttribute($);const o=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&i?o&&r?r!==i&&e.setAttribute(W,r):e.removeAttribute(W):o&&r&&e.setAttribute(W,r);const s=this.__theme,l=t.__theme;s?s!==l&&e.setAttribute(q,s):l&&e.removeAttribute(q);const u=this.__style,c=t.__style;return u?u!==c&&e.setAttribute("style",u):c&&e.removeAttribute("style"),!1}exportDOM(t){const n=document.createElement("pre");e(n,t._config.theme.code),n.setAttribute("spellcheck","false");const r=this.getLanguage();r&&(n.setAttribute($,r),this.getIsSyntaxHighlightSupported()&&n.setAttribute(W,r));const i=this.getTheme();i&&n.setAttribute(q,i);const o=this.getStyle();return o&&n.setAttribute("style",o),{element:n}}static importDOM(){return{code:t=>null!=t.textContent&&(/\r?\n/.test(t.textContent)||R(t,"BR"))?{conversion:G,priority:1}:null,div:()=>({conversion:V,priority:1}),pre:()=>({conversion:G,priority:0}),table:t=>et(t)?{conversion:Y,priority:3}:null,td:t=>{const e=t,n=e.closest("table");return e.classList.contains("js-file-line")||n&&et(n)?{conversion:Z,priority:3}:null},tr:t=>{const e=t.closest("table");return e&&et(e)?{conversion:Z,priority:3}:null}}}static importJSON(t){return X().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,e=!0){const n=this.getChildren(),r=n.length;if(r>=2&&"\n"===n[r-1].getTextContent()&&"\n"===n[r-2].getTextContent()&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===r){n[r-1].remove(),n[r-2].remove();const t=s();return this.insertAfter(t,e),t}const{anchor:i,focus:o}=t,a=(i.isBefore(o)?i:o).getNode();if(l(a)){let t=lt(a);const e=[];for(;;)if(u(t))e.push(c()),t=t.getNextSibling();else{if(!ot(t))break;{let n=0;const r=t.getTextContent(),i=t.getTextContentSize();for(;n<i&&" "===r[n];)n++;if(0!==n&&e.push(it(" ".repeat(n))),n!==i)break;t=t.getNextSibling()}}const n=a.splitText(i.offset)[0],r=0===i.offset?0:1,o=n.getIndexWithinParent()+r,s=a.getParentOrThrow(),l=[g(),...e];s.splice(o,0,l);const f=e[e.length-1];f?f.select():0===i.offset?n.selectPrevious():n.getNextSibling().selectNext(0,0)}if(Q(a)){const{offset:e}=t.anchor;a.splice(e,0,[g()]),a.select(e+1,e+1)}return null}canIndent(){return!1}collapseAtStart(){const t=s();return this.getChildren().forEach(e=>t.append(e)),this.replace(t),!0}setLanguage(t){const e=this.getWritable();return e.__language=t||void 0,e}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const e=this.getWritable();return e.__isSyntaxHighlightSupported=t,e}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const e=this.getWritable();return e.__theme=t||void 0,e}getTheme(){return this.getLatest().__theme}}function X(t,e){return a(U).setLanguage(t).setTheme(e)}function Q(t){return t instanceof U}function G(t){return{node:X(t.getAttribute($))}}function V(t){const e=t,n=tt(e);return n||function(t){let e=t.parentElement;for(;null!==e;){if(tt(e))return!0;e=e.parentElement}return!1}(e)?{node:n?X():null}:{node:null}}function Y(){return{node:X()}}function Z(){return{node:null}}function tt(t){return null!==t.style.fontFamily.match("monospace")}function et(t){return t.classList.contains("js-file-line-container")}class nt extends f{__highlightType;constructor(t="",e,n){super(t,n),this.__highlightType=e}static getType(){return"code-highlight"}static clone(t){return new nt(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const e=this.getWritable();return e.__highlightType=t||void 0,e}canHaveFormat(){return!1}createDOM(t){const n=super.createDOM(t),r=rt(t.theme,this.__highlightType);return e(n,r),n}updateDOM(t,r,i){const o=super.updateDOM(t,r,i),s=rt(i.theme,t.__highlightType),l=rt(i.theme,this.__highlightType);return s!==l&&(s&&n(r,s),l&&e(r,l)),o}static importJSON(t){return it().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return X()}}function rt(t,e){return e&&t&&t.codeHighlight&&t.codeHighlight[e]}function it(t="",e){return p(new nt(t,e))}function ot(t){return t instanceof nt}function st(t,e){let n=t;for(let i=h(t,e);i&&(ot(i.origin)||u(i.origin));i=r(i))n=i.origin;return n}function lt(t){return st(t,"previous")}function ut(t){return st(t,"next")}function ct(t){const e=lt(t),n=ut(t);let r=e;for(;null!==r;){if(ot(r)){const t=d(r.getTextContent());if(null!==t)return t}if(r===n)break;r=r.getNextSibling()}const i=e.getParent();if(m(i)){const t=i.getDirection();if("ltr"===t||"rtl"===t)return t}return null}function gt(t,e){let n=null,r=null,i=t,o=e,s=t.getTextContent();for(;;){if(0===o){if(i=i.getPreviousSibling(),null===i)break;if(ot(i)||u(i)||y(i)||K(167),y(i)){n={node:i,offset:1};break}o=Math.max(0,i.getTextContentSize()-1),s=i.getTextContent()}else o--;const t=s[o];ot(i)&&" "!==t&&(r={node:i,offset:o})}if(null!==r)return r;let l=null;if(e<t.getTextContentSize())ot(t)&&(l=t.getTextContent()[e]);else{const e=t.getNextSibling();ot(e)&&(l=e.getTextContent()[0])}if(null!==l&&" "!==l)return n;{const r=function(t,e){let n=t,r=e,i=t.getTextContent(),o=t.getTextContentSize();for(;;){if(!ot(n)||r===o){if(n=n.getNextSibling(),null===n||y(n))return null;ot(n)&&(r=0,i=n.getTextContent(),o=n.getTextContentSize())}if(ot(n)){if(" "!==i[r])return{node:n,offset:r};r++}}}(t,e);return null!==r?r:n}}function at(t){const e=ut(t);return y(e)&&K(168),e}const ft=x({name:"@lexical/code",nodes:()=>[U,nt]});const Prism=globalThis.Prism||window.Prism;!function(t){t.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var e={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(e).forEach(function(n){var r=e[n],i=[];/^\w+$/.test(n)||i.push(/\w+/.exec(n)[0]),"diff"===n&&i.push("bold"),t.languages.diff[n]={pattern:RegExp("^(?:["+r+"].*(?:\r\n?|\n|(?![\\s\\S])))+","m"),alias:i,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(t.languages.diff,"PREFIXES",{value:e})}(Prism);const pt=Prism,ht={c:"C",clike:"C-like",cpp:"C++",css:"CSS",html:"HTML",java:"Java",js:"JavaScript",markdown:"Markdown",objc:"Objective-C",plain:"Plain Text",powershell:"PowerShell",py:"Python",rust:"Rust",sql:"SQL",swift:"Swift",typescript:"TypeScript",xml:"XML"},dt={cpp:"cpp",java:"java",javascript:"js",md:"markdown",plaintext:"plain",python:"py",text:"plain",ts:"typescript"};function mt(t){return dt[t]||t}function yt(t){const e=mt(t);return ht[e]||e}const xt=()=>Object.keys(pt.languages).filter(t=>"function"!=typeof pt.languages[t]).sort();function _t(){const t=[];for(const[e,n]of Object.entries(ht))t.push([e,n]);return t}function St(){return[]}function vt(t){return"string"==typeof t?t:Array.isArray(t)?t.map(vt).join(""):vt(t.content)}function Tt(t,e){const n=/^diff-([\w-]+)/i.exec(e),r=t.getTextContent();let i=pt.tokenize(r,pt.languages[n?"diff":e]);return n&&(i=function(t,e){const n=e,r=pt.languages[n],i={tokens:t},o=pt.languages.diff.PREFIXES;for(const t of i.tokens){if("string"==typeof t||!(t.type in o)||!Array.isArray(t.content))continue;const e=t.type;let n=0;const i=()=>(n++,new pt.Token("prefix",o[e],e.replace(/^(\w+).*/,"$1"))),s=t.content.filter(t=>"string"==typeof t||"prefix"!==t.type),l=t.content.length-s.length,u=pt.tokenize(vt(s),r);u.unshift(i());const c=/\r\n|\n/g,g=t=>{const e=[];c.lastIndex=0;let r,o=0;for(;n<l&&(r=c.exec(t));){const n=r.index+r[0].length;e.push(t.slice(o,n)),o=n,e.push(i())}if(0!==e.length)return o<t.length&&e.push(t.slice(o)),e},a=t=>{for(let e=0;e<t.length&&n<l;e++){const n=t[e];if("string"==typeof n){const r=g(n);r&&(t.splice(e,1,...r),e+=r.length-1)}else if("string"==typeof n.content){const t=g(n.content);t&&(n.content=t)}else Array.isArray(n.content)?a(n.content):a([n.content])}};a(u),n<l&&u.push(i()),t.content=u}return i.tokens}(i,n[1])),bt(i)}function bt(t,e){const n=[];for(const r of t)if("string"==typeof r){const t=r.split(/(\n|\t)/),i=t.length;for(let r=0;r<i;r++){const i=t[r];"\n"===i||"\r\n"===i?n.push(g()):"\t"===i?n.push(c()):i.length>0&&n.push(it(i,e))}}else{const{content:t,alias:e}=r;"string"==typeof t?n.push(...bt([t],"prefix"===r.type&&"string"==typeof e?e:r.type)):Array.isArray(t)&&n.push(...bt(t,"unchanged"===r.type?void 0:r.type))}return n}const Ct={$tokenize(t,e){return Tt(t,e||this.defaultLanguage)},defaultLanguage:M,tokenize(t,e){return pt.tokenize(t,pt.languages[e||""]||pt.languages[this.defaultLanguage])}};function Nt(t,e,n){const r=t.getParent();Q(r)?kt(r,e,n):ot(t)&&t.replace(_(t.__text))}function jt(t,e){const n=e.getElementByKey(t.getKey());if(null===n)return;const r=t.getChildren(),i=r.length;if(i===n.__cachedChildrenLength)return;n.__cachedChildrenLength=i;let o="1",s=1;for(let t=0;t<i;t++)y(r[t])&&(o+="\n"+ ++s);n.setAttribute("data-gutter",o)}const wt=new Set;function kt(t,e,n){const r=t.getKey(),i=e.getKey()+"/"+r;void 0===t.getLanguage()&&t.setLanguage(n.defaultLanguage);const o=t.getLanguage()||n.defaultLanguage;if(!function(t){const e=function(t){const e=/^diff-([\w-]+)/i.exec(t);return e?e[1]:null}(t),n=e||t;try{return!!n&&pt.languages.hasOwnProperty(n)}catch(t){return!1}}(o))return t.getIsSyntaxHighlightSupported()&&t.setIsSyntaxHighlightSupported(!1),void async function(){}();t.getIsSyntaxHighlightSupported()||t.setIsSyntaxHighlightSupported(!0),wt.has(i)||(wt.add(i),e.update(()=>{!function(t,e){const n=S(t);if(!Q(n)||!n.isAttached())return;const r=v();if(!T(r))return void e();const i=r.anchor,o=i.offset,s="element"===i.type&&y(n.getChildAtIndex(i.offset-1));let u=0;if(!s){const t=i.getNode();u=o+t.getPreviousSiblings().reduce((t,e)=>t+e.getTextContentSize(),0)}if(!e())return;if(s)return void i.getNode().select(o,o);n.getChildren().some(t=>{const e=l(t);if(e||y(t)){const n=t.getTextContentSize();if(e&&n>=u)return t.select(u,u),!0;u-=n}return!1})}(r,()=>{const e=S(r);if(!Q(e)||!e.isAttached())return!1;const i=e.getLanguage()||n.defaultLanguage,o=n.$tokenize(e,i),s=function(t,e){let n=0;for(;n<t.length&&At(t[n],e[n]);)n++;const r=t.length,i=e.length,o=Math.min(r,i)-n;let s=0;for(;s<o;)if(s++,!At(t[r-s],e[i-s])){s--;break}const l=n,u=r-s,c=e.slice(n,i-s);return{from:l,nodesForReplacement:c,to:u}}(e.getChildren(),o),{from:l,to:u,nodesForReplacement:c}=s;return!(l===u&&!c.length)&&(t.splice(l,u-l,c),!0)})},{onUpdate:()=>{wt.delete(i)},skipTransforms:!0}))}function At(t,e){return ot(t)&&ot(e)&&t.__text===e.__text&&t.__highlightType===e.__highlightType||u(t)&&u(e)||y(t)&&y(e)}function Lt(t){if(!T(t))return!1;const e=t.anchor.getNode(),n=Q(e)?e:e.getParent(),r=t.focus.getNode(),i=Q(r)?r:r.getParent();return Q(n)&&n.is(i)}function Pt(t){const e=t.getNodes(),n=[];if(1===e.length&&Q(e[0]))return n;let r=[];for(let t=0;t<e.length;t++){const i=e[t];ot(i)||u(i)||y(i)||K(169),y(i)?r.length>0&&(n.push(r),r=[]):r.push(i)}if(r.length>0){const e=t.isBackward()?t.anchor:t.focus,i=b(r[0].getKey(),0,"text");e.is(i)||n.push(r)}return n}function Ot(t){const e=v();if(!T(e)||!Lt(e))return!1;const n=Pt(e),r=n.length;if(0===r&&e.isCollapsed())return t===C&&e.insertNodes([c()]),!0;if(0===r&&t===C&&"\n"===e.getTextContent()){const t=c(),n=g(),r=e.isBackward()?"previous":"next";return e.insertNodes([t,n]),w(k(A(L(t,"next",0),P(h(n,"next"))),r)),!0}for(let i=0;i<r;i++){const r=n[i];if(r.length>0){let n=r[0];if(0===i&&(n=lt(n)),t===C){const t=c();if(n.insertBefore(t),0===i){const r=e.isBackward()?"focus":"anchor",i=b(n.getKey(),0,"text");e[r].is(i)&&e[r].set(t.getKey(),0,"text")}}else u(n)&&n.remove()}}return!0}function Ht(t,e){const n=v();if(!T(n))return!1;const{anchor:r,focus:i}=n,o=r.offset,s=i.offset,l=r.getNode(),c=i.getNode(),g=t===O;if(!Lt(n)||!ot(l)&&!u(l)||!ot(c)&&!u(c))return!1;if(!e.altKey){if(n.isCollapsed()){const t=l.getParentOrThrow();if(g&&0===o&&null===l.getPreviousSibling()){if(null===t.getPreviousSibling())return t.selectPrevious(),e.preventDefault(),!0}else if(!g&&o===l.getTextContentSize()&&null===l.getNextSibling()){if(null===t.getNextSibling())return t.selectNext(),e.preventDefault(),!0}}return!1}let a,f;if(l.isBefore(c)?(a=lt(l),f=ut(c)):(a=lt(c),f=ut(l)),null==a||null==f)return!1;const p=a.getNodesBetween(f);for(let t=0;t<p.length;t++){const e=p[t];if(!ot(e)&&!u(e)&&!y(e))return!1}e.preventDefault(),e.stopPropagation();const h=g?a.getPreviousSibling():f.getNextSibling();if(!y(h))return!0;const d=g?h.getPreviousSibling():h.getNextSibling();if(null==d)return!0;const m=ot(d)||u(d)||y(d)?g?lt(d):ut(d):null;let x=null!=m?m:d;return h.remove(),p.forEach(t=>t.remove()),t===O?(p.forEach(t=>x.insertBefore(t)),x.insertBefore(h)):(x.insertAfter(h),x=h,p.forEach(t=>{x.insertAfter(t),x=t})),n.setTextNodeRange(l,o,c,s),!0}function Et(t,e){const n=v();if(!T(n))return!1;const{anchor:r,focus:i}=n,o=r.getNode(),s=i.getNode(),l=t===H;if(!Lt(n)||!ot(o)&&!u(o)||!ot(s)&&!u(s))return!1;const c=s;if("rtl"===ct(c)?!l:l){const t=gt(c,i.offset);if(null!==t){const{node:e,offset:r}=t;y(e)?e.selectNext(0,0):n.setTextNodeRange(e,r,e,r)}else c.getParentOrThrow().selectStart()}else{at(c).select()}return e.preventDefault(),e.stopPropagation(),!0}function zt(t,e){if(!t.hasNodes([U,nt]))throw new Error("CodeHighlightPlugin: CodeNode or CodeHighlightNode not registered on editor");null==e&&(e=Ct);const n=[];return!0!==t._headless&&n.push(t.registerMutationListener(U,e=>{t.getEditorState().read(()=>{for(const[n,r]of e)if("destroyed"!==r){const e=S(n);null!==e&&jt(e,t)}})},{skipInitialization:!1})),n.push(t.registerNodeTransform(U,n=>kt(n,t,e)),t.registerNodeTransform(f,n=>Nt(n,t,e)),t.registerNodeTransform(nt,n=>Nt(n,t,e)),t.registerCommand(E,e=>{const n=function(t){const e=v();if(!T(e)||!Lt(e))return null;const n=t?N:C,r=t?N:j,i=e.anchor,o=e.focus;if(i.is(o))return r;const s=Pt(e);if(1!==s.length)return n;const l=s[0];let u,c;0===l.length&&K(285),e.isBackward()?(u=o,c=i):(u=i,c=o);const g=lt(l[0]),a=ut(l[0]),f=b(g.getKey(),0,"text"),p=b(a.getKey(),a.getTextContentSize(),"text");return u.isBefore(f)||p.isBefore(c)?n:f.isBefore(u)||c.isBefore(p)?r:n}(e.shiftKey);return null!==n&&(e.preventDefault(),t.dispatchCommand(n,void 0),!0)},z),t.registerCommand(j,()=>!!Lt(v())&&(B([c()]),!0),z),t.registerCommand(C,t=>Ot(C),z),t.registerCommand(N,t=>Ot(N),z),t.registerCommand(O,t=>{const e=v();if(!T(e)||!Lt(e))return!1;const n=D().getFirstDescendant(),{anchor:r}=e,i=r.getNode();return(!n||!i||n.getKey()!==i.getKey())&&Ht(O,t)},z),t.registerCommand(F,t=>{const e=v();if(!T(e)||!Lt(e))return!1;const n=D().getLastDescendant(),{anchor:r}=e,i=r.getNode();return(!n||!i||n.getKey()!==i.getKey())&&Ht(F,t)},z),t.registerCommand(H,t=>Et(H,t),z),t.registerCommand(I,t=>Et(I,t),z)),i(...n)}const Bt=lt,Dt=ut,Ft=at,It=gt;export{it as $createCodeHighlightNode,X as $createCodeNode,ct as $getCodeLineDirection,at as $getEndOfCodeInLine,lt as $getFirstCodeNodeOfLine,ut as $getLastCodeNodeOfLine,gt as $getStartOfCodeInLine,ot as $isCodeHighlightNode,Q as $isCodeNode,ht as CODE_LANGUAGE_FRIENDLY_NAME_MAP,dt as CODE_LANGUAGE_MAP,ft as CodeExtension,nt as CodeHighlightNode,U as CodeNode,M as DEFAULT_CODE_LANGUAGE,Ct as PrismTokenizer,_t as getCodeLanguageOptions,xt as getCodeLanguages,St as getCodeThemeOptions,J as getDefaultCodeLanguage,Ft as getEndOfCodeInLine,Bt as getFirstCodeNodeOfLine,yt as getLanguageFriendlyName,Dt as getLastCodeNodeOfLine,It as getStartOfCodeInLine,mt as normalizeCodeLang,mt as normalizeCodeLanguage,zt as registerCodeHighlighting};
