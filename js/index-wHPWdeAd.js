import{c as S,ar as _,d as p,h as Z,O as G,i as t,H as tt,a0 as $,bs as j,bt as et,aS as at,bu as it,Y as w,aa as nt,p as T,bv as z,aB as P,bw as V,bq as lt,j as u,B,bx as C,by as F,ay as st,bz as ut,r as h,az as W,aA as f,bA as U,bB as rt,K as R,bC as E,M as q,bD as N,a as g,bE as ot,bF as I,u as ct,bG as dt,b7 as yt,N as v,bH as pt,bI as K,q as mt,ap as H,b0 as vt,bJ as ht,av as gt,bK as kt,aw as _t}from"./index-R5yA_R4y.js";import{u as J}from"./use-table-DuVhx9hR.js";import{G as b}from"./globe-5W0qxraY.js";import{U as ft}from"./user-Bz6t8xb5.js";import{C as Bt}from"./calendar-ojjBrQp-.js";import{C as bt}from"./crown-C0mE1irq.js";import{i as O}from"./isEmpty-Cm98nGBp.js";import"./index-BRZNlIue.js";import"./___vite-browser-external_commonjs-proxy-1MIX2PTu.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=S("chromium",[["path",{d:"M10.88 21.94 15.46 14",key:"xkve6t"}],["path",{d:"M21.17 8H12",key:"19dcdn"}],["path",{d:"M3.95 6.06 8.54 14",key:"g8jz9m"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=S("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=S("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),X={getList:e=>_.get("/activity",{params:e}),getReadingRank:e=>_.get("/activity/reading/rank",{params:e}),getRecentlyList:e=>_.get("/recently/all",{params:e}),deleteRecently:e=>_.delete(`/recently/${e}`)},L={getList:e=>_.get("/analyze",{params:e}),getAggregate:()=>_.get("/analyze/aggregate"),deleteAll:()=>_.delete("/analyze")},Ct=p({setup(){const e=$(),{setActions:l}=Z();G(()=>{l(t(w,null,[t(tt,{icon:t(et,null,null),variant:"success",name:"刷新数据",onClick:()=>{+e.query.page==1?c():j.replace({path:e.path,query:{...e.query,page:1}})}},null),t(at,{onDelete:async()=>{await L.deleteAll(),Number.parseInt(e.query.page)===1?c():j.replace({path:e.path,query:{page:1}})},customSuccessMessage:"已清空",message:"你确定要清空数据表？",customButtonTip:"清空表",customIcon:t(it,null,null)},null)])),nt(()=>{l(null)})}),T(()=>e.query.page,async i=>{await c(i?+i:1)});const{data:n,pager:s,fetchDataFn:c}=J((i,r)=>async(m=e.query.page||1,d=30)=>{const k=await L.getList({page:+m,size:d});i.value=k.data,r.value=k.pagination});z(()=>{c()});const o=[{title:"时间",key:"timestamp",minWidth:100,maxWidth:300,resizable:!0,render({timestamp:i}){return t("div",{class:"flex items-center gap-2 text-neutral-600 dark:text-neutral-300"},[t(V,{class:"size-4 shrink-0 text-neutral-400"},null),t("span",{class:"tabular-nums"},[lt(new Date(i),"MM-dd HH:mm:ss")])])}},{title:"IP 地址",key:"ip",minWidth:100,maxWidth:250,resizable:!0,render({ip:i}){return i?t(C,{ip:i,triggerEl:t(B,{quaternary:!0,size:"tiny",type:"primary"},{default:()=>[t("div",{class:"flex items-center gap-1.5"},[t(b,{class:"size-3.5"},null),t("span",{class:"font-mono"},[i])])]})},null):t("span",{class:"text-neutral-400"},[u("未知")])}},{title:"请求路径",key:"path",minWidth:150,maxWidth:600,resizable:!0,render({path:i}){return t(st,{trigger:"hover",placement:"top"},{trigger:()=>t("div",{class:"flex items-center gap-2"},[t(Q,{class:"size-4 shrink-0 text-neutral-400"},null),t(F,{class:"max-w-[200px]"},{default:()=>[t("span",{class:"font-mono text-neutral-700 dark:text-neutral-200"},[i??""])]})]),default:()=>t("div",{class:"max-w-[400px] break-all font-mono text-xs"},[i??""])})}},{key:"ua",title:"浏览器",minWidth:120,maxWidth:300,resizable:!0,render({ua:i}){const r=i.browser?Object.values(i.browser).filter(Boolean).join(" "):null;return t("div",{class:"flex items-center gap-2"},[t(xt,{class:"size-4 shrink-0 text-neutral-400"},null),t(F,{class:"max-w-[140px]"},{default:()=>[t("span",{class:"text-neutral-700 dark:text-neutral-200"},[r||"N/A"])]})])}},{key:"ua",title:"操作系统",minWidth:100,maxWidth:250,resizable:!0,render({ua:i}){const r=i.os?Object.values(i.os).filter(Boolean).join(" "):null;return t("div",{class:"flex items-center gap-2"},[t(ut,{class:"size-4 shrink-0 text-neutral-400"},null),t(F,{class:"max-w-[110px]"},{default:()=>[t("span",{class:"text-neutral-700 dark:text-neutral-200"},[r||"N/A"])]})])}},{key:"ua",title:"User Agent",minWidth:200,maxWidth:800,resizable:!0,render({ua:i}){return t(F,{lineClamp:2},{default(){return t("span",{class:"text-xs text-neutral-500 dark:text-neutral-400"},[i.ua??""])},tooltip(){return t("div",{class:"max-w-[500px] break-all text-xs"},[i.ua??""])}})}}];return()=>t(P,{data:n,onFetchData:c,pager:s,columns:o},null)}}),Ft="_container_1k9ro_2",It="_statsGrid_1k9ro_7",Dt="_statCard_1k9ro_11",Et="_statLabel_1k9ro_23",wt="_statValue_1k9ro_31",Tt="_statIcon_1k9ro_39",At="_chartsGrid_1k9ro_48",Rt="_chartCard_1k9ro_52",Lt="_chartHeader_1k9ro_64",Mt="_chartTitle_1k9ro_68",St="_chartSubtitle_1k9ro_76",zt="_chartContainer_1k9ro_84",Pt="_tabsContainer_1k9ro_89",qt="_ipSection_1k9ro_94",Nt="_ipSectionHeader_1k9ro_98",jt="_ipSectionTitle_1k9ro_102",Ht="_ipCount_1k9ro_110",Ot="_ipGrid_1k9ro_118",Gt="_ipCard_1k9ro_122",$t="_ipIcon_1k9ro_138",Vt="_ipAddress_1k9ro_146",Wt="_viewMoreButton_1k9ro_154",Ut="_activityList_1k9ro_180",Kt="_activityItem_1k9ro_184",Jt="_activityHeader_1k9ro_196",Qt="_activityType_1k9ro_200",Yt="_activityBadge_1k9ro_204",Xt="_activityBadgeLike_1k9ro_208",Zt="_activityBadgeRead_1k9ro_216",te="_activityTime_1k9ro_224",ee="_activityContent_1k9ro_232",ae="_activityRef_1k9ro_236",ie="_activityRefIcon_1k9ro_252",ne="_activityRefTitle_1k9ro_256",le="_activityMeta_1k9ro_264",se="_activityMetaItem_1k9ro_272",ue="_activityMetaIcon_1k9ro_276",re="_durationBar_1k9ro_281",oe="_durationBarFill_1k9ro_289",ce="_rankingList_1k9ro_295",de="_rankingItem_1k9ro_299",ye="_rankingPosition_1k9ro_311",pe="_rankingPositionTop_1k9ro_315",me="_rankingPositionNormal_1k9ro_323",ve="_rankingContent_1k9ro_331",he="_rankingTitle_1k9ro_335",ge="_rankingBar_1k9ro_343",ke="_rankingBarFill_1k9ro_351",_e="_rankingCount_1k9ro_356",fe="_pathList_1k9ro_365",Be="_pathItem_1k9ro_369",be="_pathRank_1k9ro_381",xe="_pathName_1k9ro_389",Ce="_pathCount_1k9ro_397",Fe="_pathBar_1k9ro_405",Ie="_pathBarFill_1k9ro_413",De="_empty_1k9ro_418",Ee="_emptyIcon_1k9ro_422",we="_emptyTitle_1k9ro_434",Te="_emptyDescription_1k9ro_442",Ae="_skeleton_1k9ro_451",Re="_filterSection_1k9ro_468",Le="_filterLabel_1k9ro_472",a={container:Ft,statsGrid:It,statCard:Dt,statLabel:Et,statValue:wt,statIcon:Tt,chartsGrid:At,chartCard:Rt,chartHeader:Lt,chartTitle:Mt,chartSubtitle:St,chartContainer:zt,tabsContainer:Pt,ipSection:qt,ipSectionHeader:Nt,ipSectionTitle:jt,ipCount:Ht,ipGrid:Ot,ipCard:Gt,ipIcon:$t,ipAddress:Vt,viewMoreButton:Wt,activityList:Ut,activityItem:Kt,activityHeader:Jt,activityType:Qt,activityBadge:Yt,activityBadgeLike:Xt,activityBadgeRead:Zt,activityTime:te,activityContent:ee,activityRef:ae,activityRefIcon:ie,activityRefTitle:ne,activityMeta:le,activityMetaItem:se,activityMetaIcon:ue,durationBar:re,durationBarFill:oe,rankingList:ce,rankingItem:de,rankingPosition:ye,rankingPositionTop:pe,rankingPositionNormal:me,rankingContent:ve,rankingTitle:he,rankingBar:ge,rankingBarFill:ke,rankingCount:_e,pathList:fe,pathItem:Be,pathRank:be,pathName:xe,pathCount:Ce,pathBar:Fe,pathBarFill:Ie,empty:De,emptyIcon:Ee,emptyTitle:we,emptyDescription:Te,skeleton:Ae,filterSection:Re,filterLabel:Le};var x=(function(e){return e[e.Like=0]="Like",e[e.ReadDuration=1]="ReadDuration",e})(x||{});const M=rt({posts:{},notes:{},pages:{},recentlies:{},all:{}}),D=(e,l)=>{if(!l)return;const n=M.value[e];for(const s of l)n[s.id]=s,M.value.all[s.id]=s},Me=p({setup(){const e=h(x.Like),{data:l,pager:n,fetchDataFn:s}=J((o,i)=>async(r,m)=>{const d=await X.getList({page:typeof r=="number"?r:void 0,size:m});o.value=d.data,i.value=d.pagination,d.objects&&(D("posts",d.objects.posts),D("notes",d.objects.notes),D("pages",d.objects.pages),D("recentlies",d.objects.recentlies))});z(()=>{s()});const c=$();return T(()=>c.query.page,async o=>{await s(o?+o:1)}),()=>t(w,null,[t(W,{onUpdateValue:o=>{e.value=o,s()},value:e.value,type:"line"},{default:()=>[t(f,{tab:"点赞记录",name:x.Like},{default:()=>[t("div",null,null)]}),t(f,{tab:"阅读记录",name:x.ReadDuration},{default:()=>[t("div",null,null)]})]}),e.value===x.Like?t(Se,{data:l,pager:n,onFetch:s},null):t(Pe,{data:l,pager:n,onFetch:s},null)])}}),Se=p({props:{data:{type:Object,required:!0},pager:{type:Object,required:!0},onFetch:{type:Function,required:!0}},setup(e){return()=>e.data.value?.length?t("div",{class:a.activityList},[e.data.value.map(l=>t(ze,{key:l.id,item:l},null)),e.pager.value&&t(P,{data:e.data,pager:e.pager,onFetchData:e.onFetch,columns:[],noPagination:!1},null)]):t("div",{class:a.empty},[t("div",{class:a.emptyIcon},[t(U,null,null)]),t("h3",{class:a.emptyTitle},[u("暂无点赞记录")]),t("p",{class:a.emptyDescription},[u("访客的点赞活动将显示在这里")])])}}),ze=p({props:{item:{type:Object,required:!0}},setup(e){const l=()=>{e.item.payload?.id&&N.get(`/helper/url-builder/${e.item.payload.id}`).then(({data:n})=>{window.open(n)})};return()=>t("article",{class:a.activityItem,"aria-label":"点赞活动"},[t("div",{class:a.activityHeader},[t("div",{class:a.activityType},[t("span",{class:[a.activityBadge,a.activityBadgeLike]},[t(U,{class:"size-3"},null),t("span",null,[u("点赞")])])]),t("time",{class:a.activityTime,datetime:e.item.created},[t(R,{time:e.item.created},null)])]),t("div",{class:a.activityContent},[e.item.ref?t("button",{type:"button",class:a.activityRef,onClick:l,"aria-label":`查看文章: ${e.item.ref.title}`},[t(E,{class:a.activityRefIcon},null),t("span",{class:a.activityRefTitle},[e.item.ref.title]),t(q,{class:"size-3.5 text-neutral-400"},null)]):t("span",{class:"text-sm text-neutral-400"},[u("已删除的内容")])]),t("div",{class:a.activityMeta},[t(C,{ip:e.item.payload.ip,trigger:"hover",triggerEl:t("div",{class:a.activityMetaItem},[t(b,{class:a.activityMetaIcon},null),t("span",{class:"font-mono"},[e.item.payload.ip])])},null)])])}}),Pe=p({props:{data:{type:Object,required:!0},pager:{type:Object,required:!0},onFetch:{type:Function,required:!0}},setup(e){return()=>e.data.value?.length?t("div",{class:a.activityList},[e.data.value.map(l=>t(qe,{key:l.id,item:l},null)),e.pager.value&&t(P,{data:e.data,pager:e.pager,onFetchData:e.onFetch,columns:[],noPagination:!1},null)]):t("div",{class:a.empty},[t("div",{class:a.emptyIcon},[t(Y,null,null)]),t("h3",{class:a.emptyTitle},[u("暂无阅读记录")]),t("p",{class:a.emptyDescription},[u("访客的阅读时长将显示在这里")])])}}),qe=p({props:{item:{type:Object,required:!0}},setup(e){const l=g(()=>M.value.all[e.item.refId]),n=g(()=>{const r=(e.item.payload.operationTime-e.item.payload.connectedAt)/1e3,m=Math.floor(r/3600),d=Math.floor(r%3600/60),k=Math.floor(r%60);let y="";return m>0&&(y+=`${m}小时 `),(m>0||d>0)&&(y+=`${d}分钟 `),y+=`${k}秒`,y}),s=36e5,c=g(()=>{const r=e.item.payload.operationTime-e.item.payload.connectedAt;return Math.min(r/s*100,100)}),o=()=>{l.value?.id&&N.get(`/helper/url-builder/${l.value.id}`).then(({data:r})=>{window.open(r)})},i=g(()=>{const r=l.value;return r&&"title"in r?r.title:""});return()=>t("article",{class:a.activityItem,"aria-label":"阅读活动"},[t("div",{class:a.activityHeader},[t("div",{class:a.activityType},[t("span",{class:[a.activityBadge,a.activityBadgeRead]},[t(E,{class:"size-3"},null),t("span",null,[u("阅读")])]),(e.item.payload.displayName||e.item.payload.identity)&&t("span",{class:"ml-2 flex items-center gap-1 text-sm text-neutral-500"},[t(ft,{class:"size-3.5"},null),e.item.payload.displayName||e.item.payload.identity])]),t("time",{class:a.activityTime,datetime:e.item.created},[t(R,{time:e.item.created},null)])]),t("div",{class:a.activityContent},[l.value?t("button",{type:"button",class:a.activityRef,onClick:o,"aria-label":`查看文章: ${i.value}`},[t(E,{class:a.activityRefIcon},null),t("span",{class:a.activityRefTitle},[i.value]),t(q,{class:"size-3.5 text-neutral-400"},null)]):t("span",{class:"text-sm text-neutral-400"},[u("未知内容")])]),t("div",{class:"mb-3"},[t("div",{class:"mb-1 flex items-center justify-between text-sm"},[t("span",{class:"flex items-center gap-1.5 text-neutral-500"},[t(Y,{class:"size-4"},null),u("阅读时长")]),t("span",{class:"font-medium text-neutral-700 dark:text-neutral-200"},[n.value])]),t("div",{class:a.durationBar},[t("div",{class:a.durationBarFill,style:{width:`${c.value}%`}},null)])]),t("div",{class:a.activityMeta},[t(C,{ip:e.item.payload.ip,trigger:"hover",triggerEl:t("div",{class:a.activityMetaItem},[t(b,{class:a.activityMetaIcon},null),t("span",{class:"font-mono"},[e.item.payload.ip])])},null),t("div",{class:a.activityMetaItem},[t(V,{class:a.activityMetaIcon},null),t("span",null,[u("连接于")," ",t(R,{time:new Date(e.item.payload.connectedAt)},null)])]),e.item.payload.position>0&&t("div",{class:a.activityMetaItem},[t(ot,{class:a.activityMetaIcon},null),t("span",null,[u("位置 "),e.item.payload.position,u("%")])])])])}}),Ne=p({setup(){const e=h([+I(new Date,{days:-7}),Date.now()]),{data:l,isPending:n,refetch:s}=ct({queryKey:mt.activity.readingRank(),queryFn:()=>X.getReadingRank()});T(e,()=>{s()});const c=g(()=>n.value),o=g(()=>Math.max(...l.value?.map(i=>i.count)||[1],1));return()=>t(w,null,[t("div",{class:a.filterSection},[t("span",{class:a.filterLabel},[t(Bt,{class:"mr-1.5 inline size-4"},null),u("时间范围")]),t(dt,{class:"w-[380px]",type:"datetimerange",clearable:!0,value:e.value,onUpdateValue:i=>{e.value=i}},{footer:()=>t(yt,{class:"py-2"},{default:()=>[t(B,{round:!0,type:"default",size:"small",onClick:()=>{const i=new Date;e.value=[+I(i,{days:-1}),+i]}},{default:()=>[u("最近 24 小时")]}),t(B,{round:!0,type:"default",size:"small",onClick:()=>{const i=new Date;e.value=[+I(i,{days:-7}),+i]}},{default:()=>[u("最近 7 天")]}),t(B,{round:!0,type:"default",size:"small",onClick:()=>{const i=new Date;e.value=[+I(i,{days:-30}),+i]}},{default:()=>[u("最近 30 天")]})]})})]),c.value?t("div",{class:a.rankingList},[Array.from({length:5}).map((i,r)=>t("div",{key:r,class:a.skeleton},[t("div",{class:"flex items-center gap-4"},[t(v,{circle:!0,style:{width:"32px",height:"32px"}},null),t("div",{class:"flex-1"},[t(v,{text:!0,style:{width:"200px",marginBottom:"8px"}},null),t(v,{text:!0,style:{width:"100%",height:"6px"}},null)]),t(v,{text:!0,style:{width:"40px"}},null)])]))]):l.value?.length?t("div",{class:a.rankingList,role:"list","aria-label":"阅读排名"},[l.value.map((i,r)=>{const m={ref:{id:i.id,title:i.title},refId:i.refId||i.id,count:i.count};return t(je,{key:i.refId||i.id,item:m,position:r+1,maxCount:o.value},null)})]):t("div",{class:a.empty},[t("div",{class:a.emptyIcon},[t(pt,null,null)]),t("h3",{class:a.emptyTitle},[u("暂无阅读数据")]),t("p",{class:a.emptyDescription},[u("选定时间范围内没有阅读记录")])])])}}),je=p({props:{item:{type:Object,required:!0},position:{type:Number,required:!0},maxCount:{type:Number,required:!0}},setup(e){const l=g(()=>e.position<=3),n=g(()=>e.item.count/e.maxCount*100),s=()=>{N.get(`/helper/url-builder/${e.item.ref.id}`).then(({data:c})=>{window.open(c)})};return()=>t("div",{class:a.rankingItem,role:"listitem"},[t("div",{class:[a.rankingPosition,l.value?a.rankingPositionTop:a.rankingPositionNormal]},[l.value&&e.position===1?t(bt,{class:"size-4"},null):e.position]),t("div",{class:a.rankingContent},[t("button",{type:"button",class:a.rankingTitle,onClick:s,"aria-label":`查看文章: ${e.item.ref.title}`},[t("span",{class:"mr-1.5 inline-flex items-center gap-1"},[t(E,{class:"size-3.5 text-neutral-400"},null)]),e.item.ref.title,t(q,{class:"ml-1 inline size-3 text-neutral-400 opacity-0 transition-opacity group-hover:opacity-100"},null)]),t("div",{class:a.rankingBar},[t("div",{class:a.rankingBarFill,style:{width:`${n.value}%`}},null)])]),t("div",{class:a.rankingCount},[t(K,{class:"mr-1 inline size-4 text-neutral-400"},null),e.item.count.toLocaleString()])])}});function He(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!_t(e)}const ea=p({setup(){const e=h({}),l=h(),n=h({}),s=h([]),c=h(!0);return z(async()=>{const o=await L.getAggregate();e.value=o.total,l.value=o.todayIps,n.value={day:o.today,week:o.weeks,month:o.months},s.value=[...o.paths],c.value=!1}),()=>t("div",{class:a.container},[t(Oe,{count:e.value,todayIpCount:l.value?.length||0,loading:c.value},null),t(Ge,{graphData:n.value,topPaths:s.value,loading:c.value},null),t("div",{class:a.tabsContainer},[t(W,{type:"line",animated:!0},{default:()=>[t(f,{name:"ip",tab:"IP 记录"},{default:()=>[t(Ve,{todayIp:l.value,loading:c.value},null)]}),t(f,{name:"path",tab:"访问路径"},{default:()=>[t(Ct,null,null)]}),t(f,{name:"activity",tab:"访客活动"},{default:()=>[t(Me,null,null)]}),t(f,{name:"rank",tab:"阅读排名"},{default:()=>[t(Ne,null,null)]})]})])])}}),Oe=p({props:{count:{type:Object,required:!0},todayIpCount:{type:Number,required:!0},loading:{type:Boolean,default:!1}},setup(e){const l=g(()=>[{label:"总访问量 (PV)",value:e.count.callTime||0,icon:K},{label:"独立访客 (UV)",value:e.count.uv||0,icon:gt},{label:"今日访问 IP",value:e.todayIpCount,icon:b},{label:"平均访问深度",value:e.count.uv?(e.count.callTime/e.count.uv).toFixed(1):"0",icon:Q}]);return()=>t("div",{class:a.statsGrid,role:"region","aria-label":"访问统计概览"},[e.loading?Array.from({length:4}).map((n,s)=>t("div",{key:s,class:a.statCard},[t(v,{text:!0,style:{width:"80px",marginBottom:"8px"}},null),t(v,{text:!0,style:{width:"60px",height:"28px"}},null)])):l.value.map(n=>t("div",{key:n.label,class:a.statCard},[t(n.icon,{class:a.statIcon,"aria-hidden":"true"},null),t("div",{class:a.statLabel},[n.label]),t("div",{class:a.statValue},[n.value.toLocaleString()])]))])}}),Ge=p({props:{graphData:{type:Object,required:!0},topPaths:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(e){const l=h(),n=h(),s=h(),c={day:null,week:null,month:null};function o(m,d,k,y){if(!m||!k?.length)return;c[d]&&c[d]?.destroy();const A=new kt({container:m,autoFit:!0,height:250,paddingTop:30,paddingRight:20,paddingBottom:50,paddingLeft:40});c[d]=A,A.options({type:"view",data:k,scale:{[y[0]]:{range:[0,1]},[y[2]]:{domainMin:0,nice:!0}},interaction:{tooltip:{crosshairs:!0,shared:!0}},children:[{type:"line",encode:{x:y[0],y:y[2],color:y[1]},style:{shape:"smooth"},labels:[{text:y[2]}]},{type:"point",encode:{x:y[0],y:y[2],color:y[1]},labels:[{text:y[2]}]}]}),A.render()}const i=()=>{o(l.value,"day",e.graphData.day,["hour","key","value"]),o(n.value,"week",e.graphData.week,["day","key","value"]),o(s.value,"month",e.graphData.month,["date","key","value"])};G(()=>{O(H(e.graphData))||i()});const r=T(()=>e.graphData,()=>{O(H(e.graphData))||(i(),r())},{deep:!0});return()=>t("div",{class:a.chartsGrid},[t("div",{class:a.chartCard},[t("div",{class:a.chartHeader},[t("h3",{class:a.chartTitle},[u("今日请求走势")]),t("span",{class:a.chartSubtitle},[u("按小时统计")])]),t("div",{class:a.chartContainer},[e.loading?t(v,{animated:!0,height:250},null):t("div",{ref:l},null)])]),t("div",{class:a.chartCard},[t("div",{class:a.chartHeader},[t("h3",{class:a.chartTitle},[u("本周请求走势")]),t("span",{class:a.chartSubtitle},[u("按天统计")])]),t("div",{class:a.chartContainer},[e.loading?t(v,{animated:!0,height:250},null):t("div",{ref:n},null)])]),t("div",{class:a.chartCard},[t("div",{class:a.chartHeader},[t("h3",{class:a.chartTitle},[u("本月请求走势")]),t("span",{class:a.chartSubtitle},[u("按日期统计")])]),t("div",{class:a.chartContainer},[e.loading?t(v,{animated:!0,height:250},null):t("div",{ref:s},null)])]),t("div",{class:a.chartCard},[t("div",{class:a.chartHeader},[t("h3",{class:a.chartTitle},[u("热门请求路径")]),t("span",{class:a.chartSubtitle},[u("最近 7 天 Top 10")])]),t("div",{class:a.chartContainer},[e.loading?t(v,{animated:!0,height:250},null):t($e,{paths:e.topPaths.slice(0,10)},null)])])])}}),$e=p({props:{paths:{type:Array,required:!0}},setup(e){const l=g(()=>Math.max(...e.paths.map(n=>n.count),1));return()=>t("div",{class:a.pathList,role:"list","aria-label":"热门路径列表"},[e.paths.map((n,s)=>t("div",{key:n.path,class:a.pathItem,role:"listitem"},[t("span",{class:a.pathRank},[s+1]),t("span",{class:a.pathName,title:decodeURI(n.path)},[decodeURI(n.path)]),t("span",{class:a.pathCount},[n.count.toLocaleString()]),t("div",{class:a.pathBar},[t("div",{class:a.pathBarFill,style:{width:`${n.count/l.value*100}%`}},null)])]))])}}),Ve=p({props:{todayIp:{type:Array},loading:{type:Boolean,default:!1}},setup(e){const l=vt();return()=>t("div",{class:a.ipSection},[e.loading?t("div",{class:a.ipGrid},[Array.from({length:10}).map((n,s)=>t(v,{key:s,text:!0,style:{height:"40px",borderRadius:"8px"}},null))]):e.todayIp?.length?t(w,null,[t("div",{class:a.ipSectionHeader},[t("h3",{class:a.ipSectionTitle},[u("今日访问 IP")]),t("span",{class:a.ipCount},[e.todayIp.length,u(" 个")])]),t("div",{class:a.ipGrid},[e.todayIp.slice(0,20).map(n=>t(C,{key:n,ip:n,triggerEl:t("button",{type:"button",class:a.ipCard,"aria-label":`查看 IP ${n} 的详情`},[t(b,{class:a.ipIcon},null),t("span",{class:a.ipAddress},[n])])},null))]),e.todayIp.length>20&&t("div",{class:a.viewMoreButton},[t(B,{round:!0,onClick:()=>{l.create({title:`今天所有请求的 IP (${e.todayIp?.length} 个)`,content:()=>t(ht,{virtualScroll:!0,maxHeight:400,data:e.todayIp?.map(n=>({ip:n})),columns:[{title:"IP 地址",key:"ip",render(n){const s=n.ip;return t(C,{ip:s,triggerEl:t(B,{size:"tiny",quaternary:!0,type:"primary"},He(s)?s:{default:()=>[s]})},null)}}]},null)})}},{default:()=>[u("查看全部 "),e.todayIp.length,u(" 个 IP")]})])]):t("div",{class:a.empty,role:"status"},[t("div",{class:a.emptyIcon},[t(b,null,null)]),t("h3",{class:a.emptyTitle},[u("暂无 IP 记录")]),t("p",{class:a.emptyDescription},[u("今天还没有访问记录")])])])}});export{ea as default};
