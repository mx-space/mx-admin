import{c as I,d as u,h as p,r as f,O as h,aI as _,aJ as k,i as e,P as y,H as T,aK as g,N as r,aL as B,j as l,B as E,a as v,a5 as D,M as C,K as x,aM as L,aN as N,ax as b,m as w,n as A,T as P}from"./index-DSr6uqVi.js";import{F as M}from"./file-text-34HaMuVI.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=I("thumbs-down",[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]]),q="_container_1befx_2",S="_list_1befx_7",R="_card_1befx_12",H="_actions_1befx_18",V="_content_1befx_29",O="_text_1befx_33",j="_reference_1befx_42",K="_referenceLink_1befx_46",J="_referenceIcon_1befx_62",U="_referenceType_1befx_66",Z="_referenceTitle_1befx_74",z="_externalIcon_1befx_82",G="_footer_1befx_87",Q="_meta_1befx_91",W="_timeInfo_1befx_100",X="_time_1befx_100",Y="_modified_1befx_108",ee="_votes_1befx_117",te="_voteItem_1befx_121",ne="_voteIcon_1befx_125",ae="_voteCount_1befx_129",oe="_voteDivider_1befx_133",le="_voteBar_1befx_141",se="_voteBarFill_1befx_149",ie="_comments_1befx_159",ce="_commentIcon_1befx_163",ue="_actionButton_1befx_173",re="_deleteButton_1befx_197",me="_empty_1befx_208",de="_emptyIcon_1befx_212",fe="_emptyTitle_1befx_224",_e="_emptyDescription_1befx_232",ve="_skeleton_1befx_241",xe="_skeletonFooter_1befx_249",t={container:q,list:S,card:R,actions:H,content:V,text:O,reference:j,referenceLink:K,referenceIcon:J,referenceType:U,referenceTitle:Z,externalIcon:z,footer:G,meta:Q,timeInfo:W,time:X,modified:Y,votes:ee,voteItem:te,voteIcon:ne,voteCount:ae,voteDivider:oe,voteBar:le,voteBarFill:se,comments:ie,commentIcon:ce,actionButton:ue,deleteButton:re,empty:me,emptyIcon:de,emptyTitle:fe,emptyDescription:_e,skeleton:ve,skeletonFooter:xe},be={Post:M,Note:B,Page:D},ye={Post:"文章",Note:"笔记",Page:"页面"},Be=u({props:{item:{type:Object,required:!0},onEdit:{type:Function,required:!0},onDelete:{type:Function,required:!0}},setup(n){const a=v(()=>n.item.up+n.item.down),s=v(()=>a.value>0?Math.round(n.item.up/a.value*100):50),i=n.item.refType?be[n.item.refType]:null,c=n.item.refType?ye[n.item.refType]:null;return()=>e("article",{class:t.card,"aria-label":"速记条目"},[e("div",{class:t.content},[e("p",{class:t.text},[n.item.content])]),n.item.ref&&n.item.refType&&e("div",{class:t.reference},[e("a",{href:n.item.ref.url,target:"_blank",rel:"noopener noreferrer",class:t.referenceLink,"aria-label":`查看关联${c}: ${n.item.ref.title}`},[i&&e(i,{class:t.referenceIcon},null),e("span",{class:t.referenceType},[c]),e("span",{class:t.referenceTitle},[n.item.ref.title]),e(C,{class:t.externalIcon},null)])]),e("footer",{class:t.footer},[e("div",{class:t.meta},[e("div",{class:t.timeInfo},[e("time",{datetime:n.item.created,class:t.time,"aria-label":"创建时间"},[e(x,{time:n.item.created},null)]),n.item.modified&&e("span",{class:t.modified,"aria-label":"修改时间"},[e("span",{"aria-hidden":"true"},[l("·")]),e("span",null,[l("编辑于")]),e(x,{time:n.item.modified},null)])]),e("div",{class:t.votes,"aria-label":`投票统计: ${n.item.up} 赞, ${n.item.down} 踩`},[e("div",{class:t.voteItem,"aria-hidden":"true"},[e(L,{class:t.voteIcon},null),e("span",{class:t.voteCount},[n.item.up])]),e("div",{class:t.voteDivider,"aria-hidden":"true"},null),e("div",{class:t.voteItem,"aria-hidden":"true"},[e($,{class:t.voteIcon},null),e("span",{class:t.voteCount},[n.item.down])]),a.value>0&&e("div",{class:t.voteBar,"aria-hidden":"true",title:`${s.value}% 好评率`},[e("div",{class:t.voteBarFill,style:{width:`${s.value}%`}},null)])]),n.item.commentsIndex!==void 0&&n.item.commentsIndex>0&&e("div",{class:t.comments,"aria-label":`${n.item.commentsIndex} 条评论`},[e(N,{class:t.commentIcon},null),e("span",null,[n.item.commentsIndex])])]),e("div",{class:t.actions,role:"group","aria-label":"操作"},[e(b,{trigger:"hover",placement:"top"},{trigger:()=>e("button",{type:"button",class:t.actionButton,onClick:n.onEdit,"aria-label":"编辑此条目"},[e(w,null,null)]),default:()=>"编辑"}),e(A,{placement:"left",positiveText:"取消",negativeText:"删除",onNegativeClick:n.onDelete},{trigger:()=>e(b,{trigger:"hover",placement:"top"},{trigger:()=>e("button",{type:"button",class:[t.actionButton,t.deleteButton],"aria-label":"删除此条目"},[e(P,null,null)]),default:()=>"删除"}),default:()=>e("span",{class:"max-w-48 break-all"},[l("确定要删除这条速记吗？")])})])])])}}),Fe=u({props:{onCreate:{type:Function,required:!0}},setup(n){return()=>e("div",{class:t.empty,role:"status","aria-label":"暂无内容"},[e("div",{class:t.emptyIcon,"aria-hidden":"true"},[e(B,null,null)]),e("h3",{class:t.emptyTitle},[l("还没有速记")]),e("p",{class:t.emptyDescription},[l("记录你的灵感、想法或日常碎片")]),e(E,{type:"primary",onClick:n.onCreate},{default:()=>[e(y,{class:"mr-1.5"},null),l("写一条速记")]})])}}),Ie=u({setup(){return()=>e("div",{class:t.list,"aria-busy":"true","aria-label":"加载中"},[[1,2,3].map(n=>e("div",{key:n,class:t.skeleton},[e(r,{text:!0,repeat:2},null),e("div",{class:t.skeletonFooter},[e(r,{text:!0,style:{width:"120px"}},null),e(r,{text:!0,style:{width:"80px"}},null)])]))])}}),ke=u({setup(){const{setActions:n}=p(),a=f([]),s=f(!0);h(async()=>{_.getAll().then(o=>{a.value=o.data,s.value=!1})});const{create:i,edit:c}=k(),m=()=>{i().then(o=>{o&&a.value.unshift(o)})};return n(e(T,{onClick:m,icon:e(y,null,null),"aria-label":"新建速记"},null)),()=>e("div",{class:t.container},[e(g,{name:"fade",mode:"out-in"},{default:()=>[s.value?e(Ie,{key:"loading"},null):a.value.length===0?e(Fe,{key:"empty",onCreate:m},null):e("div",{key:"list",class:t.list,role:"feed","aria-label":"速记列表"},[a.value.map((o,F)=>e(Be,{key:o.id,item:o,onEdit:()=>{c(o).then(d=>{d&&(a.value[F]=d)})},onDelete:async()=>{await _.delete(o.id),message.success("删除成功"),a.value.splice(a.value.indexOf(o),1)}},null))])]})])}});export{ke as default};
