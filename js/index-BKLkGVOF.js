const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index-DoEgFLcO.js","assets/index-Bb0KFhA8.css"])))=>i.map(i=>d[i]);
import{c as pe,ar as K,d as N,c8 as Dt,r as v,o as Y,h as n,c9 as ft,O as we,ca as dt,cb as Ue,cc as pt,aG as Iu,s as V,p as xe,v as Se,W as Ge,aF as Ru,w as Ft,b0 as ht,H as Re,x as tu,b2 as ve,z as W,cd as $u,B as U,Z as Ct,M as Mu,i as k,Y as fe,as as At,aw as Uu,aC as He,bX as cu,c7 as Et,P as ru,a as z,ce as mt,a7 as yt,m as Du,T as fu,K as vt,S as Bt,cf as gt,bp as Lu,aP as bt,cg as wt,V as Ke,ay as xt,bS as St,aa as kt,bJ as Ot,ch as _t,n as Tt,ci as du,cj as Pt,g as qt,aR as jt,a0 as Nt,aU as It,aV as pu,G as Rt}from"./index-DoEgFLcO.js";import{F as $t,S as B,d as Fu,a as hu,b as Cu}from"./index-CcntOMEy.js";import{X as Mt}from"./index-CBQq4nR6.js";import{D as Vu}from"./download-o-2ttAD6.js";import{F as Au}from"./file-text-CxNLTwjh.js";import{L as Eu}from"./lock-CwJ8weeq.js";import{C as Ut}from"./chevron-right-CEOKKkLg.js";import{F as Lt}from"./folder-open-BeZU_q1c.js";import{i as Vt}from"./isEmpty-CDaUjk55.js";import{l as zu}from"./index-DccAlwPk.js";import{o as zt}from"./omit-DkrjnpVZ.js";import{C as mu}from"./circle-check-BvAy2Nj0.js";import{A as Jt}from"./arrow-left-CH7IVZ35.js";import"./___vite-browser-external_commonjs-proxy-BydVfZl6.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=pe("circle-arrow-up",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=pe("code-xml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=pe("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=pe("file-code",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=pe("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=pe("mouse-pointer-click",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]),Yt={getGraph:()=>K.get("/dependencies/graph")},ne={getList:e=>K.get("/snippets",{params:e}),getById:e=>K.get(`/snippets/${e}`),create:e=>K.post("/snippets",{data:e}),update:(e,u)=>K.put(`/snippets/${e}`,{data:u}),delete:e=>K.delete(`/snippets/${e}`),getGroups:e=>K.get("/snippets/group",{params:e}),getGroupSnippets:e=>K.get(`/snippets/group/${e}`),resetFunction:e=>K.delete(`/fn/reset/${e}`),import:e=>K.post("/snippets/import",{data:e})},yu=N({props:{onSave:{type:Function},value:{type:String,required:!0},onChange:{type:Function,required:!0},language:{type:String,required:!0}},setup(e){const u=Dt(e),t=v();return Y(()=>u.value,()=>{t.value&&t.value.loaded&&e.onChange?.(u.value)}),()=>n("div",{class:"relative h-full w-full"},[n($t,{ref:t,value:u,onSave:e.onSave,language:e.language},null)])}});var vu=ft();const Zt=N({props:{language:{type:String,required:!0},code:{type:String,required:!0}},setup(e){const u=v();return we(()=>{dt(()=>import("./index-DoEgFLcO.js").then(t=>t.dU),__vite__mapDeps([0,1])).then(t=>{t.editor.colorize(e.code,e.language,{tabSize:2}).then(r=>{u.value.innerHTML=r})})}),()=>n("pre",{ref:u},[e.code])}});var Be;(e=>{async function u(){return(await Ue.rest.repos.get({owner:"mx-space",repo:"snippets"})).data}e.fetchRepo=u;async function t(a=""){return(await Ue.rest.repos.getContent({owner:"mx-space",repo:"snippets",path:a})).data}e.fetchFileTree=t;async function r(a=""){return(await Ue.rest.search.code({q:`repo:mx-space/snippets in:path ${a}`,sort:"indexed",order:"desc"})).data}e.searchFile=r})(Be||(Be={}));const Qt=N({setup(e,{expose:u}){const t=v(!0),r=v(!1);Y(()=>r.value,()=>{r.value?t.value=!0:t.value=!1,setTimeout(()=>{t.value=!1},1e3)});const a=v([""]);u({run(i,o){r.value=!0;const D=new pt.EventSourcePolyfill(i,{headers:{Authorization:Iu()}});D.onmessage=c=>{if(!c){D.close(),o?.(),a.value.push("Done.");return}a.value.push(c.data)},D.onerror=c=>{D.close(),c?.data?V.error(c.data):console.error(c)}}});const s=v();return Y(()=>[a.value,s.value],([i,o])=>{o&&i.length>0&&(i.forEach(D=>o.write(D)),a.value.length=0)},{deep:!0}),()=>n(xe,{show:r.value,onUpdateShow:i=>{r.value=i},transformOrigin:"center"},{default:()=>[n(Se,{class:"modal-card md min-h-[100px]",title:"Output"},{default:()=>[n("div",{class:"h-full w-full"},[t.value?n("div",{class:"flex h-full w-full items-center justify-center"},[n(Ge,{show:!0,strokeWidth:14},null)]):n(Mt,{colorScheme:"auto",onReady:i=>{a.value.forEach(o=>{i.write(o)}),a.value.length=0,s.value=i}},null)])]})]})}}),nu=N({setup(e,{expose:u}){const t=v();return u({install(r,a){t.value.run(`${Ru}/dependencies/install_deps?packageNames=${Array.isArray(r)?r.join(","):r}`,a)}}),()=>n(Qt,{ref:t},null)}});function We(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Uu(e)}const er=()=>{const e=v([]),u=v(!0);return[e,async()=>{const r=await Be.fetchFileTree();Array.isArray(r)&&(e.value=r.filter(({type:a,name:s})=>a==="dir"&&!s.startsWith("test:")).map(({name:a,html_url:s})=>({name:a,url:s||""}))),u.value=!1},u]},ur=N({props:{onFinish:{type:Function,required:!0}},setup(e){const u=v(!1),t=c=>{c.stopPropagation(),c.preventDefault(),D()},[r,a,s]=er();Ft(()=>{u.value&&a()});const i=v(""),o=ht(),D=async()=>{const c=o.create({title:"获取和解析",content:()=>At(tr,{name:i.value,onFinish:()=>{c.destroy(),e.onFinish()},onRootFinish:()=>{e.onFinish()}}),closable:!0})};return()=>n(fe,null,[n(Re,{variant:"info",onClick:()=>{u.value=!0},icon:n(Vu,null,null),name:"下载扩展包"},null),n(xe,{show:u.value,onUpdateShow:c=>{u.value=c}},{default:()=>[n(Se,{class:"modal-card sm",title:"导入 Snippets"},{default:()=>[n(tu,{onSubmit:t},{default:()=>[n(ve,{label:"包名"},{default:()=>[n(W,{placeholder:"支持导入 GitHub repo:mx-space/snippets 下的集合包，示例输入: kami",value:i.value,onUpdateValue:c=>{i.value=c}},null)]}),n(ve,{label:"可获取的"},{default:()=>[s.value?n($u,null,null):n("div",{class:"flex flex-wrap space-x-2"},[r.value.map(({name:c,url:f})=>n("div",{class:"ml-4 flex items-center",key:"name"},[n(U,{quaternary:!0,onClick:()=>{i.value=c,Ct(()=>{D()})}},We(c)?c:{default:()=>[c]}),n("a",{href:f,target:"_blank",rel:"noopener noreferrer"},[n(Mu,{class:"ml-2 !h-4 !w-4"},null)])]))])]}),n("div",{class:"flex justify-end"},[n(U,{round:!0,type:"primary",onClick:D},{default:()=>[k("处理")]})])]})]})]})])}}),tr=N({props:{name:{type:String,required:!0},onFinish:{type:Function,required:!0},onRootFinish:{type:Function,required:!0}},setup(e){const u=v(!0),t=v([]),r=v([]);we(async()=>{const i=await Be.fetchFileTree(e.name);if(Array.isArray(i)){const o=i.map(async D=>{if(D.type==="dir")switch(D.name){case"functions":{const c=await Be.fetchFileTree(`${e.name}/functions`);Array.isArray(c)&&await Promise.all(c.map(async f=>{if(f.type==="file"&&/\.(js|ts)$/.test(f.name)){const y=f.download_url;if(!y){V.error(`获取下载地址失败，${f.name}`);return}const p=await fetch(y).then(A=>A.text());t.value.push({name:f.name,reference:e.name,raw:p,htmlUrl:f.html_url})}}));break}}else if(D.name==="package.json"){const c=D.download_url;if(!c){V.error("无法获取 package.json 文件的下载地址");return}const f=await fetch(c).then(p=>p.text()),y=JSON.parse(f);r.value=Object.entries(y.dependencies||{}).map(([p,A])=>`${p}@${A}`)}});await Promise.all(o),u.value=!1}});const a=async()=>{const i={snippets:t.value.map(D=>({name:vu.basename(D.name,vu.extname(D.name)),reference:D.reference,raw:D.raw,private:!1,type:B.Function})),packages:Et(r)},o=V.loading("正在导入...",{duration:1e6});await ne.import(i),V.dismiss(o),i.packages.length>0?s.value?.install(i.packages,()=>{e.onRootFinish()}):(V.success("导入成功"),e.onFinish())},s=v();return()=>{const{name:i}=e;return n("div",null,[n("p",null,[k("获取： "),i]),u.value?n("div",{class:"relative h-24"},[n($u,{description:"需要从 GitHub 获取，建议连接代理后操作。"},null)]):n(tu,null,{default:()=>[n(ve,{label:"将导入的函数："},{default:()=>[n("div",{class:"space-x-2"},[t.value.map(({name:o,reference:D,raw:c,htmlUrl:f},y)=>n(He,{key:`${D}/${o}`,trigger:"hover",placement:"right"},{trigger(){return n(U,{quaternary:!0,onClick:()=>{f&&window.open(f)},class:"cursor-pointer"},{default:()=>[n(cu,{closable:!0,onClose:p=>{p.stopPropagation(),t.value.splice(y,1)}},We(o)?o:{default:()=>[o]})]})},default(){return n(Se,{bordered:!1,title:o,class:"max-h-[50vh] max-w-[40vw] overflow-auto"},{default:()=>[n(Zt,{code:c,language:"typescript"},null)]})}}))])]}),n(ve,{label:"将安装的依赖："},{default:()=>[n("div",{class:"space-x-2"},[r.value.map((o,D)=>n(cu,{closable:!0,key:o,onClose:()=>{r.value.splice(D,1)}},We(o)?o:{default:()=>[o]}))])]}),n("div",{class:"flex justify-end"},[n(U,{round:!0,type:"primary",onClick:a},{default:()=>[k("导入")]})])]}),n(nu,{ref:s},null)])}}}),rr=N({setup(){const e=v(!1),u=v(),t=v(""),r=a=>{a?.preventDefault(),u.value?.install(t.value)};return()=>n(fe,null,[n(Re,{icon:n(Vu,null,null),name:"安装依赖",variant:"warning",onClick:()=>{e.value=!0}},null),n(xe,{show:e.value,onUpdateShow:a=>{e.value=a}},{default:()=>[n(Se,{class:"modal-card sm",title:"依赖更新"},{default:()=>[n(tu,{onSubmit:r},{default:()=>[n(ve,{label:"Package Name"},{default:()=>[n(W,{value:t.value,onUpdateValue:a=>{t.value=a},placeholder:"E.g. qs"},null)]}),n("div",{class:"text-right"},[n(U,{round:!0,type:"primary",onClick:r},{default:()=>[k("安装")]})])]})]})]}),n(nu,{ref:u},null)])}}),nr=N({name:"SnippetEmptyState",props:{hasSnippets:{type:Boolean,default:!1},onCreate:{type:Function}},setup(e){return()=>n("div",{class:"flex h-full flex-col items-center justify-center text-neutral-400"},[e.hasSnippets?n(fe,null,[n(Xt,{class:"mb-4 h-12 w-12 text-neutral-300"},null),n("p",{class:"mb-2 text-lg font-medium text-neutral-600 dark:text-neutral-300"},[k("选择一个片段")]),n("p",{class:"text-sm"},[k("从左侧列表选择一个片段进行编辑")])]):n(fe,null,[n(Ht,{class:"mb-4 h-12 w-12 text-neutral-300"},null),n("p",{class:"mb-2 text-lg font-medium text-neutral-600 dark:text-neutral-300"},[k("暂无配置片段")]),n("p",{class:"mb-4 text-sm"},[k("创建你的第一个配置片段")]),n(U,{type:"primary",onClick:e.onCreate,renderIcon:()=>n(ru,{class:"h-4 w-4"},null)},{default:()=>[k("新建片段")]})])])}}),ar=N({name:"SnippetCard",props:{snippet:{type:Object,required:!0},selected:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},onSelect:{type:Function},onDelete:{type:Function}},setup(e){const u=z(()=>e.snippet.type===B.Function),t=z(()=>u.value&&e.snippet.builtIn),r=z(()=>{switch(e.snippet.type){case B.JSON:return Kt;case B.JSON5:return yt;case B.Function:return mt;case B.Text:return Au;case B.YAML:return Wt;default:return Au}}),a=z(()=>{switch(e.snippet.type){case B.JSON:return"text-orange-500";case B.JSON5:return"text-purple-500";case B.Function:return"text-blue-500";case B.Text:return"text-neutral-500";case B.YAML:return"text-red-500";default:return"text-neutral-500"}}),s=z(()=>{const f=e.snippet,y=f.type===B.Function?`/serverless/${f.reference}/${f.name}`:`/${f.reference}/${f.name}`;return`${Ru}${y}${f.private?`?token=${Iu()}`:""}`}),i=()=>{e.onSelect?.(e.snippet)},o=f=>{f.target?.closest('button, a, input, textarea, [role="button"]')||window.open(s.value,"_blank")},D=f=>{f.stopPropagation(),window.open(s.value,"_blank")},c=()=>{e.onDelete?.(e.snippet)};return()=>{const{snippet:f,selected:y,compact:p}=e,A=t.value?"重置":"删除";return p?n("div",{class:["group relative flex cursor-pointer items-center gap-1.5 px-2 py-1.5 transition-colors","hover:bg-neutral-100 dark:hover:bg-neutral-800/50",y&&"bg-neutral-100 dark:bg-neutral-800"],onClick:i,onDblclick:o,title:"双击打开访问地址"},[(()=>{const x=r.value;return n(x,{class:`h-3 w-3 flex-shrink-0 ${a.value}`},null)})(),n("span",{class:["flex-1 truncate text-sm",f.enable===!1?"text-neutral-400 line-through dark:text-neutral-500":"text-neutral-700 dark:text-neutral-300",y&&"font-medium text-neutral-900 dark:text-white"]},[f.name]),f.private&&n(Eu,{class:"h-3 w-3 flex-shrink-0 text-neutral-400"},null),n(Du,{positiveText:"取消",negativeText:A,onNegativeClick:c},{trigger:()=>n("button",{class:"rounded p-0.5 text-red-500 opacity-0 transition-opacity hover:bg-red-100 group-hover:opacity-100 dark:hover:bg-red-900/50",onClick:x=>x.stopPropagation()},[n(fu,{class:"h-3 w-3"},null)]),default:()=>n("span",{class:"max-w-48"},[k("确定要"),A,k(" "),f.name,k("?")])})]):n("div",{class:["group relative cursor-pointer border-b border-neutral-200 px-3 py-2.5 transition-colors","hover:bg-neutral-50 dark:border-neutral-800 dark:hover:bg-neutral-900/50",y&&"bg-neutral-100 dark:bg-neutral-800/80"],onClick:i,onDblclick:o,title:"双击打开访问地址"},[n("div",{class:"flex items-center gap-1.5"},[(()=>{const x=r.value;return n(x,{class:`h-3.5 w-3.5 flex-shrink-0 ${a.value}`},null)})(),n("span",{class:["truncate text-sm font-medium",f.enable===!1?"text-neutral-400 line-through dark:text-neutral-500":"text-neutral-900 dark:text-neutral-100",y&&"text-neutral-900 dark:text-white"]},[f.name]),f.private&&n(Eu,{class:"h-3 w-3 flex-shrink-0 text-neutral-400"},null)]),n("div",{class:"mt-1 flex items-center gap-2 text-xs text-neutral-500 dark:text-neutral-400"},[n("span",{class:"rounded bg-neutral-100 px-1.5 py-0.5 dark:bg-neutral-700"},[f.type.toUpperCase()]),u.value&&f.method!=="GET"&&n("span",{class:"text-amber-600 dark:text-amber-400"},[f.method]),f.created&&n(vt,{time:f.created,class:"ml-auto flex-shrink-0"},null)]),f.comment&&n("div",{class:"mt-1 truncate text-xs text-neutral-400 dark:text-neutral-500"},[f.comment]),n("div",{class:["absolute right-2 top-1/2 flex -translate-y-1/2 gap-1 opacity-0 transition-opacity","group-hover:opacity-100"]},[n("button",{class:"rounded p-1 hover:bg-neutral-200 dark:hover:bg-neutral-700",onClick:D,title:"在新窗口打开"},[n(Mu,{class:"h-3.5 w-3.5 text-neutral-500"},null)]),n(Du,{positiveText:"取消",negativeText:A,onNegativeClick:c},{trigger:()=>n("button",{class:"rounded p-1 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/50",onClick:x=>x.stopPropagation(),title:A},[n(fu,{class:"h-3.5 w-3.5"},null)]),default:()=>n("span",{class:"max-w-48"},[k("确定要"),A,k(" "),f.name,k(" ?")])})])])}}});function sr(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Uu(e)}const Bu=N({name:"SnippetList",props:{groups:{type:Array,required:!0},selectedId:{type:String,default:null},loading:{type:Boolean,default:!1},onSelect:{type:Function},onDelete:{type:Function},onToggleGroup:{type:Function},onCreate:{type:Function}},setup(e){const u=v(""),t=z(()=>{if(!u.value.trim())return e.groups;const a=u.value.toLowerCase();return e.groups.map(s=>({...s,snippets:s.snippets.filter(i=>i.name.toLowerCase().includes(a)||i.comment?.toLowerCase().includes(a)),expanded:!0})).filter(s=>s.snippets.length>0||s.reference.toLowerCase().includes(a))}),r=a=>{u.value.trim()||e.onToggleGroup?.(a)};return()=>{let a;return n("div",{class:"flex h-full flex-col"},[n("div",{class:"flex flex-shrink-0 items-center gap-2 border-b border-neutral-200 p-2 dark:border-neutral-800"},[n(W,{value:u.value,"onUpdate:value":s=>u.value=s,placeholder:"搜索…",clearable:!0,size:"small",class:"flex-1"},{prefix:()=>n(Bt,{class:"h-3.5 w-3.5 text-neutral-400"},null)}),n("button",{class:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-md bg-neutral-900 text-white transition-colors hover:bg-neutral-700 dark:bg-white dark:text-neutral-900 dark:hover:bg-neutral-200",onClick:()=>e.onCreate?.(),title:"新建片段"},[n(ru,{class:"h-4 w-4"},null)])]),n("div",{class:"min-h-0 flex-1"},[e.loading?n("div",{class:"flex h-full items-center justify-center"},[n(Ge,{size:"small"},null)]):t.value.length===0?n("div",{class:"flex h-full items-center justify-center text-sm text-neutral-400"},[u.value?"没有匹配结果":"暂无分组"]):n(gt,{class:"h-full"},sr(a=t.value.map(s=>n("div",{key:s.reference},[n("div",{class:["flex cursor-pointer select-none items-center gap-1 px-2 py-1.5","text-sm text-neutral-600 dark:text-neutral-400","hover:bg-neutral-100 dark:hover:bg-neutral-800/50"],onClick:()=>r(s.reference)},[n("span",{class:"flex h-4 w-4 items-center justify-center"},[s.expanded?n(Lu,{class:"h-3.5 w-3.5"},null):n(Ut,{class:"h-3.5 w-3.5"},null)]),s.expanded?n(Lt,{class:"h-4 w-4 text-amber-500"},null):n(bt,{class:"h-4 w-4 text-amber-500"},null),n("span",{class:"flex-1 truncate font-medium"},[s.reference]),n("span",{class:"rounded bg-neutral-200 px-1.5 py-0.5 text-xs dark:bg-neutral-700"},[s.count])]),s.expanded&&n("div",{class:"pl-4"},[s.loading?n("div",{class:"flex items-center justify-center py-4"},[n(Ge,{size:"small"},null)]):s.snippets.length===0?n("div",{class:"py-2 pl-6 text-xs text-neutral-400"},[k("暂无片段")]):s.snippets.map(i=>n(ar,{key:i.id,snippet:i,selected:i.id===e.selectedId,onSelect:e.onSelect,onDelete:e.onDelete,compact:!0},null))])])))?a:{default:()=>[a]})])])}}}),ir=N({props:{value:{type:Object,required:!0},onChange:{type:Function,required:!0},options:{type:Array,required:!1},plainKeyInput:{type:Boolean,required:!1,default:!1}},setup(e){const u=v([]),t=v(new Set);return we(()=>{if(!Vt(e.value)){const r=Object.entries(e.value).map(([a,s])=>(t.value.add(a),{key:a,value:s.toString()}));u.value=r}}),Y(()=>u.value,r=>{const a=r.reduce((s,i)=>(i.key===""&&i.value===""||(s[i.key]=i.value.toString()),s),{});e.onChange(a)},{deep:!0}),Y(()=>u.value,r=>{t.value.clear(),r.forEach(a=>{t.value.add(a.key)})},{deep:!0}),()=>n(wt,{value:u.value,onUpdateValue:r=>{u.value=(()=>{const a=r.indexOf(null);return a!==-1&&r.splice(a,1,{key:"",value:""}),r})()}},{default(r){return n("div",{class:"flex w-full items-center"},[e.plainKeyInput?n(W,{class:"mr-4",placeholder:"请输入",value:r.value.key,onUpdateValue:a=>{r.value.key=a}},null):n(Ke,{class:"mr-4",filterable:!0,tag:!0,placeholder:"请选择",value:r.value.key,onUpdateValue:a=>{r.value.key=a},options:e.options?.map(a=>({...a,disabled:t.value.has(a.value)}))},null),n(W,{value:r.value.value.toString(),onUpdateValue:a=>{r.value.value=a}},null)])}})}}),or=N({props:{title:{type:String,required:!0},defaultOpen:{type:Boolean,default:!1}},setup(e,{slots:u}){const t=v(e.defaultOpen);return()=>n("div",{class:"rounded-md border border-neutral-200 dark:border-neutral-700"},[n("button",{type:"button",class:"flex w-full items-center justify-between px-3 py-2 text-left",onClick:()=>t.value=!t.value},[n("span",{class:"text-sm text-neutral-600 dark:text-neutral-400"},[e.title]),n(Lu,{class:["h-4 w-4 text-neutral-400 transition-transform",t.value&&"rotate-180"]},null)]),t.value&&n("div",{class:"border-t border-neutral-200 p-3 dark:border-neutral-700"},[u.default?.()])])}}),oe=N({props:{label:{type:String,required:!0},required:{type:Boolean,default:!1},tooltip:{type:String}},setup(e,{slots:u}){return()=>n("div",{class:"space-y-1.5"},[n("div",{class:"flex items-center gap-1"},[n("label",{class:"text-sm text-neutral-600 dark:text-neutral-400"},[e.label]),e.required&&n("span",{class:"text-xs text-red-500/80"},[k("*")]),e.tooltip&&n(xt,null,{trigger:()=>n(Ju,{class:"h-3 w-3 cursor-help text-neutral-400"},null),default:()=>e.tooltip})]),u.default?.()])}}),gu=N({props:{value:{type:Boolean,required:!0},label:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["update:value"],setup(e,{emit:u}){return()=>n("div",{class:["flex items-center justify-between",e.disabled&&"opacity-50"]},[n("span",{class:"text-sm text-neutral-600 dark:text-neutral-400"},[e.label]),n(St,{value:e.value,onUpdateValue:t=>u("update:value",t),disabled:e.disabled},null)])}}),bu=N({name:"SnippetMetaForm",props:{data:{type:Object,required:!0},isBuiltFunction:{type:Boolean,default:!1},isFunctionType:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1}},emits:["update:data"],setup(e,{emit:u}){const t=(s,i)=>{u("update:data",{...e.data,[s]:i})},r=z(()=>Object.entries(B).map(([s,i])=>({label:s,value:i}))),a=["GET","POST","PUT","DELETE","PATCH","ALL"].map(s=>({label:s,value:s}));return()=>n("div",{class:"space-y-4 p-1"},[e.isBuiltFunction&&n("div",{class:"flex items-start gap-2 rounded-md bg-amber-50 px-3 py-2 dark:bg-amber-950/50"},[n(Ju,{class:"mt-0.5 h-4 w-4 flex-shrink-0 text-amber-600 dark:text-amber-500"},null),n("span",{class:"text-xs text-amber-700 dark:text-amber-400"},[k("这是一个内置函数，无法修改元信息，但你可以自定义函数实现。")])]),n("div",{class:"grid grid-cols-2 gap-x-4 gap-y-4"},[n(oe,{label:"名称",required:!0},{default:()=>[n(W,{value:e.data.name,onUpdateValue:s=>t("name",s),disabled:e.isBuiltFunction,placeholder:"片段名称",size:"small"},null)]}),n(oe,{label:"引用",required:!0,tooltip:"用于分组和 API 调用"},{default:()=>[n(W,{value:e.data.reference,onUpdateValue:s=>t("reference",s),disabled:e.isBuiltFunction,placeholder:"分组标识",size:"small"},null)]}),n(oe,{label:"类型"},{default:()=>[n(Ke,{value:e.data.type,onUpdateValue:s=>t("type",s),options:r.value,disabled:e.isEditing&&e.isFunctionType,size:"small"},null)]}),e.isFunctionType?n(oe,{label:"方法"},{default:()=>[n(Ke,{value:e.data.method,onUpdateValue:s=>t("method",s),options:a,disabled:e.isBuiltFunction,size:"small"},null)]}):n(oe,{label:"元类型",tooltip:"可选的内容类型标识"},{default:()=>[n(W,{value:e.data.metatype,onUpdateValue:s=>t("metatype",s),placeholder:"可选",size:"small"},null)]})]),!e.isFunctionType&&n(oe,{label:"Schema",tooltip:"JSON Schema 验证地址"},{default:()=>[n(W,{value:e.data.schema,onUpdateValue:s=>t("schema",s),placeholder:"JSON Schema URL",size:"small"},null)]}),n("div",{class:"space-y-3"},[n(gu,{value:!e.data.private,label:"公开访问",disabled:e.isBuiltFunction,"onUpdate:value":s=>t("private",!s)},null),e.isFunctionType&&n(gu,{value:e.data.enable??!0,label:"启用函数",disabled:e.isBuiltFunction,"onUpdate:value":s=>t("enable",s)},null)]),n(oe,{label:"备注"},{default:()=>[n(W,{value:e.data.comment,onUpdateValue:s=>t("comment",s),type:"textarea",rows:2,placeholder:"添加备注说明…",size:"small"},null)]}),e.isFunctionType&&n(or,{title:"Secret 环境变量"},{default:()=>[n(ir,{key:e.data.id,plainKeyInput:!0,onChange:s=>t("secret",s),value:e.data.secret||{}},null)]})])}});var I=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},$={searchParams:"URLSearchParams"in I,iterable:"Symbol"in I&&"iterator"in Symbol,blob:"FileReader"in I&&"Blob"in I&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in I,arrayBuffer:"ArrayBuffer"in I};function lr(e){return e&&DataView.prototype.isPrototypeOf(e)}if($.arrayBuffer)var cr=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Dr=ArrayBuffer.isView||function(e){return e&&cr.indexOf(Object.prototype.toString.call(e))>-1};function Fe(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function au(e){return typeof e!="string"&&(e=String(e)),e}function su(e){var u={next:function(){var t=e.shift();return{done:t===void 0,value:t}}};return $.iterable&&(u[Symbol.iterator]=function(){return u}),u}function q(e){this.map={},e instanceof q?e.forEach(function(u,t){this.append(t,u)},this):Array.isArray(e)?e.forEach(function(u){if(u.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+u.length);this.append(u[0],u[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(u){this.append(u,e[u])},this)}q.prototype.append=function(e,u){e=Fe(e),u=au(u);var t=this.map[e];this.map[e]=t?t+", "+u:u};q.prototype.delete=function(e){delete this.map[Fe(e)]};q.prototype.get=function(e){return e=Fe(e),this.has(e)?this.map[e]:null};q.prototype.has=function(e){return this.map.hasOwnProperty(Fe(e))};q.prototype.set=function(e,u){this.map[Fe(e)]=au(u)};q.prototype.forEach=function(e,u){for(var t in this.map)this.map.hasOwnProperty(t)&&e.call(u,this.map[t],t,this)};q.prototype.keys=function(){var e=[];return this.forEach(function(u,t){e.push(t)}),su(e)};q.prototype.values=function(){var e=[];return this.forEach(function(u){e.push(u)}),su(e)};q.prototype.entries=function(){var e=[];return this.forEach(function(u,t){e.push([t,u])}),su(e)};$.iterable&&(q.prototype[Symbol.iterator]=q.prototype.entries);function Le(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function Gu(e){return new Promise(function(u,t){e.onload=function(){u(e.result)},e.onerror=function(){t(e.error)}})}function fr(e){var u=new FileReader,t=Gu(u);return u.readAsArrayBuffer(e),t}function dr(e){var u=new FileReader,t=Gu(u),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type),a=r?r[1]:"utf-8";return u.readAsText(e,a),t}function pr(e){for(var u=new Uint8Array(e),t=new Array(u.length),r=0;r<u.length;r++)t[r]=String.fromCharCode(u[r]);return t.join("")}function wu(e){if(e.slice)return e.slice(0);var u=new Uint8Array(e.byteLength);return u.set(new Uint8Array(e)),u.buffer}function Hu(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:$.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:$.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:$.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():$.arrayBuffer&&$.blob&&lr(e)?(this._bodyArrayBuffer=wu(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):$.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||Dr(e))?this._bodyArrayBuffer=wu(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):$.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},$.blob&&(this.blob=function(){var e=Le(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=Le(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if($.blob)return this.blob().then(fr);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=Le(this);if(e)return e;if(this._bodyBlob)return dr(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pr(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},$.formData&&(this.formData=function(){return this.text().then(Cr)}),this.json=function(){return this.text().then(JSON.parse)},this}var Fr=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function hr(e){var u=e.toUpperCase();return Fr.indexOf(u)>-1?u:e}function de(e,u){if(!(this instanceof de))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');u=u||{};var t=u.body;if(e instanceof de){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,u.headers||(this.headers=new q(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!t&&e._bodyInit!=null&&(t=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=u.credentials||this.credentials||"same-origin",(u.headers||!this.headers)&&(this.headers=new q(u.headers)),this.method=hr(u.method||this.method||"GET"),this.mode=u.mode||this.mode||null,this.signal=u.signal||this.signal||(function(){if("AbortController"in I){var s=new AbortController;return s.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(u.cache==="no-store"||u.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var a=/\?/;this.url+=(a.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}de.prototype.clone=function(){return new de(this,{body:this._bodyInit})};function Cr(e){var u=new FormData;return e.trim().split("&").forEach(function(t){if(t){var r=t.split("="),a=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");u.append(decodeURIComponent(a),decodeURIComponent(s))}}),u}function Ar(e){var u=new q,t=e.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var a=r.split(":"),s=a.shift().trim();if(s){var i=a.join(":").trim();try{u.append(s,i)}catch(o){console.warn("Response "+o.message)}}}),u}Hu.call(de.prototype);function Z(e,u){if(!(this instanceof Z))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(u||(u={}),this.type="default",this.status=u.status===void 0?200:u.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=u.statusText===void 0?"":""+u.statusText,this.headers=new q(u.headers),this.url=u.url||"",this._initBody(e)}Hu.call(Z.prototype);Z.prototype.clone=function(){return new Z(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new q(this.headers),url:this.url})};Z.error=function(){var e=new Z(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var Er=[301,302,303,307,308];Z.redirect=function(e,u){if(Er.indexOf(u)===-1)throw new RangeError("Invalid status code");return new Z(null,{status:u,headers:{location:e}})};var De=I.DOMException;try{new De}catch{De=function(u,t){this.message=u,this.name=t;var r=Error(u);this.stack=r.stack},De.prototype=Object.create(Error.prototype),De.prototype.constructor=De}function Ku(e,u){return new Promise(function(t,r){var a=new de(e,u);if(a.signal&&a.signal.aborted)return r(new De("Aborted","AbortError"));var s=new XMLHttpRequest;function i(){s.abort()}s.onload=function(){var c={statusText:s.statusText,headers:Ar(s.getAllResponseHeaders()||"")};a.url.indexOf("file://")===0&&(s.status<200||s.status>599)?c.status=200:c.status=s.status,c.url="responseURL"in s?s.responseURL:c.headers.get("X-Request-URL");var f="response"in s?s.response:s.responseText;setTimeout(function(){t(new Z(f,c))},0)},s.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},s.onabort=function(){setTimeout(function(){r(new De("Aborted","AbortError"))},0)};function o(c){try{return c===""&&I.location.href?I.location.href:c}catch{return c}}if(s.open(a.method,o(a.url),!0),a.credentials==="include"?s.withCredentials=!0:a.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&($.blob?s.responseType="blob":$.arrayBuffer&&(s.responseType="arraybuffer")),u&&typeof u.headers=="object"&&!(u.headers instanceof q||I.Headers&&u.headers instanceof I.Headers)){var D=[];Object.getOwnPropertyNames(u.headers).forEach(function(c){D.push(Fe(c)),s.setRequestHeader(c,au(u.headers[c]))}),a.headers.forEach(function(c,f){D.indexOf(f)===-1&&s.setRequestHeader(f,c)})}else a.headers.forEach(function(c,f){s.setRequestHeader(f,c)});a.signal&&(a.signal.addEventListener("abort",i),s.onreadystatechange=function(){s.readyState===4&&a.signal.removeEventListener("abort",i)}),s.send(typeof a._bodyInit>"u"?null:a._bodyInit)})}Ku.polyfill=!0;I.fetch||(I.fetch=Ku,I.Headers=q,I.Request=de,I.Response=Z);var Ve,xu;function mr(){return xu||(xu=1,Ve=self.fetch.bind(self)),Ve}mr();var Wu={};function Su(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);u&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function L(e){for(var u=1;u<arguments.length;u++){var t=arguments[u]!=null?arguments[u]:{};u%2?Su(Object(t),!0).forEach(function(r){yr(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Su(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function ae(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ae=function(u){return typeof u}:ae=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},ae(e)}function ke(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}function ku(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iu(e,u,t){return u&&ku(e.prototype,u),t&&ku(e,t),e}function yr(e,u,t){return u in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function Xu(e,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(u&&u.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),u&&be(e,u)}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ge(e)}function be(e,u){return be=Object.setPrototypeOf||function(r,a){return r.__proto__=a,r},be(e,u)}function Yu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Te(e,u,t){return Yu()?Te=Reflect.construct:Te=function(a,s,i){var o=[null];o.push.apply(o,s);var D=Function.bind.apply(a,o),c=new D;return i&&be(c,i.prototype),c},Te.apply(null,arguments)}function vr(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function qe(e){var u=typeof Map=="function"?new Map:void 0;return qe=function(r){if(r===null||!vr(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(r))return u.get(r);u.set(r,a)}function a(){return Te(r,arguments,ge(this).constructor)}return a.prototype=Object.create(r.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),be(a,r)},qe(e)}function Br(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gr(e,u){if(u&&(typeof u=="object"||typeof u=="function"))return u;if(u!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Br(e)}function Zu(e){var u=Yu();return function(){var r=ge(e),a;if(u){var s=ge(this).constructor;a=Reflect.construct(r,arguments,s)}else a=r.apply(this,arguments);return gr(this,a)}}function X(e){return br(e)||wr(e)||xr(e)||Sr()}function br(e){if(Array.isArray(e))return Xe(e)}function wr(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xr(e,u){if(e){if(typeof e=="string")return Xe(e,u);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Xe(e,u)}}function Xe(e,u){(u==null||u>e.length)&&(u=e.length);for(var t=0,r=new Array(u);t<u;t++)r[t]=e[t];return r}function Sr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kr(e){if(!Array.isArray(e))throw new TypeError("Middlewares must be an array!");for(var u=e.length,t=0;t<u;t++)if(typeof e[t]!="function")throw new TypeError("Middleware must be componsed of function");return function(a,s){var i=-1;function o(D){if(D<=i)return Promise.reject(new Error("next() should not be called multiple times in one middleware!"));i=D;var c=e[D]||s;if(!c)return Promise.resolve();try{return Promise.resolve(c(a,function(){return o(D+1)}))}catch(f){return Promise.reject(f)}}return o(0)}}var G=(function(){function e(u){if(ke(this,e),!Array.isArray(u))throw new TypeError("Default middlewares must be an array!");this.defaultMiddlewares=X(u),this.middlewares=[]}return iu(e,[{key:"use",value:(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{global:!1,core:!1,defaultInstance:!1},a=!1,s=!1,i=!1;if(typeof r=="number"?(process,a=!0,s=!1):ae(r)==="object"&&r&&(s=r.global||!1,a=r.core||!1,i=r.defaultInstance||!1),s){e.globalMiddlewares.splice(e.globalMiddlewares.length-e.defaultGlobalMiddlewaresLength,0,t);return}if(a){e.coreMiddlewares.splice(e.coreMiddlewares.length-e.defaultCoreMiddlewaresLength,0,t);return}if(i){this.defaultMiddlewares.push(t);return}this.middlewares.push(t)})},{key:"execute",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=kr([].concat(X(this.middlewares),X(this.defaultMiddlewares),X(e.globalMiddlewares),X(e.coreMiddlewares)));return r(t)}}]),e})();G.globalMiddlewares=[];G.defaultGlobalMiddlewaresLength=0;G.coreMiddlewares=[];G.defaultCoreMiddlewaresLength=0;var Or=(function(){function e(u){ke(this,e),this.cache=new Map,this.timer={},this.extendOptions(u)}return iu(e,[{key:"extendOptions",value:function(t){this.maxCache=t.maxCache||0}},{key:"get",value:function(t){return this.cache.get(JSON.stringify(t))}},{key:"set",value:function(t,r){var a=this,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:6e4;if(this.maxCache>0&&this.cache.size>=this.maxCache){var i=X(this.cache.keys())[0];this.cache.delete(i),this.timer[i]&&clearTimeout(this.timer[i])}var o=JSON.stringify(t);this.cache.set(o,r),s>0&&(this.timer[o]=setTimeout(function(){a.cache.delete(o),delete a.timer[o]},s))}},{key:"delete",value:function(t){var r=JSON.stringify(t);return delete this.timer[r],this.cache.delete(r)}},{key:"clear",value:function(){return this.timer={},this.cache.clear()}}]),e})(),Qu=(function(e){Xu(t,e);var u=Zu(t);function t(r,a){var s,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"RequestError";return ke(this,t),s=u.call(this,r),s.name="RequestError",s.request=a,s.type=i,s}return t})(qe(Error)),Ae=(function(e){Xu(t,e);var u=Zu(t);function t(r,a,s,i){var o,D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"ResponseError";return ke(this,t),o=u.call(this,a||r.statusText),o.name="ResponseError",o.data=s,o.response=r,o.request=i,o.type=D,o}return t})(qe(Error));function _r(e){return new Promise(function(u,t){var r=new FileReader;r.onload=function(){u(r.result)},r.onerror=t,r.readAsText(e,"GBK")})}function Ou(e){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;try{return JSON.parse(e)}catch{if(u)throw new Ae(t,"JSON.parse fail",e,r,"ParseError")}return e}function Tr(e,u,t){return new Promise(function(r,a){setTimeout(function(){a(new Qu(u||"timeout of ".concat(e,"ms exceeded"),t,"Timeout"))},e)})}function _u(e){return new Promise(function(u,t){e.cancelToken&&e.cancelToken.promise.then(function(r){t(r)})})}var Pr=Object.prototype.toString;function et(){var e;return typeof process<"u"&&Pr.call(process)==="[object process]"&&(e="NODE"),typeof XMLHttpRequest<"u"&&(e="BROWSER"),e}function Ye(e){return ae(e)==="object"&&Object.prototype.toString.call(e)==="[object Array]"}function ut(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}function qr(e){return ae(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Tu(e){return e!==null&&ae(e)==="object"}function Pu(e,u){if(e)if(ae(e)!=="object"&&(e=[e]),Ye(e))for(var t=0;t<e.length;t++)u.call(null,e[t],t,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&u.call(null,e[r],r,e)}function qu(e){return ut(e)?zu.parse(e.toString(),{strictNullHandling:!0}):typeof e=="string"?[e]:e}function Ze(e){return zu.stringify(e,{arrayFormat:"repeat",strictNullHandling:!0})}function tt(e,u){return L(L(L({},e),u),{},{headers:L(L({},e.headers),u.headers),params:L(L({},qu(e.params)),qu(u.params)),method:(u.method||e.method||"get").toLowerCase()})}var jr=function(u){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.prefix,a=t.suffix;return r&&(u="".concat(r).concat(u)),a&&(u="".concat(u).concat(a)),{url:u,options:t}};function Nr(e,u){var t=u.method,r=t===void 0?"get":t;return r.toLowerCase()==="get"}function Ir(e,u){if(!e)return u();var t=e.req;t=t===void 0?{}:t;var r=t.options,a=r===void 0?{}:r,s=t.url,i=s===void 0?"":s,o=e.cache,D=e.responseInterceptors,c=a.timeout,f=c===void 0?0:c,y=a.timeoutMessage,p=a.__umiRequestCoreType__,A=p===void 0?"normal":p,x=a.useCache,F=x===void 0?!1:x,m=a.method,d=m===void 0?"get":m,S=a.params,T=a.ttl,g=a.validateCache,O=g===void 0?Nr:g;if(A!=="normal")return process,u();var R=fetch;if(!R)throw new Error("Global fetch not exist!");var Me=et()==="BROWSER",he=O(i,a)&&F&&Me;if(he){var re=o.get({url:i,params:S,method:d});if(re)return re=re.clone(),re.useCache=!0,e.res=re,u()}var H;return f>0?H=Promise.race([_u(a),R(i,a),Tr(f,y,e.req)]):H=Promise.race([_u(a),R(i,a)]),D.forEach(function(ie){H=H.then(function(Q){var Oe=typeof Q.clone=="function"?Q.clone():Q;return ie(Oe,a)})}),H.then(function(ie){if(he&&ie.status===200){var Q=ie.clone();Q.useCache=!0,o.set({url:i,params:S,method:d},Q,T)}return e.res=ie,u()})}function Rr(e,u){var t;return u().then(function(){if(e){var r=e.res,a=r===void 0?{}:r,s=e.req,i=s===void 0?{}:s,o=i||{},D=o.options;D=D===void 0?{}:D;var c=D.responseType,f=c===void 0?"json":c,y=D.charset,p=y===void 0?"utf8":y;D.getResponse;var A=D.throwErrIfParseFail,x=A===void 0?!1:A,F=D.parseResponse,m=F===void 0?!0:F;if(m&&!(!a||!a.clone)){if(t=et()==="BROWSER"?a.clone():a,t.useCache=a.useCache||!1,p==="gbk")try{return a.blob().then(_r).then(function(d){return Ou(d,!1,t,i)})}catch(d){throw new Ae(t,d.message,null,i,"ParseError")}else if(f==="json")return a.text().then(function(d){return Ou(d,x,t,i)});try{return a[f]()}catch{throw new Ae(t,"responseType not support",null,i,"ParseError")}}}}).then(function(r){if(e){e.res;var a=e.req,s=a===void 0?{}:a,i=s||{},o=i.options;o=o===void 0?{}:o;var D=o.getResponse,c=D===void 0?!1:D;if(t){if(t.status>=200&&t.status<300){if(c){e.res={data:r,response:t};return}e.res=r;return}throw new Ae(t,"http error",r,s,"HttpError")}}}).catch(function(r){if(r instanceof Qu||r instanceof Ae)throw r;var a=e.req,s=e.res;throw r.request=r.request||a,r.response=r.response||s,r.type=r.type||r.name,r.data=r.data||void 0,r})}function $r(e,u){if(!e)return u();var t=e.req;t=t===void 0?{}:t;var r=t.options,a=r===void 0?{}:r,s=a.method,i=s===void 0?"get":s;if(["post","put","patch","delete"].indexOf(i.toLowerCase())===-1)return u();var o=a.requestType,D=o===void 0?"json":o,c=a.data;if(c){var f=Object.prototype.toString.call(c);f==="[object Object]"||f==="[object Array]"?D==="json"?(a.headers=L({Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},a.headers),a.body=JSON.stringify(c)):D==="form"&&(a.headers=L({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},a.headers),a.body=Ze(c)):(a.headers=L({Accept:"application/json"},a.headers),a.body=c)}return e.req.options=a,u()}function Mr(e,u){var t,r;if(e)if(u)t=u(e);else if(ut(e))t=e.toString();else if(Ye(e))r=[],Pu(e,function(s){s===null||typeof s>"u"?r.push(s):r.push(Tu(s)?JSON.stringify(s):s)}),t=Ze(r);else{r={},Pu(e,function(s,i){var o=s;s===null||typeof s>"u"?r[i]=s:qr(s)?o=s.toISOString():Ye(s)?o=s:Tu(s)&&(o=JSON.stringify(s)),r[i]=o});var a=Ze(r);t=a}return t}function Ur(e,u){if(!e)return u();var t=e.req;t=t===void 0?{}:t;var r=t.options,a=r===void 0?{}:r,s=a.paramsSerializer,i=a.params,o=e.req;o=o===void 0?{}:o;var D=o.url,c=D===void 0?"":D;a.method=a.method?a.method.toUpperCase():"GET",a.credentials=a.credentials||"same-origin";var f=Mr(i,s);if(e.req.originUrl=c,f){var y=c.indexOf("?")!==-1?"&":"?";e.req.url="".concat(c).concat(y).concat(f)}return e.req.options=a,u()}var rt=[$r,Ur,Rr],nt=[Ir];G.globalMiddlewares=rt;G.defaultGlobalMiddlewaresLength=rt.length;G.coreMiddlewares=nt;G.defaultCoreMiddlewaresLength=nt.length;var me=(function(){function e(u){ke(this,e),this.onion=new G([]),this.fetchIndex=0,this.mapCache=new Or(u),this.initOptions=u,this.instanceRequestInterceptors=[],this.instanceResponseInterceptors=[]}return iu(e,[{key:"use",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{global:!1,core:!1};return this.onion.use(t,r),this}},{key:"extendOptions",value:function(t){this.initOptions=tt(this.initOptions,t),this.mapCache.extendOptions(t)}},{key:"dealRequestInterceptors",value:function(t){var r=function(i,o){return i.then(function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.req.url=D.url||t.req.url,t.req.options=D.options||t.req.options,o(t.req.url,t.req.options)})},a=[].concat(X(e.requestInterceptors),X(this.instanceRequestInterceptors));return a.reduce(r,Promise.resolve()).then(function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.req.url=s.url||t.req.url,t.req.options=s.options||t.req.options,Promise.resolve()})}},{key:"request",value:function(t,r){var a=this,s=this.onion,i={req:{url:t,options:L(L({},r),{},{url:t})},res:null,cache:this.mapCache,responseInterceptors:[].concat(X(e.responseInterceptors),X(this.instanceResponseInterceptors))};if(typeof t!="string")throw new Error("url MUST be a string");return new Promise(function(o,D){a.dealRequestInterceptors(i).then(function(){return s.execute(i)}).then(function(){o(i.res)}).catch(function(c){var f=i.req.options.errorHandler;if(f)try{var y=f(c);o(y)}catch(p){D(p)}else D(c)})})}}],[{key:"requestUse",value:(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{global:!0};if(typeof t!="function")throw new TypeError("Interceptor must be function!");r.global?e.requestInterceptors.push(t):this.instanceRequestInterceptors.push(t)})},{key:"responseUse",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{global:!0};if(typeof t!="function")throw new TypeError("Interceptor must be function!");r.global?e.responseInterceptors.push(t):this.instanceResponseInterceptors.push(t)}}]),e})();me.requestInterceptors=[jr];me.responseInterceptors=[];function $e(e){this.message=e}$e.prototype.toString=function(){return this.message?"Cancel: ".concat(this.message):"Cancel"};$e.prototype.__CANCEL__=!0;function je(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var u;this.promise=new Promise(function(a){u=a});var t=this;e(function(a){t.reason||(t.reason=new $e(a),u(t.reason))})}je.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};je.source=function(){var u,t=new je(function(a){u=a});return{token:t,cancel:u}};function Lr(e){return!!(e&&e.__CANCEL__)}var ou=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=new me(u),r=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=tt(t.initOptions,o);return t.request(i,D)};r.use=t.use.bind(t),r.fetchIndex=t.fetchIndex,r.interceptors={request:{use:me.requestUse.bind(t)},response:{use:me.responseUse.bind(t)}};var a=["get","post","delete","put","patch","head","options","rpc"];return a.forEach(function(s){r[s]=function(i,o){return r(i,L(L({},o),{},{method:s}))}}),r.Cancel=$e,r.CancelToken=je,r.isCancel=Lr,r.extendOptions=t.extendOptions.bind(t),r.middlewares={instance:t.onion.middlewares,defaultInstance:t.onion.defaultMiddlewares,global:G.globalMiddlewares,core:G.coreMiddlewares},r},Vr=function(u){return ou(u)};ou({parseResponse:!1});ou({});const zr=async e=>Vr({}).get(`https://registry.npmjs.org/${e}/latest`),Jr=()=>{const e=v({dependencies:{}});return{dependencyGraph:e,fetchDependencyGraph:async()=>{const t=await Yt.getGraph();e.value={...t}}}},Pe=v({}),ju=async e=>{if(Pe.value[e])return Promise.resolve(Pe.value[e]);const u=await zr(e);return Pe.value[e]=u,u},Gr=N({name:"UpdateDependencyButton",setup(){const e=v(!1),{dependencyGraph:u,fetchDependencyGraph:t}=Jr(),r=Y(()=>e.value,()=>{e.value&&t().then(()=>{r()})}),a=v();return kt(()=>{Pe.value={}}),()=>{const s=[...Object.entries(u.value.dependencies).map(([i,o])=>({package:i,version:o}))];return n(fe,null,[n(Re,{icon:n(Gt,null,null),name:"更新依赖",onClick:()=>{e.value=!0}},null),n(xe,{show:e.value,onUpdateShow:i=>{e.value=i}},{default:()=>[n(Se,{class:"modal-card sm",title:"依赖更新"},{default:()=>[n(Ot,{bordered:!0,virtualScroll:!0,maxHeight:600,data:s,columns:[{key:"package",title:"包名",width:180,ellipsis:{lineClamp:2,tooltip:!0},render(i){return n("a",{href:`https://npmjs.com/package/${i.package}`,target:"_blank",rel:"noreferrer"},[i.package])}},{key:"version",title:"版本",width:100},{key:"latest",title:"最新",width:100,render(i){return n(N({setup(){const D=v(),c=_t(D),f=v(null),y=Y(()=>c.value,p=>{p&&(y(),ju(i.package).then(A=>{f.value=A}))});return()=>n("div",{ref:D},[f.value?f.value.version:"..."])}}),null,null)}},{title:"操作",key:"",width:80,render(i){return n(U,{quaternary:!0,type:"info",onClick:()=>{ju(i.package).then(o=>{const D=o.version,c=`${i.package}@${D}`;a.value?.install(c,()=>{t()})})}},{default:()=>[k("更新")]})}}]},null)]})]}),n(nu,{ref:a},null)])}}});var Hr=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,Kr=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,Wr=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,ze={Space_Separator:Hr,ID_Start:Kr,ID_Continue:Wr},_={isSpaceSeparator(e){return typeof e=="string"&&ze.Space_Separator.test(e)},isIdStartChar(e){return typeof e=="string"&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="$"||e==="_"||ze.ID_Start.test(e))},isIdContinueChar(e){return typeof e=="string"&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||e==="$"||e==="_"||e==="‌"||e==="‍"||ze.ID_Continue.test(e))},isDigit(e){return typeof e=="string"&&/[0-9]/.test(e)},isHexDigit(e){return typeof e=="string"&&/[0-9A-Fa-f]/.test(e)}};let Qe,M,ue,Ne,se,J,j,lu,ye;var Xr=function(u,t){Qe=String(u),M="start",ue=[],Ne=0,se=1,J=0,j=void 0,lu=void 0,ye=void 0;do j=Yr(),en[M]();while(j.type!=="eof");return typeof t=="function"?eu({"":ye},"",t):ye};function eu(e,u,t){const r=e[u];if(r!=null&&typeof r=="object")if(Array.isArray(r))for(let a=0;a<r.length;a++){const s=String(a),i=eu(r,s,t);i===void 0?delete r[s]:Object.defineProperty(r,s,{value:i,writable:!0,enumerable:!0,configurable:!0})}else for(const a in r){const s=eu(r,a,t);s===void 0?delete r[a]:Object.defineProperty(r,a,{value:s,writable:!0,enumerable:!0,configurable:!0})}return t.call(e,u,r)}let C,h,Ee,ee,E;function Yr(){for(C="default",h="",Ee=!1,ee=1;;){E=te();const e=at[C]();if(e)return e}}function te(){if(Qe[Ne])return String.fromCodePoint(Qe.codePointAt(Ne))}function l(){const e=te();return e===`
`?(se++,J=0):e?J+=e.length:J++,e&&(Ne+=e.length),e}const at={default(){switch(E){case"	":case"\v":case"\f":case" ":case" ":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":l();return;case"/":l(),C="comment";return;case void 0:return l(),b("eof")}if(_.isSpaceSeparator(E)){l();return}return at[M]()},comment(){switch(E){case"*":l(),C="multiLineComment";return;case"/":l(),C="singleLineComment";return}throw w(l())},multiLineComment(){switch(E){case"*":l(),C="multiLineCommentAsterisk";return;case void 0:throw w(l())}l()},multiLineCommentAsterisk(){switch(E){case"*":l();return;case"/":l(),C="default";return;case void 0:throw w(l())}l(),C="multiLineComment"},singleLineComment(){switch(E){case`
`:case"\r":case"\u2028":case"\u2029":l(),C="default";return;case void 0:return l(),b("eof")}l()},value(){switch(E){case"{":case"[":return b("punctuator",l());case"n":return l(),le("ull"),b("null",null);case"t":return l(),le("rue"),b("boolean",!0);case"f":return l(),le("alse"),b("boolean",!1);case"-":case"+":l()==="-"&&(ee=-1),C="sign";return;case".":h=l(),C="decimalPointLeading";return;case"0":h=l(),C="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":h=l(),C="decimalInteger";return;case"I":return l(),le("nfinity"),b("numeric",1/0);case"N":return l(),le("aN"),b("numeric",NaN);case'"':case"'":Ee=l()==='"',h="",C="string";return}throw w(l())},identifierNameStartEscape(){if(E!=="u")throw w(l());l();const e=uu();switch(e){case"$":case"_":break;default:if(!_.isIdStartChar(e))throw Nu();break}h+=e,C="identifierName"},identifierName(){switch(E){case"$":case"_":case"‌":case"‍":h+=l();return;case"\\":l(),C="identifierNameEscape";return}if(_.isIdContinueChar(E)){h+=l();return}return b("identifier",h)},identifierNameEscape(){if(E!=="u")throw w(l());l();const e=uu();switch(e){case"$":case"_":case"‌":case"‍":break;default:if(!_.isIdContinueChar(e))throw Nu();break}h+=e,C="identifierName"},sign(){switch(E){case".":h=l(),C="decimalPointLeading";return;case"0":h=l(),C="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":h=l(),C="decimalInteger";return;case"I":return l(),le("nfinity"),b("numeric",ee*(1/0));case"N":return l(),le("aN"),b("numeric",NaN)}throw w(l())},zero(){switch(E){case".":h+=l(),C="decimalPoint";return;case"e":case"E":h+=l(),C="decimalExponent";return;case"x":case"X":h+=l(),C="hexadecimal";return}return b("numeric",ee*0)},decimalInteger(){switch(E){case".":h+=l(),C="decimalPoint";return;case"e":case"E":h+=l(),C="decimalExponent";return}if(_.isDigit(E)){h+=l();return}return b("numeric",ee*Number(h))},decimalPointLeading(){if(_.isDigit(E)){h+=l(),C="decimalFraction";return}throw w(l())},decimalPoint(){switch(E){case"e":case"E":h+=l(),C="decimalExponent";return}if(_.isDigit(E)){h+=l(),C="decimalFraction";return}return b("numeric",ee*Number(h))},decimalFraction(){switch(E){case"e":case"E":h+=l(),C="decimalExponent";return}if(_.isDigit(E)){h+=l();return}return b("numeric",ee*Number(h))},decimalExponent(){switch(E){case"+":case"-":h+=l(),C="decimalExponentSign";return}if(_.isDigit(E)){h+=l(),C="decimalExponentInteger";return}throw w(l())},decimalExponentSign(){if(_.isDigit(E)){h+=l(),C="decimalExponentInteger";return}throw w(l())},decimalExponentInteger(){if(_.isDigit(E)){h+=l();return}return b("numeric",ee*Number(h))},hexadecimal(){if(_.isHexDigit(E)){h+=l(),C="hexadecimalInteger";return}throw w(l())},hexadecimalInteger(){if(_.isHexDigit(E)){h+=l();return}return b("numeric",ee*Number(h))},string(){switch(E){case"\\":l(),h+=Zr();return;case'"':if(Ee)return l(),b("string",h);h+=l();return;case"'":if(!Ee)return l(),b("string",h);h+=l();return;case`
`:case"\r":throw w(l());case"\u2028":case"\u2029":un(E);break;case void 0:throw w(l())}h+=l()},start(){switch(E){case"{":case"[":return b("punctuator",l())}C="value"},beforePropertyName(){switch(E){case"$":case"_":h=l(),C="identifierName";return;case"\\":l(),C="identifierNameStartEscape";return;case"}":return b("punctuator",l());case'"':case"'":Ee=l()==='"',C="string";return}if(_.isIdStartChar(E)){h+=l(),C="identifierName";return}throw w(l())},afterPropertyName(){if(E===":")return b("punctuator",l());throw w(l())},beforePropertyValue(){C="value"},afterPropertyValue(){switch(E){case",":case"}":return b("punctuator",l())}throw w(l())},beforeArrayValue(){if(E==="]")return b("punctuator",l());C="value"},afterArrayValue(){switch(E){case",":case"]":return b("punctuator",l())}throw w(l())},end(){throw w(l())}};function b(e,u){return{type:e,value:u,line:se,column:J}}function le(e){for(const u of e){if(te()!==u)throw w(l());l()}}function Zr(){switch(te()){case"b":return l(),"\b";case"f":return l(),"\f";case"n":return l(),`
`;case"r":return l(),"\r";case"t":return l(),"	";case"v":return l(),"\v";case"0":if(l(),_.isDigit(te()))throw w(l());return"\0";case"x":return l(),Qr();case"u":return l(),uu();case`
`:case"\u2028":case"\u2029":return l(),"";case"\r":return l(),te()===`
`&&l(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw w(l());case void 0:throw w(l())}return l()}function Qr(){let e="",u=te();if(!_.isHexDigit(u)||(e+=l(),u=te(),!_.isHexDigit(u)))throw w(l());return e+=l(),String.fromCodePoint(parseInt(e,16))}function uu(){let e="",u=4;for(;u-- >0;){const t=te();if(!_.isHexDigit(t))throw w(l());e+=l()}return String.fromCodePoint(parseInt(e,16))}const en={start(){if(j.type==="eof")throw ce();Je()},beforePropertyName(){switch(j.type){case"identifier":case"string":lu=j.value,M="afterPropertyName";return;case"punctuator":_e();return;case"eof":throw ce()}},afterPropertyName(){if(j.type==="eof")throw ce();M="beforePropertyValue"},beforePropertyValue(){if(j.type==="eof")throw ce();Je()},beforeArrayValue(){if(j.type==="eof")throw ce();if(j.type==="punctuator"&&j.value==="]"){_e();return}Je()},afterPropertyValue(){if(j.type==="eof")throw ce();switch(j.value){case",":M="beforePropertyName";return;case"}":_e()}},afterArrayValue(){if(j.type==="eof")throw ce();switch(j.value){case",":M="beforeArrayValue";return;case"]":_e()}},end(){}};function Je(){let e;switch(j.type){case"punctuator":switch(j.value){case"{":e={};break;case"[":e=[];break}break;case"null":case"boolean":case"numeric":case"string":e=j.value;break}if(ye===void 0)ye=e;else{const u=ue[ue.length-1];Array.isArray(u)?u.push(e):Object.defineProperty(u,lu,{value:e,writable:!0,enumerable:!0,configurable:!0})}if(e!==null&&typeof e=="object")ue.push(e),Array.isArray(e)?M="beforeArrayValue":M="beforePropertyName";else{const u=ue[ue.length-1];u==null?M="end":Array.isArray(u)?M="afterArrayValue":M="afterPropertyValue"}}function _e(){ue.pop();const e=ue[ue.length-1];e==null?M="end":Array.isArray(e)?M="afterArrayValue":M="afterPropertyValue"}function w(e){return Ie(e===void 0?`JSON5: invalid end of input at ${se}:${J}`:`JSON5: invalid character '${st(e)}' at ${se}:${J}`)}function ce(){return Ie(`JSON5: invalid end of input at ${se}:${J}`)}function Nu(){return J-=5,Ie(`JSON5: invalid identifier character at ${se}:${J}`)}function un(e){console.warn(`JSON5: '${st(e)}' in strings is not valid ECMAScript; consider escaping`)}function st(e){const u={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(u[e])return u[e];if(e<" "){const t=e.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return e}function Ie(e){const u=new SyntaxError(e);return u.lineNumber=se,u.columnNumber=J,u}var tn=function(u,t,r){const a=[];let s="",i,o,D="",c;if(t!=null&&typeof t=="object"&&!Array.isArray(t)&&(r=t.space,c=t.quote,t=t.replacer),typeof t=="function")o=t;else if(Array.isArray(t)){i=[];for(const F of t){let m;typeof F=="string"?m=F:(typeof F=="number"||F instanceof String||F instanceof Number)&&(m=String(F)),m!==void 0&&i.indexOf(m)<0&&i.push(m)}}return r instanceof Number?r=Number(r):r instanceof String&&(r=String(r)),typeof r=="number"?r>0&&(r=Math.min(10,Math.floor(r)),D="          ".substr(0,r)):typeof r=="string"&&(D=r.substr(0,10)),f("",{"":u});function f(F,m){let d=m[F];switch(d!=null&&(typeof d.toJSON5=="function"?d=d.toJSON5(F):typeof d.toJSON=="function"&&(d=d.toJSON(F))),o&&(d=o.call(m,F,d)),d instanceof Number?d=Number(d):d instanceof String?d=String(d):d instanceof Boolean&&(d=d.valueOf()),d){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof d=="string")return y(d);if(typeof d=="number")return String(d);if(typeof d=="object")return Array.isArray(d)?x(d):p(d)}function y(F){const m={"'":.1,'"':.2},d={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let S="";for(let g=0;g<F.length;g++){const O=F[g];switch(O){case"'":case'"':m[O]++,S+=O;continue;case"\0":if(_.isDigit(F[g+1])){S+="\\x00";continue}}if(d[O]){S+=d[O];continue}if(O<" "){let R=O.charCodeAt(0).toString(16);S+="\\x"+("00"+R).substring(R.length);continue}S+=O}const T=c||Object.keys(m).reduce((g,O)=>m[g]<m[O]?g:O);return S=S.replace(new RegExp(T,"g"),d[T]),T+S+T}function p(F){if(a.indexOf(F)>=0)throw TypeError("Converting circular structure to JSON5");a.push(F);let m=s;s=s+D;let d=i||Object.keys(F),S=[];for(const g of d){const O=f(g,F);if(O!==void 0){let R=A(g)+":";D!==""&&(R+=" "),R+=O,S.push(R)}}let T;if(S.length===0)T="{}";else{let g;if(D==="")g=S.join(","),T="{"+g+"}";else{let O=`,
`+s;g=S.join(O),T=`{
`+s+g+`,
`+m+"}"}}return a.pop(),s=m,T}function A(F){if(F.length===0)return y(F);const m=String.fromCodePoint(F.codePointAt(0));if(!_.isIdStartChar(m))return y(F);for(let d=m.length;d<F.length;d++)if(!_.isIdContinueChar(String.fromCodePoint(F.codePointAt(d))))return y(F);return F}function x(F){if(a.indexOf(F)>=0)throw TypeError("Converting circular structure to JSON5");a.push(F);let m=s;s=s+D;let d=[];for(let T=0;T<F.length;T++){const g=f(String(T),F);d.push(g!==void 0?g:"null")}let S;if(d.length===0)S="[]";else if(D==="")S="["+d.join(",")+"]";else{let T=`,
`+s,g=d.join(T);S=`[
`+s+g+`,
`+m+"]"}return a.pop(),s=m,S}};const rn={parse:Xr,stringify:tn};var Ce=rn;function nn(e){const u=v(new hu),t=Tt({[B.JSON]:JSON.stringify({name:"hello world"},null,2),[B.JSON5]:Ce.stringify({name:"hello world"},null,2),[B.YAML]:"name: hello world",[B.Function]:Fu,[B.Text]:""});let r=B.JSON;const a=z(()=>!e.value),s=z(()=>u.value.type===B.Function),i=z(()=>u.value.type===B.Function&&u.value.builtIn&&!!e.value);Y(()=>u.value.type,(p,A)=>{if(p==="function"||p==="text"){u.value.raw=t[p],p!=="text"&&(u.value.method??="GET",u.value.enable??=!0);return}A!=="function"&&A!=="text"&&(r=A);const x=(()=>{switch(r){case"json":return JSON.parse(t.json);case"yaml":return du(t.yaml);case"json5":return Ce.parse(t.json5);case"function":return delete u.value.method,delete u.value.enable,""}})(),F=(()=>{switch(p){case"json":return JSON.stringify(x,null,2);case"yaml":return Pt(x);case"json5":return Ce.stringify(x,null,2)}})();u.value.raw=F||"",t[p]=F||""});const o=async p=>{const A=await ne.getById(p);A.type===B.JSON&&(A.raw=JSON.stringify(Ce.parse(A.raw),null,2)),u.value=A,r=A.type,t[A.type]=A.raw},D=p=>{u.value=new hu,p&&(u.value.reference=p),t[B.JSON]=JSON.stringify({name:"hello world"},null,2),t[B.JSON5]=Ce.stringify({name:"hello world"},null,2),t[B.YAML]="name: hello world",t[B.Function]=Fu,t[B.Text]="",r=B.JSON},c=async()=>{const p=d=>{try{return JSON.stringify(JSON.parse(d),null,0)}catch{return V.error("JSON 格式错误"),null}},x=(()=>{const d=t[u.value.type];switch(u.value.type){case B.JSON:return p(d);case B.YAML:try{du(d)}catch{return V.error("YAML 格式错误"),null}return d;case B.Function:return d;default:return d}})();if(x===null)return null;const m={...zt(u.value,["_id","id","created","data"]),raw:x};m.metatype||delete m.metatype;try{let d;return e.value?(d=await ne.update(e.value,m),V.success("更新成功")):(d=await ne.create(m),V.success("创建成功")),d}catch{return V.error("保存失败"),null}},f=p=>{t[u.value.type]=p},y=z(()=>t[u.value.type]);return{editData:u,typeToValueMap:t,isNew:a,isFunctionType:s,isBuiltFunction:i,editorValue:y,fetchSnippet:o,reset:D,save:c,updateEditorValue:f}}function an(){const e=v([]),u=v(!1),t=async()=>{u.value=!0;try{const o=await ne.getGroups({size:50}),D=new Map(e.value.map(c=>[c.reference,c.expanded]));e.value=o.data.map(c=>({...c,snippets:[],expanded:D.get(c.reference)??!1,loading:!1}))}finally{u.value=!1}},r=async o=>{const D=e.value.find(c=>c.reference===o);if(D){D.loading=!0;try{const c=await ne.getGroupSnippets(o);D.snippets=c}catch(c){console.error("Failed to fetch snippets:",c)}finally{D.loading=!1}}},a=async o=>{const D=e.value.find(c=>c.reference===o);D&&(D.expanded=!D.expanded,D.expanded&&D.snippets.length===0&&await r(o))},s=async o=>{const D=o.builtIn&&o.type==="function";if(!o.id)throw new Error("Snippet ID is required");D?await ne.resetFunction(o.id):await ne.delete(o.id);const c=e.value.find(f=>f.reference===o.reference);return c&&(c.snippets=c.snippets.filter(f=>f.id!==o.id),c.count=Math.max(0,c.count-1)),D?"reset":"delete"},i=z(()=>e.value.flatMap(o=>o.snippets));return we(()=>{t()}),{groupsWithSnippets:e,loading:u,allSnippets:i,fetchGroups:t,fetchGroupSnippets:r,toggleGroup:a,deleteSnippet:s}}const yn=N({name:"SnippetView",setup(){const e=Nt(),u=Rt(),t=qt(),r=jt(),a=v(null),s=v(!1),i=v(!1),{groupsWithSnippets:o,loading:D,fetchGroups:c,toggleGroup:f,deleteSnippet:y}=an(),{editData:p,isNew:A,isFunctionType:x,isBuiltFunction:F,editorValue:m,fetchSnippet:d,reset:S,save:T,updateEditorValue:g}=nn(a),O=z(()=>r.viewport.mobile);Y(a,P=>{u.replace({query:{id:P||void 0}})},{flush:"post"}),we(async()=>{e.query.id&&(a.value=e.query.id)}),Y(a,async P=>{P?(await d(P),O.value&&(s.value=!0)):S()});const R=()=>{a.value=null,S(),i.value=!0},Me=()=>{if(!p.value.name?.trim()){V.warning("请填写片段名称");return}if(!p.value.reference?.trim()){V.warning("请填写引用分组");return}i.value=!1,O.value&&(s.value=!0)},he=P=>{a.value=P.id??null},re=async P=>{const ct=await y(P);V.success(`${ct==="reset"?"重置":"删除"}成功`),a.value===P.id&&(a.value=null,O.value&&(s.value=!1))},H=async()=>{const P=await T();P&&(c(),A.value&&P.id&&(a.value=P.id))},ie=()=>{s.value=!1},Q=P=>{Object.assign(p.value,P)};It(()=>(t.setActions(n(fe,null,[n(Re,{onClick:R,icon:n(ru,null,null)},null),n(ur,{onFinish:c},null),n(Gr,null,null)])),()=>{t.setActions(null)}));const Oe=()=>n("div",{class:"w-[400px] max-w-[90vw]"},[n(bu,{data:p.value,isBuiltFunction:F.value,isFunctionType:x.value,isEditing:!A.value,"onUpdate:data":Q},null)]),it=()=>n("div",{class:"flex h-[calc(100vh-8rem)] gap-0 overflow-hidden rounded-lg border border-neutral-200 bg-white dark:border-neutral-800 dark:bg-neutral-900"},[n("div",{class:"w-[260px] flex-shrink-0 border-r border-neutral-200 dark:border-neutral-800"},[n(Bu,{groups:o.value,selectedId:a.value,loading:D.value,onSelect:he,onDelete:re,onToggleGroup:f,onCreate:R},null)]),n("div",{class:"min-w-0 flex-1"},[a.value||A.value?n("div",{class:"flex h-full flex-col"},[n("div",{class:"flex flex-shrink-0 items-center justify-between border-b border-neutral-200 px-4 py-2 dark:border-neutral-700"},[n("div",{class:"flex items-center gap-2"},[n("span",{class:"font-medium text-neutral-900 dark:text-neutral-100"},[A.value?"新建片段":p.value.name]),!A.value&&n("span",{class:"rounded bg-neutral-100 px-1.5 py-0.5 text-xs text-neutral-500 dark:bg-neutral-800"},[p.value.type.toUpperCase()])]),n("div",{class:"flex items-center gap-2"},[n(He,{trigger:"click",placement:"bottom-end",showArrow:!1},{trigger:()=>n(U,{size:"small",quaternary:!0},{default:()=>[n(pu,{class:"mr-1 h-4 w-4"},null),k("配置")]}),default:Oe}),n(rr,null,null),n(U,{type:"primary",size:"small",onClick:H,renderIcon:()=>n(mu,{class:"h-4 w-4"},null)},{default:()=>[k("保存")]})])]),n("div",{class:"min-h-0 flex-1"},[n(yu,{language:Cu[p.value.type],value:m.value,onChange:g,onSave:H},null)])]):n(nr,{hasSnippets:o.value.some(P=>P.count>0),onCreate:R},null)])]),ot=()=>n("div",{class:"relative h-[calc(100vh-8rem)] overflow-hidden"},[n("div",{class:["absolute inset-0 transition-transform duration-300",s.value&&"-translate-x-full"]},[n("div",{class:"h-full rounded-lg border border-neutral-200 bg-white dark:border-neutral-800 dark:bg-neutral-900"},[n(Bu,{groups:o.value,selectedId:a.value,loading:D.value,onSelect:he,onDelete:re,onToggleGroup:f,onCreate:R},null)])]),n("div",{class:["absolute inset-0 transition-transform duration-300",s.value?"translate-x-0":"translate-x-full"]},[n("div",{class:"flex h-full flex-col rounded-lg border border-neutral-200 bg-white dark:border-neutral-800 dark:bg-neutral-900"},[n("div",{class:"flex flex-shrink-0 items-center justify-between border-b border-neutral-200 px-3 py-2 dark:border-neutral-700"},[n("div",{class:"flex items-center"},[n(U,{text:!0,onClick:ie,class:"mr-2"},{default:()=>[n(Jt,{class:"h-5 w-5"},null)]}),n("span",{class:"font-medium"},[A.value?"新建片段":p.value.name])]),n("div",{class:"flex items-center gap-2"},[n(He,{trigger:"click",placement:"bottom-end",showArrow:!1},{trigger:()=>n(U,{size:"small",quaternary:!0},{default:()=>[n(pu,{class:"h-4 w-4"},null)]}),default:Oe}),n(U,{type:"primary",size:"small",onClick:H,renderIcon:()=>n(mu,{class:"h-4 w-4"},null)},{default:()=>[k("保存")]})])]),n("div",{class:"min-h-0 flex-1"},[n(yu,{language:Cu[p.value.type],value:m.value,onChange:g,onSave:H},null)])])])]),lt=()=>n(xe,{show:i.value,onUpdateShow:P=>i.value=P,preset:"card",title:"新建配置片段",style:{width:"460px",maxWidth:"90vw"}},{default:()=>[n(bu,{data:p.value,isBuiltFunction:!1,isFunctionType:x.value,isEditing:!1,"onUpdate:data":Q},null),n("div",{class:"mt-4 flex justify-end gap-2"},[n(U,{onClick:()=>i.value=!1},{default:()=>[k("取消")]}),n(U,{type:"primary",onClick:Me},{default:()=>[k("确认创建")]})])]});return()=>n(fe,null,[O.value?n(ot,null,null):n(it,null,null),n(lt,null,null)])}});export{yn as default};
